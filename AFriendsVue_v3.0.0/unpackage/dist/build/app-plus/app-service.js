if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";const t="/static/afriends-logo.png",a=(e,t)=>{const a=e.__vccOpts||e;for(const[s,o]of t)a[s]=o;return a};const s=a({name:"IndexPage",data:()=>({}),methods:{goToLogin(){uni.navigateTo({url:"/pages/login/login-replica"})},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){uni.navigateTo({url:"/pages/ai/ai-chat"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})},goToSettings(){uni.navigateTo({url:"/pages/settings/settings"})},goToWallet(){uni.navigateTo({url:"/pages/wallet/wallet"})},goToHelp(){uni.showToast({title:"帮助功能开发中",icon:"none"})}}},[["render",function(a,s,o,i,n,l){return e.openBlock(),e.createElementBlock("view",{class:"index-page"},[e.createElementVNode("view",{class:"app-header"},[e.createElementVNode("image",{class:"app-logo",src:t,mode:"aspectFit"}),e.createElementVNode("text",{class:"app-title"},"Afriends"),e.createElementVNode("text",{class:"app-subtitle"},"智能交友平台")]),e.createElementVNode("view",{class:"navigation-grid"},[e.createElementVNode("view",{class:"nav-item login-item",onClick:s[0]||(s[0]=(...e)=>l.goToLogin&&l.goToLogin(...e))},[e.createElementVNode("view",{class:"nav-icon login-icon"},[e.createElementVNode("text",{class:"icon-text"},"🔐")]),e.createElementVNode("text",{class:"nav-text"},"登录/注册"),e.createElementVNode("text",{class:"nav-desc"},"开始你的交友之旅")]),e.createElementVNode("view",{class:"nav-item",onClick:s[1]||(s[1]=(...e)=>l.goToHome&&l.goToHome(...e))},[e.createElementVNode("view",{class:"nav-icon home-icon"},[e.createElementVNode("text",{class:"icon-text"},"🏠")]),e.createElementVNode("text",{class:"nav-text"},"首页"),e.createElementVNode("text",{class:"nav-desc"},"发现精彩内容")]),e.createElementVNode("view",{class:"nav-item",onClick:s[2]||(s[2]=(...e)=>l.goToChatList&&l.goToChatList(...e))},[e.createElementVNode("view",{class:"nav-icon chat-icon"},[e.createElementVNode("text",{class:"icon-text"},"💬")]),e.createElementVNode("text",{class:"nav-text"},"消息"),e.createElementVNode("text",{class:"nav-desc"},"查看聊天记录")]),e.createElementVNode("view",{class:"nav-item",onClick:s[3]||(s[3]=(...e)=>l.goToAIChat&&l.goToAIChat(...e))},[e.createElementVNode("view",{class:"nav-icon ai-icon"},[e.createElementVNode("text",{class:"icon-text"},"🤖")]),e.createElementVNode("text",{class:"nav-text"},"AI助手"),e.createElementVNode("text",{class:"nav-desc"},"智能对话体验")]),e.createElementVNode("view",{class:"nav-item",onClick:s[4]||(s[4]=(...e)=>l.goToFriendList&&l.goToFriendList(...e))},[e.createElementVNode("view",{class:"nav-icon friend-icon"},[e.createElementVNode("text",{class:"icon-text"},"👥")]),e.createElementVNode("text",{class:"nav-text"},"好友"),e.createElementVNode("text",{class:"nav-desc"},"管理好友关系")]),e.createElementVNode("view",{class:"nav-item",onClick:s[5]||(s[5]=(...e)=>l.goToProfile&&l.goToProfile(...e))},[e.createElementVNode("view",{class:"nav-icon profile-icon"},[e.createElementVNode("text",{class:"icon-text"},"👤")]),e.createElementVNode("text",{class:"nav-text"},"我的"),e.createElementVNode("text",{class:"nav-desc"},"个人资料管理")])]),e.createElementVNode("view",{class:"quick-actions"},[e.createElementVNode("text",{class:"section-title"},"快速功能"),e.createElementVNode("view",{class:"action-buttons"},[e.createElementVNode("view",{class:"action-btn",onClick:s[6]||(s[6]=(...e)=>l.goToSettings&&l.goToSettings(...e))},[e.createElementVNode("text",{class:"action-icon"},"⚙️"),e.createElementVNode("text",{class:"action-text"},"设置")]),e.createElementVNode("view",{class:"action-btn",onClick:s[7]||(s[7]=(...e)=>l.goToWallet&&l.goToWallet(...e))},[e.createElementVNode("text",{class:"action-icon"},"💰"),e.createElementVNode("text",{class:"action-text"},"钱包")]),e.createElementVNode("view",{class:"action-btn",onClick:s[8]||(s[8]=(...e)=>l.goToHelp&&l.goToHelp(...e))},[e.createElementVNode("text",{class:"action-icon"},"❓"),e.createElementVNode("text",{class:"action-text"},"帮助")])])]),e.createElementVNode("view",{class:"footer-info"},[e.createElementVNode("text",{class:"version-text"},"版本 3.0.0"),e.createElementVNode("text",{class:"copyright-text"},"© 2024 Afriends. All rights reserved.")])])}]]);function o(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}const i=a({name:"AiPage",data:()=>({showSideMenu:!1}),methods:{openMenu(){this.showSideMenu=!0},closeSideMenu(){this.showSideMenu=!1},goToMyAI(){uni.navigateTo({url:"/pages/ai/ai"})},goToMyCertification(){uni.navigateTo({url:"/pages/verification/official-certification"})},goToMyPreferences(){uni.navigateTo({url:"/pages/feed/likes-dislikes"})},goToMyAchievements(){uni.navigateTo({url:"/pages/feed/achievements"})},goToAlbum(){uni.showToast({title:"相册功能开发中",icon:"none"})},goToHistoryComments(){uni.navigateTo({url:"/pages/feed/interaction-messages"})},goToBrowsingHistory(){uni.showToast({title:"浏览记录功能开发中",icon:"none"})},goToDraftBox(){uni.showToast({title:"草稿箱功能开发中",icon:"none"})},goToPurchaseRecord(){uni.navigateTo({url:"/pages/wallet/purchase-record"})},goToShoppingCart(){uni.showToast({title:"购物车功能开发中",icon:"none"})},goToWallet(){uni.navigateTo({url:"/pages/wallet/wallet"})},goToEditProfile(){uni.showToast({title:"编辑资料功能开发中",icon:"none"})},goToAIImage(){o("log","at pages/ai/ai.vue:177","点击AI形象，准备跳转"),uni.navigateTo({url:"/pages/ai/gift"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"ai-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"btn back",onClick:a[0]||(a[0]=(...e)=>n.openMenu&&n.openMenu(...e))}),e.createElementVNode("view",{class:"btn settings"})]),e.createElementVNode("view",{class:"profile"},[e.createElementVNode("view",{class:"avatar-wrap"},[e.createElementVNode("image",{class:"avatar",src:"",mode:"aspectFill"})]),e.createElementVNode("text",{class:"name"},"相亲AI"),e.createElementVNode("text",{class:"level"},"lv10 经验2000/4000")]),e.createElementVNode("view",{class:"sections"},[e.createElementVNode("view",{class:"cell",onClick:a[1]||(a[1]=(...e)=>n.goToAIImage&&n.goToAIImage(...e))},[e.createElementVNode("view",{class:"cell-icon"}),e.createElementVNode("text",{class:"cell-title"},"AI形象")]),e.createElementVNode("view",{class:"cell"},[e.createElementVNode("view",{class:"cell-icon"}),e.createElementVNode("text",{class:"cell-title"},"任务")])]),e.createElementVNode("view",{class:e.normalizeClass(["side-menu",{active:i.showSideMenu}]),onClick:a[15]||(a[15]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("view",{class:"menu-content",onClick:a[14]||(a[14]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"menu-header"},[e.createElementVNode("view",{class:"menu-close",onClick:a[2]||(a[2]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"menu-list"},[e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[3]||(a[3]=(...e)=>n.goToMyAI&&n.goToMyAI(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的AI")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[4]||(a[4]=(...e)=>n.goToMyCertification&&n.goToMyCertification(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的认证")]),e.createElementVNode("view",{class:"menu-item",onClick:a[5]||(a[5]=(...e)=>n.goToMyPreferences&&n.goToMyPreferences(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的喜恶")]),e.createElementVNode("view",{class:"menu-item",onClick:a[6]||(a[6]=(...e)=>n.goToMyAchievements&&n.goToMyAchievements(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的成就")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[7]||(a[7]=(...e)=>n.goToAlbum&&n.goToAlbum(...e))},[e.createElementVNode("text",{class:"menu-text"},"相册")]),e.createElementVNode("view",{class:"menu-item",onClick:a[8]||(a[8]=(...e)=>n.goToHistoryComments&&n.goToHistoryComments(...e))},[e.createElementVNode("text",{class:"menu-text"},"互动消息")]),e.createElementVNode("view",{class:"menu-item",onClick:a[9]||(a[9]=(...e)=>n.goToBrowsingHistory&&n.goToBrowsingHistory(...e))},[e.createElementVNode("text",{class:"menu-text"},"浏览记录")]),e.createElementVNode("view",{class:"menu-item",onClick:a[10]||(a[10]=(...e)=>n.goToDraftBox&&n.goToDraftBox(...e))},[e.createElementVNode("text",{class:"menu-text"},"草稿箱")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[11]||(a[11]=(...e)=>n.goToPurchaseRecord&&n.goToPurchaseRecord(...e))},[e.createElementVNode("text",{class:"menu-text"},"购买记录")]),e.createElementVNode("view",{class:"menu-item",onClick:a[12]||(a[12]=(...e)=>n.goToWallet&&n.goToWallet(...e))},[e.createElementVNode("text",{class:"menu-text"},"钱包")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[13]||(a[13]=(...e)=>n.goToEditProfile&&n.goToEditProfile(...e))},[e.createElementVNode("text",{class:"menu-text"},"编辑资料")])])])])],2)])}]]);const n=a({name:"CustomizeAiPage",data:()=>({}),methods:{goToLevelUp(){uni.navigateTo({url:"/pages/ai/level-up"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"customize-ai-page"},[e.createElementVNode("view",{class:"ai-profile"},[e.createElementVNode("view",{class:"ai-avatar-wrap"},[e.createElementVNode("image",{class:"ai-avatar",src:"",mode:"aspectFill"})]),e.createElementVNode("view",{class:"ai-info"},[e.createElementVNode("text",{class:"ai-name"},"相亲AI"),e.createElementVNode("view",{class:"ai-level-row"},[e.createElementVNode("text",{class:"ai-level"},"Lv10"),e.createElementVNode("text",{class:"level-up-link",onClick:a[0]||(a[0]=(...e)=>n.goToLevelUp&&n.goToLevelUp(...e))},"等级提升")])])]),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"gift-section"},[e.createElementVNode("text",{class:"section-title"},"礼物限额"),e.createElementVNode("text",{class:"section-desc"},"设置要给AI的额度"),e.createElementVNode("view",{class:"gift-input"},[e.createElementVNode("view",{class:"input-field"},[e.createElementVNode("text",{class:"placeholder"},"请输入")]),e.createElementVNode("text",{class:"currency"},"金币")])]),e.createElementVNode("view",{class:"save-section"},[e.createElementVNode("view",{class:"save-btn"},[e.createElementVNode("text",{class:"save-text"},"保存")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const l=a({name:"GiftPage",data:()=>({userAiId:null,userId:null,aiName:"",aiAvatar:"/static/logo.png",level:1,currentExp:0,nextExp:1e3,power:0,activeTaskCount:0,gifts:[],showGiftsList:!0,levelRules:[],currentLevelRule:null,nextLevelRule:null,loading:!1,errorMessage:""}),onLoad(e){o("log","at pages/ai/gift.vue:163","gift页面加载，接收到的参数:",e),e.userAiId&&(this.userAiId=parseInt(e.userAiId)),e.aiName&&(this.aiName=decodeURIComponent(e.aiName)),!this.aiName&&this.userAiId&&(this.aiName=this.userAiId.toString()),this.userId=uni.getStorageSync("userId")||1,this.loadAiModelData(),this.loadLevelRules(),this.loadGiftData(),this.loadActiveTaskCount()},onShow(){o("log","at pages/ai/gift.vue:190","gift页面显示，刷新AI模型数据"),this.loadAiModelData(),this.loadLevelRules(),this.loadActiveTaskCount()},computed:{progressPercent(){const e=Math.min(100,Math.max(0,this.currentExp/this.nextExp*100));return Number(e.toFixed(2))},selectedGiftsCount(){return this.gifts.reduce(((e,t)=>e+t.count),0)}},methods:{async loadAiModelData(){if(this.userAiId)try{this.loading=!0,o("log","at pages/ai/gift.vue:215","开始加载AI模型数据，userAiId:",this.userAiId);let e=await uni.request({url:`http://localhost:8888/api/user-ai-model/${this.userAiId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/ai/gift.vue:226","用户AI模型数据响应:",e),200===e.statusCode&&e.data||(o("log","at pages/ai/gift.vue:230","用户AI模型不存在，尝试从基础模型获取"),e=await uni.request({url:`http://localhost:8888/api/a-entities/aimodel-base-info/${this.userAiId}`,method:"GET",header:{"Content-Type":"application/json"}}),o("log","at pages/ai/gift.vue:238","基础AI模型数据响应:",e)),200===e.statusCode&&e.data){const t=e.data;(t.modelName||t.name)&&(this.aiName=t.modelName||t.name);const a=t.modelImageUrl||t.imageUrl;a&&this.isValidImageUrl(a)?this.aiAvatar=a:(this.aiAvatar="",o("log","at pages/ai/gift.vue:255","AI模型图片URL无效，使用默认头像:",a)),this.level=t.level||1,this.currentExp=t.totalExp||t.exp||0,this.power=t.power||0,this.updateLevelRules(),o("log","at pages/ai/gift.vue:265","AI模型数据加载成功:",{aiName:this.aiName,level:this.level,currentExp:this.currentExp,nextExp:this.nextExp})}else o("error","at pages/ai/gift.vue:272","加载AI模型数据失败:",e),o("log","at pages/ai/gift.vue:274","保持传入的AI名称:",this.aiName)}catch(e){o("error","at pages/ai/gift.vue:277","加载AI模型数据异常:",e),this.errorMessage="网络错误，请检查连接"}finally{this.loading=!1}else o("log","at pages/ai/gift.vue:209","没有userAiId，无法加载AI模型数据")},async loadLevelRules(){try{o("log","at pages/ai/gift.vue:287","=== 开始加载等级规则数据 ===");const e=await uni.request({url:"http://localhost:8888/api/aimodel-level-rule/all-ordered",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/ai/gift.vue:297","等级规则数据响应:",e),o("log","at pages/ai/gift.vue:298","响应状态码:",e.statusCode),o("log","at pages/ai/gift.vue:299","响应数据:",e.data),200===e.statusCode&&e.data.success?(this.levelRules=e.data.data,o("log","at pages/ai/gift.vue:303","等级规则数据加载成功，数量:",this.levelRules.length),o("log","at pages/ai/gift.vue:304","前3条等级规则数据:",this.levelRules.slice(0,3)),this.updateLevelRules()):(o("error","at pages/ai/gift.vue:309","加载等级规则数据失败:",e),o("error","at pages/ai/gift.vue:310","失败原因:",e.data?e.data.message:"未知错误"),this.setDefaultLevelRules())}catch(e){o("error","at pages/ai/gift.vue:315","加载等级规则数据异常:",e),o("error","at pages/ai/gift.vue:316","异常详情:",e.message),this.setDefaultLevelRules()}},updateLevelRules(){if(o("log","at pages/ai/gift.vue:324","=== 开始更新等级规则 ==="),o("log","at pages/ai/gift.vue:325","当前状态:",{levelRulesLength:this.levelRules.length,currentLevel:this.level,currentExp:this.currentExp}),0===this.levelRules.length)return o("warn","at pages/ai/gift.vue:332","等级规则数据为空，使用默认规则"),void this.setDefaultLevelRules();this.currentLevelRule=this.levelRules.find((e=>e.level===this.level)),o("log","at pages/ai/gift.vue:339","当前等级规则查找结果:",this.currentLevelRule),this.currentLevelRule?(this.nextExp=this.currentLevelRule.expRequirement,o("log","at pages/ai/gift.vue:344","设置nextExp为当前等级所需经验:",this.nextExp),o("log","at pages/ai/gift.vue:345","等级规则说明: 等级",this.level,"需要",this.nextExp,"经验才能升级")):(this.nextExp=0,o("error","at pages/ai/gift.vue:349","找不到当前等级",this.level,"的规则，设置nextExp为0")),o("log","at pages/ai/gift.vue:352","等级规则更新完成:",{currentLevel:this.level,currentExp:this.currentExp,nextExp:this.nextExp,currentLevelRule:this.currentLevelRule,nextLevelRule:this.nextLevelRule})},setDefaultLevelRules(){o("log","at pages/ai/gift.vue:363","使用默认等级规则 - 数据未正确加载"),this.levelRules=[],this.currentLevelRule=null,this.nextLevelRule=null,this.nextExp=0,o("warn","at pages/ai/gift.vue:369","等级规则数据未加载，nextExp设置为0，请检查数据加载逻辑")},async loadGiftData(){try{o("log","at pages/ai/gift.vue:375","开始加载礼物数据");const e=await uni.request({url:"http://localhost:8888/api/efmprt-entities-wlq/gift-base/all",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/ai/gift.vue:385","礼物数据响应:",e),200===e.statusCode&&e.data?(this.gifts=this.convertGiftDataToDisplayFormat(e.data),o("log","at pages/ai/gift.vue:389","礼物数据加载成功，数量:",this.gifts.length)):(o("error","at pages/ai/gift.vue:391","加载礼物数据失败:",e),this.errorMessage="加载礼物数据失败")}catch(e){o("error","at pages/ai/gift.vue:395","加载礼物数据异常:",e),this.errorMessage="网络错误，请检查连接"}},convertGiftDataToDisplayFormat(e){return e.map(((e,t)=>{let a="",s="";if(e.description&&e.description.includes("：")){const t=e.description.split("：",2);a=t[0].trim(),s=t[1].trim()}else if(e.description&&e.description.includes(":")){const t=e.description.split(":",2);a=t[0].trim(),s=t[1].trim()}else a=e.description||`礼物${t+1}`,s="暂无描述";const o=Math.round(100*(e.price||0)),i=this.getGiftIconClass(a);return{id:e.giftId,name:a,description:s,price:o,count:0,iconClass:i}}))},getGiftIconClass(e){const t=e.toLowerCase();return t.includes("花")||t.includes("flower")?"gift-flower":t.includes("啤酒")||t.includes("beer")?"gift-beer":t.includes("糖")||t.includes("candy")||t.includes("lollipop")?"gift-lollipop":t.includes("圈")||t.includes("donut")?"gift-donut":t.includes("巧克力")||t.includes("chocolate")?"gift-chocolate":t.includes("心")||t.includes("heart")?"gift-heart":t.includes("发箍")||t.includes("hairband")?"gift-hairband":t.includes("游戏")||t.includes("game")?"gift-game":"gift-flower"},goBack(){uni.navigateBack()},goLevelUp(){o("log","at pages/ai/gift.vue:454","gift.vue goLevelUp 被调用，userAiId:",this.userAiId),uni.navigateTo({url:`/pages/ai/level-up?userAiId=${this.userAiId}`})},goToPermissions(){uni.navigateTo({url:"/pages/ai/permissions"})},goToTasks(){uni.navigateTo({url:"/pages/ai/tasks"})},async loadActiveTaskCount(){try{o("log","at pages/ai/gift.vue:465","开始加载进行中的任务数量，用户ID:",this.userId);const e=await uni.request({url:"http://localhost:8888/api/u-entities/user-task-relationship/all",method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/ai/gift.vue:475","用户任务关系数据响应:",e),200===e.statusCode&&e.data){const t=e.data.filter((e=>e.userId===this.userId)),a=t.filter((e=>1===e.status));this.activeTaskCount=a.length,o("log","at pages/ai/gift.vue:482","用户任务总数:",t.length,"进行中的任务数量:",this.activeTaskCount)}else o("error","at pages/ai/gift.vue:484","加载任务数据失败"),this.activeTaskCount=0}catch(e){o("error","at pages/ai/gift.vue:488","加载任务数据异常:",e),this.activeTaskCount=0}},toggleGiftsList(){this.showGiftsList=!this.showGiftsList},increaseGift(e){this.gifts[e].count++},decreaseGift(e){this.gifts[e].count>0&&this.gifts[e].count--},async checkout(){if(this.selectedGiftsCount<=0)uni.showToast({title:"请选择礼物",icon:"none"});else try{uni.showLoading({title:"正在赠送礼物..."});const e=[];let t=0;for(const s of this.gifts)if(s.count>0)for(let a=0;a<s.count;a++){const a={userId:this.userId,itemType:"gift",itemId:s.id,itemName:s.name,coinsSpent:s.price,coinsBalance:0,purchasePath:`gift_page_${this.userAiId}`};e.push(a),t+=s.price}o("log","at pages/ai/gift.vue:538","准备保存的购买记录:",e),o("log","at pages/ai/gift.vue:539","总花费金币:",t);const a=await uni.request({url:"http://localhost:8888/api/purchase-record/save-batch",method:"POST",header:{"Content-Type":"application/json"},data:e});if(o("log","at pages/ai/gift.vue:551","购买记录保存响应:",a),200===a.statusCode&&a.data.success)uni.hideLoading(),uni.showToast({title:`成功赠送 ${this.selectedGiftsCount} 个礼物！花费 ${t} 金币`,icon:"success",duration:2e3}),this.gifts.forEach((e=>e.count=0));else{if(!a.data.message||!a.data.message.includes("金币不足"))throw new Error(a.data.message||"赠送失败");uni.hideLoading(),uni.showToast({title:"金币不足，无法赠送礼物",icon:"none",duration:2e3})}}catch(e){o("error","at pages/ai/gift.vue:577","赠送礼物失败:",e),uni.hideLoading(),uni.showToast({title:"赠送失败，请重试",icon:"none"})}},modifyPhoto(){uni.showActionSheet({itemList:["拍照","从相册选择"],success:e=>{0===e.tapIndex?this.openCamera():1===e.tapIndex&&this.selectFromAlbum()}})},modifyName(){uni.showModal({title:"修改AI名称",editable:!0,placeholderText:"请输入新的AI名称",content:this.aiName,success:e=>{if(e.confirm&&e.content.trim()){const t=e.content.trim();this.updateAiName(t)}}})},async updateAiName(e){try{if(!this.userAiId)return void uni.showToast({title:"AI模型ID不存在",icon:"none"});this.aiName=e;if(200!==(await uni.request({url:`http://localhost:8888/api/user-ai-model/update-name/${this.userAiId}`,method:"PUT",header:{"Content-Type":"application/json"},data:{modelName:e}})).statusCode)throw new Error("更新失败");uni.showToast({title:"AI名字修改成功",icon:"success"})}catch(t){o("error","at pages/ai/gift.vue:649","更新AI名字失败:",t),uni.showToast({title:"修改失败，请重试",icon:"none"})}},openCamera(){uni.chooseImage({count:1,sourceType:["camera"],success:e=>{this.aiAvatar=e.tempFilePaths[0],uni.showToast({title:"照片修改成功",icon:"success"})}})},selectFromAlbum(){uni.chooseImage({count:1,sourceType:["album"],success:e=>{this.aiAvatar=e.tempFilePaths[0],uni.showToast({title:"照片修改成功",icon:"success"})}})},isValidImageUrl(e){if(!e||"string"!=typeof e)return!1;const t=[".jpg",".jpeg",".png",".gif",".webp",".svg"].some((t=>e.toLowerCase().includes(t))),a=e.includes("example.com")||e.includes("placeholder")||e.includes("fake")||e.startsWith("http://localhost")&&e.includes("static"),s=e.startsWith("http://")||e.startsWith("https://");return t&&!a&&s},onImageError(){o("log","at pages/ai/gift.vue:711","图片加载失败，切换到默认头像"),this.aiAvatar=""},getAvatarText(){return this.aiName?this.aiName.charAt(0).toUpperCase():"AI"}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"gift-page"},[e.createElementVNode("view",{class:"ai-summary"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载AI信息中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("button",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.loadAiModelData&&n.loadAiModelData(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:2},[e.createElementVNode("view",{class:"avatar-wrap",onClick:a[2]||(a[2]=(...e)=>n.modifyPhoto&&n.modifyPhoto(...e))},[n.isValidImageUrl(i.aiAvatar)?(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar",src:i.aiAvatar,mode:"aspectFill",onError:a[1]||(a[1]=(...e)=>n.onImageError&&n.onImageError(...e))},null,40,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"avatar avatar-placeholder"},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString(n.getAvatarText()),1)])),e.createElementVNode("view",{class:"edit-overlay"},[e.createElementVNode("text",null,"点击修改照片")])]),e.createElementVNode("view",{class:"ai-info"},[e.createElementVNode("view",{class:"name-row"},[e.createElementVNode("view",{class:"ai-name",onClick:a[3]||(a[3]=(...e)=>n.modifyName&&n.modifyName(...e))},[e.createElementVNode("text",null,e.toDisplayString(i.aiName||"AI小助手"),1),e.createElementVNode("view",{class:"edit-icon"},"✏️")]),e.createElementVNode("view",{class:"perm-pill",onClick:a[4]||(a[4]=(...e)=>n.goToPermissions&&n.goToPermissions(...e))},[e.createElementVNode("view",{class:"perm-dot"},"!"),e.createElementVNode("text",{class:"perm-text"},"权限")])]),e.createElementVNode("view",{class:"level-row"},[e.createElementVNode("text",{class:"level-text"},"Lv"+e.toDisplayString(i.level),1),e.createElementVNode("view",{class:"level-up-btn",onClick:a[5]||(a[5]=(...e)=>n.goLevelUp&&n.goLevelUp(...e))},[e.createElementVNode("text",{class:"btn-text"},"等级提升")])]),e.createElementVNode("view",{class:"progress-row"},[e.createElementVNode("view",{class:"progress"},[e.createElementVNode("view",{class:"track"}),e.createElementVNode("view",{class:"fill",style:e.normalizeStyle({width:n.progressPercent+"%"})},null,4)]),e.createElementVNode("text",{class:"progress-text"},e.toDisplayString(i.currentExp)+"/"+e.toDisplayString(i.nextExp),1)])])]))]),e.createElementVNode("view",{class:"task-row",onClick:a[6]||(a[6]=(...e)=>n.goToTasks&&n.goToTasks(...e))},[e.createElementVNode("view",{class:"task-left"},[e.createElementVNode("view",{class:"task-icon"},"📋"),e.createElementVNode("text",{class:"task-text"},"任务")]),e.createElementVNode("view",{class:"task-right"},[e.createElementVNode("text",{class:"task-count"},e.toDisplayString(i.activeTaskCount)+" 个进行中",1),e.createElementVNode("view",{class:"task-arrow"},">")])]),e.createElementVNode("view",{class:"gift-list"},[e.createElementVNode("view",{class:"gift-header",onClick:a[7]||(a[7]=(...e)=>n.toggleGiftsList&&n.toggleGiftsList(...e))},[e.createElementVNode("view",{class:"header-left"},[e.createElementVNode("text",{class:"header-title"},"礼物"),e.createElementVNode("view",{class:e.normalizeClass(["dropdown-arrow",{rotated:i.showGiftsList}])},null,2)]),e.createElementVNode("text",{class:"header-subtitle"},"定价 (金币)")]),e.withDirectives(e.createElementVNode("view",{class:"gift-items"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.gifts,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"gift-item",key:a},[e.createElementVNode("view",{class:"gift-left"},[e.createElementVNode("view",{class:e.normalizeClass(["gift-icon",t.iconClass])},null,2),e.createElementVNode("view",{class:"gift-info"},[e.createElementVNode("text",{class:"gift-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"gift-description"},e.toDisplayString(t.description),1)])]),e.createElementVNode("view",{class:"gift-right"},[e.createElementVNode("text",{class:"gift-price"},e.toDisplayString(t.price),1),e.createElementVNode("view",{class:"quantity-controls"},[e.createElementVNode("view",{class:e.normalizeClass(["control-btn minus",{disabled:t.count<=0}]),onClick:e=>n.decreaseGift(a)},"-",10,["onClick"]),e.createElementVNode("text",{class:"quantity-display"},e.toDisplayString(t.count),1),e.createElementVNode("view",{class:"control-btn plus",onClick:e=>n.increaseGift(a)},"+",8,["onClick"])])])])))),128))],512),[[e.vShow,i.showGiftsList]])]),e.createElementVNode("view",{class:"cart-bar"},[e.createElementVNode("text",{class:"cart-total"},"已选礼物："+e.toDisplayString(n.selectedGiftsCount)+" 个",1),e.createElementVNode("view",{class:"checkout-btn",onClick:a[8]||(a[8]=(...e)=>n.checkout&&n.checkout(...e))},[e.createElementVNode("text",{class:"checkout-text"},"赠送")])])])}]]);const c=a({name:"LevelUpPage",data:()=>({packs:[],selectedIndex:0,coinBalance:0,loading:!1,errorMessage:"",userAiId:null,userId:null,currentLevel:1,currentExp:0,levelRules:[]}),onLoad(e){e.userAiId&&(this.userAiId=parseInt(e.userAiId)),this.userId=uni.getStorageSync("userId")||1,this.loadProducts(),this.loadUserBalance(),this.loadAiModelData(),this.loadLevelRules()},methods:{goBack(){uni.navigateBack()},selectPack(e){this.selectedIndex=e},async recharge(){const e=this.packs[this.selectedIndex];if(!e)return void uni.showToast({title:"请选择升级套餐",icon:"error"});if(this.coinBalance<e.price)return void uni.showToast({title:"金币不足，无法升级",icon:"error"});if(await new Promise((t=>{uni.showModal({title:"确认升级",content:`确定要花费 ${e.price} 金币购买 ${e.coin} 经验吗？`,success:e=>t(e.confirm),fail:()=>t(!1)})}))){uni.showLoading({title:"升级中..."});try{const t={userId:uni.getStorageSync("userId")||1,itemType:"level_up",itemId:e.id,itemName:`${e.coin}金币升级套餐`,coinsSpent:e.price,coinsBalance:0,purchasePath:"level_up_page"},a=await uni.request({url:"http://localhost:8888/api/purchase-record/save-batch",method:"POST",header:{"Content-Type":"application/json"},data:[t]});if(200!==a.statusCode||!a.data.success)throw new Error(a.data.message||"购买失败");{await this.loadUserBalance();const t=e.price;o("log","at pages/ai/level-up.vue:170","购买成功，准备增加经验:",{expGained:t,currentLevel:this.currentLevel,currentExp:this.currentExp,userAiId:this.userAiId}),uni.showToast({title:`准备增加经验：+${t}`,icon:"none",duration:2e3}),await this.addExperience(t),uni.showToast({title:"购买成功！",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)}}catch(t){o("error","at pages/ai/level-up.vue:199","升级失败:",t),t.message&&t.message.includes("金币不足")?uni.showToast({title:"金币不足，升级失败",icon:"error"}):uni.showToast({title:"升级失败，请重试",icon:"error"})}finally{uni.hideLoading()}}},async loadProducts(){this.loading=!0,this.errorMessage="";try{const e=await uni.request({url:"http://localhost:8888/api/products-base/available",method:"GET",header:{"Content-Type":"application/json"}});if(200!==e.statusCode||!e.data.success)throw new Error(e.data.message||"加载产品数据失败");this.packs=this.convertProductsToDisplayFormat(e.data.data),o("log","at pages/ai/level-up.vue:234","产品数据加载成功:",this.packs)}catch(e){o("error","at pages/ai/level-up.vue:239","加载产品数据失败:",e),this.errorMessage="加载产品数据失败，请重试",this.packs=[{coin:10,price:100,coinExtra:0,expExtra:0},{coin:100,price:1e3,coinExtra:0,expExtra:0},{coin:500,price:5e3,coinExtra:0,expExtra:0},{coin:1e3,price:1e4,coinExtra:0,expExtra:0}]}finally{this.loading=!1}},async loadUserBalance(){try{const e=uni.getStorageSync("userId")||1,t=await uni.request({url:`http://localhost:8888/api/users/${e}`,method:"GET",header:{"Content-Type":"application/json"}});200===t.statusCode&&t.data&&(this.coinBalance=t.data.gold||0,o("log","at pages/ai/level-up.vue:267","用户金币余额:",this.coinBalance))}catch(e){o("error","at pages/ai/level-up.vue:270","加载用户余额失败:",e),this.coinBalance=0}},convertProductsToDisplayFormat:e=>e.map((e=>({id:e.coinRechargeId,coin:e.coinNum||0,price:e.expNum||0,coinExtra:e.coinExtraNum||0,expExtra:e.expExtraNum||0,extraNum:e.extraNum||0,status:e.status||0}))),async loadAiModelData(){if(o("log","at pages/ai/level-up.vue:290","loadAiModelData 被调用，userAiId:",this.userAiId),this.userAiId)try{o("log","at pages/ai/level-up.vue:297","开始加载AI模型数据，userAiId:",this.userAiId);const e=await uni.request({url:`http://localhost:8888/api/user-ai-model/${this.userAiId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/ai/level-up.vue:307","AI模型数据响应:",e),200===e.statusCode&&e.data){const t=e.data;this.currentLevel=t.level||1,this.currentExp=t.totalExp||0,o("log","at pages/ai/level-up.vue:314","AI模型数据加载成功:",{level:this.currentLevel,exp:this.currentExp})}else o("error","at pages/ai/level-up.vue:319","加载AI模型数据失败:",e)}catch(e){o("error","at pages/ai/level-up.vue:322","加载AI模型数据异常:",e)}else o("log","at pages/ai/level-up.vue:292","没有userAiId，无法加载AI模型数据")},async loadLevelRules(){try{o("log","at pages/ai/level-up.vue:329","开始加载等级规则数据");const e=await uni.request({url:"http://localhost:8888/api/aimodel-level-rule/all-ordered",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/ai/level-up.vue:339","等级规则数据响应:",e),200===e.statusCode&&e.data.success?(this.levelRules=e.data.data,o("log","at pages/ai/level-up.vue:343","等级规则数据加载成功，数量:",this.levelRules.length)):o("error","at pages/ai/level-up.vue:345","加载等级规则数据失败:",e)}catch(e){o("error","at pages/ai/level-up.vue:348","加载等级规则数据异常:",e)}},async addExperience(e){if(o("log","at pages/ai/level-up.vue:354","=== 开始增加经验并检查升级 ==="),o("log","at pages/ai/level-up.vue:355","addExperience 被调用，参数:",{userAiId:this.userAiId,expGained:e,currentLevel:this.currentLevel,currentExp:this.currentExp,levelRulesLength:this.levelRules.length}),!this.userAiId)return o("log","at pages/ai/level-up.vue:364","缺少userAiId，无法增加经验"),void uni.showToast({title:"缺少AI模型ID，无法增加经验",icon:"error",duration:3e3});if(!this.levelRules.length)return o("log","at pages/ai/level-up.vue:374","缺少等级规则数据，无法检查升级"),void uni.showToast({title:"等级规则数据未加载，无法升级",icon:"error",duration:3e3});let t=this.currentExp+e,a=this.currentLevel,s=!1,i=0;for(o("log","at pages/ai/level-up.vue:389","经验累加后:",{originalExp:this.currentExp,expGained:e,totalExp:t,currentLevel:a}),o("log","at pages/ai/level-up.vue:397","=== 开始循环升级检查 ==="),o("log","at pages/ai/level-up.vue:398","升级检查前状态:",{currentLevel:a,totalExp:t,levelRulesCount:this.levelRules.length});;){const e=this.levelRules.find((e=>e.level===a));if(o("log","at pages/ai/level-up.vue:408",`查找等级 ${a} 的规则:`,e),!e){o("log","at pages/ai/level-up.vue:411","没有当前等级规则，停止升级检查");break}if(o("log","at pages/ai/level-up.vue:415",`检查等级 ${a} 升级条件:`,{level:a,requiredExp:e.expRequirement,currentTotalExp:t,canUpgrade:t>=e.expRequirement,comparison:`${t} >= ${e.expRequirement} = ${t>=e.expRequirement}`}),!(t>=e.expRequirement)){o("log","at pages/ai/level-up.vue:435",`经验不足，无法升级到等级 ${a+1}，需要: ${e.expRequirement}，当前: ${t}`);break}t-=e.expRequirement,a+=1,s=!0,i++,o("log","at pages/ai/level-up.vue:432",`升级成功！等级 ${a-1} -> ${a}，消耗经验: ${e.expRequirement}，剩余经验: ${t}`)}o("log","at pages/ai/level-up.vue:440","升级检查完成:",{originalLevel:this.currentLevel,originalExp:this.currentExp,finalLevel:a,finalExp:t,leveledUp:s,upgradeCount:i}),await this.updateAiModelLevel(a,t),this.currentLevel=a,this.currentExp=t,s?uni.showToast({title:`升级成功！等级${a}，剩余经验${t}`,icon:"success",duration:2e3}):uni.showToast({title:`经验+${e}，当前等级${a}，总经验${t}`,icon:"success",duration:2e3})},getNextLevelRequirement(){if(!this.levelRules.length)return 0;const e=this.levelRules.find((e=>e.level===this.currentLevel));return o("log","at pages/ai/level-up.vue:476","getNextLevelRequirement: 当前等级",this.currentLevel,"所需经验",e?e.expRequirement:0),e?e.expRequirement:0},async updateAiModelLevel(e,t){try{const a=await uni.request({url:`http://localhost:8888/api/user-ai-model/update-level/${this.userAiId}`,method:"PUT",header:{"Content-Type":"application/json"},data:{level:e,totalExp:t}});200===a.statusCode&&a.data.success?(this.currentLevel=e,this.currentExp=t,o("log","at pages/ai/level-up.vue:498","AI模型等级更新成功")):o("error","at pages/ai/level-up.vue:500","更新AI模型等级失败:",a)}catch(a){o("error","at pages/ai/level-up.vue:503","更新AI模型等级异常:",a)}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"level-up-page"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"加载中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-btn",onClick:a[0]||(a[0]=(...e)=>n.loadProducts&&n.loadProducts(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"packs-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.packs,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["pack-card",{active:i.selectedIndex===a}]),key:t.id||a,onClick:e=>n.selectPack(a)},[e.createElementVNode("text",{class:"coin-text"},e.toDisplayString(t.coin)+"金币",1),e.createElementVNode("text",{class:"price-text"},e.toDisplayString(t.price)+"经验",1)],10,["onClick"])))),128))])),e.createElementVNode("view",{class:"ai-model-status"},[e.createElementVNode("view",{class:"status-item"},[e.createElementVNode("text",{class:"label"},"当前等级："),e.createElementVNode("text",{class:"value"},e.toDisplayString(i.currentLevel),1)]),e.createElementVNode("view",{class:"status-item"},[e.createElementVNode("text",{class:"label"},"当前经验："),e.createElementVNode("text",{class:"value"},e.toDisplayString(i.currentExp),1)]),n.getNextLevelRequirement()>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"status-item"},[e.createElementVNode("text",{class:"label"},"升级需要："),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.getNextLevelRequirement())+"经验",1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"balance"},[e.createElementVNode("text",{class:"label"},"金币余额："),e.createElementVNode("text",{class:"value"},e.toDisplayString(i.coinBalance),1)]),e.createElementVNode("view",{class:"cta-wrapper"},[e.createElementVNode("view",{class:"cta-btn",onClick:a[1]||(a[1]=(...e)=>n.recharge&&n.recharge(...e))},[e.createElementVNode("text",{class:"cta-text"},"立即升级")])])])}]]);const r=a({data:()=>({}),methods:{goBack(){uni.navigateBack()}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"content-area"},[e.createElementVNode("view",{class:"page-header"},[e.createElementVNode("view",{class:"header-icon"},"🤖"),e.createElementVNode("text",{class:"header-title"},"AI理解等级"),e.createElementVNode("text",{class:"header-subtitle"},"了解您的AI伙伴如何理解您")]),e.createElementVNode("view",{class:"levels-container"},[e.createElementVNode("view",{class:"level-card level-1"},[e.createElementVNode("view",{class:"level-header"},[e.createElementVNode("view",{class:"level-icon"},"🌱"),e.createElementVNode("view",{class:"level-info"},[e.createElementVNode("text",{class:"level-title"},"合得来 "),e.createElementVNode("text",{class:"level-range"},"1-5级")]),e.createElementVNode("view",{class:"level-badge"},"100经验/级")]),e.createElementVNode("view",{class:"level-description"}," 您的ai还不熟悉您,所以准确度可能比较低,试着和她多说说话 ")]),e.createElementVNode("view",{class:"level-card level-2"},[e.createElementVNode("view",{class:"level-header"},[e.createElementVNode("view",{class:"level-icon"},"🌿"),e.createElementVNode("view",{class:"level-info"},[e.createElementVNode("text",{class:"level-title"},"靠谱儿 "),e.createElementVNode("text",{class:"level-range"},"6-10级")]),e.createElementVNode("view",{class:"level-badge"},"1000经验/级")]),e.createElementVNode("view",{class:"level-description"}," 您的ai对您已经有所了解,但是细节上可能存在一些偏差,而且效率也不高 ")]),e.createElementVNode("view",{class:"level-card level-3"},[e.createElementVNode("view",{class:"level-header"},[e.createElementVNode("view",{class:"level-icon"},"🌳"),e.createElementVNode("view",{class:"level-info"},[e.createElementVNode("text",{class:"level-title"},"懂我者 "),e.createElementVNode("text",{class:"level-range"},"11-20级")]),e.createElementVNode("view",{class:"level-badge"},"2000经验/级")]),e.createElementVNode("view",{class:"level-description"}," ai可以相对准确获得您的想法,他们的语言更加优美 ")]),e.createElementVNode("view",{class:"level-card level-4"},[e.createElementVNode("view",{class:"level-header"},[e.createElementVNode("view",{class:"level-icon"},"💎"),e.createElementVNode("view",{class:"level-info"},[e.createElementVNode("text",{class:"level-title"},"生死交 "),e.createElementVNode("text",{class:"level-range"},"21-24级")]),e.createElementVNode("view",{class:"level-badge"},"5000经验/级")]),e.createElementVNode("view",{class:"level-description"}," 您的ai对您十分了解,可以为你找到您的心中所想 ")]),e.createElementVNode("view",{class:"level-card level-5"},[e.createElementVNode("view",{class:"level-header"},[e.createElementVNode("view",{class:"level-icon"},"🔥"),e.createElementVNode("view",{class:"level-info"},[e.createElementVNode("text",{class:"level-title"},"同行者 "),e.createElementVNode("text",{class:"level-range"},"25级")]),e.createElementVNode("view",{class:"level-badge"},"10000经验/级")]),e.createElementVNode("view",{class:"level-description"}," 您的ai效率非常高,并且有很高的话术可以得到您想要的消息,携带的礼物可以适当减少 ")])]),e.createElementVNode("view",{class:"tip-section"},[e.createElementVNode("view",{class:"tip-icon"},"💡"),e.createElementVNode("text",{class:"tip-text"},"多与AI聊天可以提升理解等级，提高准确度和效率")])])])}]]);const d=a({name:"AIList",data:()=>({userAiModels:[],groupedModels:{},loading:!0,errorMessage:""}),onLoad(){this.loadUserAiModels()},methods:{async loadUserAiModels(){this.loading=!0,this.errorMessage="";try{const e=uni.getStorageSync("userId");if(!e)return this.errorMessage="用户未登录",void(this.loading=!1);const t=await this.getUserAiModels(e);t.data&&t.data.length>0?(this.userAiModels=t.data,this.groupModelsByFirstLetter()):(this.userAiModels=[],this.groupedModels={})}catch(e){o("error","at pages/ai/ai-list.vue:156","加载用户AI模型失败:",e),this.errorMessage="加载AI模型失败，请重试"}finally{this.loading=!1}},getUserAiModels:e=>new Promise(((t,a)=>{uni.request({url:`http://localhost:8888/api/user-ai-model/user/${e}`,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),groupModelsByFirstLetter(){const e={};this.userAiModels.forEach((t=>{const a=t.modelName||"未知AI",s=this.getFirstLetter(a);e[s]||(e[s]=[]),e[s].push(t)})),Object.keys(e).forEach((t=>{e[t].sort(((e,t)=>{const a=e.modelName||"",s=t.modelName||"";return a.localeCompare(s,"zh-CN")}))})),this.groupedModels=e},getFirstLetter(e){if(!e)return"Z";if(/^[A-Za-z]/.test(e))return e.charAt(0).toUpperCase();const t=e.charAt(0),a=t.charCodeAt(0);if(a>=19968&&a<=40959){return{"宠":"C","搭":"D","学":"X","游":"Y","运":"Y","工":"G","商":"S","医":"Y","教":"J","科":"K","艺":"Y","体":"T","文":"W","理":"L","法":"F","经":"J","管":"G","计":"J","机":"J","电":"D","通":"T","信":"X","网":"W","软":"R","硬":"Y","数":"S","据":"J","人":"R","工":"G","智":"Z","能":"N","机":"J","器":"Q","学":"X","习":"X"}[t]||this.getPinyinFirstLetter(t)}return"Z"},getPinyinFirstLetter(e){const t=e.charCodeAt(0);return t>=19968&&t<=40959?t<20224?"A":t<20480?"B":t<20736?"C":t<20992?"D":t<21248?"E":t<21504?"F":t<21760?"G":t<22016?"H":t<22272?"I":t<22528?"J":t<22784?"K":t<23040?"L":t<23296?"M":t<23552?"N":t<23808?"O":t<24064?"P":t<24320?"Q":t<24576?"R":t<24832?"S":t<25088?"T":t<25344?"U":t<25600?"V":t<25856?"W":t<26112?"X":t<26368?"Y":"Z":"Z"},getSortedLetters(){return Object.keys(this.groupedModels).sort(((e,t)=>/^[A-Z]$/.test(e)&&/^[A-Z]$/.test(t)?e.localeCompare(t):/^[A-Z]$/.test(e)?-1:/^[A-Z]$/.test(t)?1:e.localeCompare(t,"zh-CN")))},retryLoad(){this.loadUserAiModels()},goBack(){uni.navigateBack()},openSearch(){uni.showToast({title:"搜索功能",icon:"none"})},selectAI(e){uni.navigateTo({url:`/pages/ai/ai-chat?modelId=${e.userAiId}&modelName=${encodeURIComponent(e.modelName||"未知AI")}`})},getAvatarClass(e){if(!e)return"default-ai-avatar";const t=e.toLowerCase();return t.includes("宠")||t.includes("pet")?"pet-ai-avatar":t.includes("搭")||t.includes("partner")?"partner-ai-avatar":t.includes("学")||t.includes("study")?"study-ai-avatar":t.includes("游")||t.includes("game")?"gaming-ai-avatar":t.includes("运")||t.includes("sport")?"sports-ai-avatar":t.includes("工")||t.includes("work")?"work-ai-avatar":t.includes("商")||t.includes("business")?"business-ai-avatar":"default-ai-avatar"},getAvatarText:e=>e?e.charAt(0).toUpperCase():"?",goToHome(){uni.navigateTo({url:"/pages/content-feed/content-feed"})},goToMessages(){uni.showToast({title:"消息功能",icon:"none"})},goToFriends(){uni.navigateTo({url:"/pages/friend-list/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/user-profile/user-profile"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"ai-list-page"},[e.createElementVNode("view",{class:"content-area"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-section"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载AI模型...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-section"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.retryLoad&&n.retryLoad(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):0===i.userAiModels.length?(e.openBlock(),e.createElementBlock("view",{key:2,class:"empty-section"},[e.createElementVNode("view",{class:"empty-icon"},"🤖"),e.createElementVNode("text",{class:"empty-text"},"您还没有任何AI模型"),e.createElementVNode("text",{class:"empty-desc"},"快去购买或创建您的第一个AI助手吧！")])):(e.openBlock(),e.createElementBlock("view",{key:3},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.getSortedLetters(),(t=>(e.openBlock(),e.createElementBlock("view",{key:t,class:"category-section"},[e.createElementVNode("view",{class:"category-header"},[e.createElementVNode("text",{class:"category-letter"},e.toDisplayString(t),1)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.groupedModels[t],(t=>(e.openBlock(),e.createElementBlock("view",{key:t.userAiId,class:"ai-item",onClick:e=>n.selectAI(t)},[e.createElementVNode("view",{class:"ai-avatar"},[t.modelImageUrl?(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar-image",src:t.modelImageUrl,mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["avatar-circle",n.getAvatarClass(t.modelName)])},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString(n.getAvatarText(t.modelName)),1)],2))]),e.createElementVNode("view",{class:"ai-info"},[e.createElementVNode("text",{class:"ai-name"},e.toDisplayString(t.modelName||"未知AI"),1),t.customDesc?(e.openBlock(),e.createElementBlock("text",{key:0,class:"ai-desc"},e.toDisplayString(t.customDesc),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"ai-meta"},[e.createElementVNode("text",{class:"ai-level"},"Lv."+e.toDisplayString(t.level||1),1),e.createElementVNode("text",{class:"ai-power"},e.toDisplayString(t.power||0)+" 能量",1)])])],8,["onClick"])))),128))])))),128))]))]),e.createElementVNode("view",{class:"bottom-nav"},[e.createElementVNode("view",{class:"nav-item",onClick:a[1]||(a[1]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item",onClick:a[2]||(a[2]=(...e)=>n.goToMessages&&n.goToMessages(...e))},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item active"},[e.createElementVNode("view",{class:"ai-icon"},"AI")]),e.createElementVNode("view",{class:"nav-item",onClick:a[3]||(a[3]=(...e)=>n.goToFriends&&n.goToFriends(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-item",onClick:a[4]||(a[4]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("view",{class:"nav-avatar"},[e.createElementVNode("view",{class:"mini-cat-avatar"},[e.createElementVNode("view",{class:"mini-cat-body"}),e.createElementVNode("view",{class:"mini-cat-face"},[e.createElementVNode("view",{class:"mini-cat-eyes"},[e.createElementVNode("view",{class:"mini-cat-eye"}),e.createElementVNode("view",{class:"mini-cat-eye"})])])])])])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const m=a({data:()=>({aiName:"宠物交友AI",modelId:null,aiModelData:null,loading:!1,errorMessage:"",hasPurchased:!1,userGold:null,showReviewModal:!1,reviewRating:0,reviewText:"",aiReviews:[],reviewsLoading:!1,reviewsError:""}),computed:{canSubmitReview(){return this.reviewRating>0&&this.reviewText.trim().length>0}},onLoad(e){e.aiName&&(this.aiName=decodeURIComponent(e.aiName)),e.modelId&&(this.modelId=e.modelId),this.loadAiModelDetail(),this.loadAiReviews(),this.checkPurchaseStatus()},methods:{async loadAiModelDetail(){if(!this.modelId)return o("error","at pages/ai/pet-ai-detail.vue:271","模型ID不存在"),void(this.errorMessage="模型ID不存在");try{this.loading=!0,this.errorMessage="";const e=await this.getAimodelBaseInfoById(this.modelId);e&&e.data?(this.aiModelData=e.data,this.aiName=e.data.modelName||this.aiName,o("log","at pages/ai/pet-ai-detail.vue:284","AI模型详情加载成功:",this.aiModelData)):this.errorMessage="AI模型不存在"}catch(e){o("error","at pages/ai/pet-ai-detail.vue:289","加载AI模型详情失败:",e),this.errorMessage="加载失败，请重试"}finally{this.loading=!1}},getAimodelBaseInfoById:e=>new Promise(((t,a)=>{uni.request({url:`http://localhost:8888/api/a-entities/aimodel-base-info/${e}`,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),async loadAiReviews(){if(this.modelId)try{this.reviewsLoading=!0,this.reviewsError="";const e=await this.getUserAiCommentsByAimodelId(this.modelId);e&&e.data?(this.aiReviews=this.convertCommentsToReviews(e.data),o("log","at pages/ai/pet-ai-detail.vue:327","AI模型评论加载成功:",this.aiReviews)):this.aiReviews=[]}catch(e){o("error","at pages/ai/pet-ai-detail.vue:332","加载AI模型评论失败:",e),this.reviewsError="加载评论失败，请重试",this.aiReviews=[]}finally{this.reviewsLoading=!1}else o("error","at pages/ai/pet-ai-detail.vue:316","模型ID不存在，无法加载评论")},getUserAiCommentsByAimodelId:e=>new Promise(((t,a)=>{uni.request({url:`http://localhost:8888/api/u-entities/user-ai-comment/aimodel/${e}`,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),convertCommentsToReviews(e){return e.map((e=>({id:e.userAiCommentId,username:`用户${e.userId}`,userAvatar:"/static/avatar1.png",time:this.formatCommentTime(e.createdAt),rating:e.stars||5,content:e.commentText||"暂无评价内容"})))},formatCommentTime(e){if(!e)return"未知时间";const t=new Date-new Date(e),a=Math.floor(t/864e5);if(0===a)return"今天";if(1===a)return"昨天";if(a<7)return`${a}天前`;if(a<30){return`${Math.floor(a/7)}周前`}return`${Math.floor(a/30)}个月前`},async checkPurchaseStatus(){try{const e=uni.getStorageSync("userId");if(!e)return o("log","at pages/ai/pet-ai-detail.vue:398","用户未登录，无法检查购买状态"),this.hasPurchased=!1,void(this.userGold=null);const[t,a]=await Promise.allSettled([this.getUserAiModels(e),this.getUserGoldBalance(e)]);"fulfilled"===t.status&&t.value&&t.value.data?(this.hasPurchased=t.value.data.some((e=>e.parentModelId==this.modelId||e.modelName===this.aiName)),o("log","at pages/ai/pet-ai-detail.vue:417",`AI模型 ${this.aiName} (ID: ${this.modelId}) 购买状态:`,this.hasPurchased)):(this.hasPurchased=!1,o("error","at pages/ai/pet-ai-detail.vue:420","获取购买状态失败:",t.reason)),"fulfilled"===a.status&&a.value&&a.value.data?(this.userGold=a.value.data.gold,o("log","at pages/ai/pet-ai-detail.vue:426","用户金币余额:",this.userGold)):(this.userGold=null,o("error","at pages/ai/pet-ai-detail.vue:429","获取用户金币余额失败:",a.reason))}catch(e){o("error","at pages/ai/pet-ai-detail.vue:432","检查购买状态失败:",e),this.hasPurchased=!1,this.userGold=null}},getUserAiModels:e=>new Promise(((t,a)=>{uni.request({url:`http://localhost:8888/api/user-ai-model/user/${e}`,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),getUserGoldBalance:e=>new Promise(((t,a)=>{uni.request({url:`http://localhost:8888/api/users/${e}`,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),savePurchaseStatus(){const e=uni.getStorageSync("purchasedAIs")||[];e.includes(this.aiName)||(e.push(this.aiName),uni.setStorageSync("purchasedAIs",e),o("log","at pages/ai/pet-ai-detail.vue:478","购买状态已保存到本地存储"))},getAIDescription(){return this.aiModelData&&this.aiModelData.modelDesc?this.aiModelData.modelDesc:"这是一个智能交友AI，可以帮助你找到志同道合的朋友"},getAIPrice(){if(this.aiModelData&&this.aiModelData.price){return Math.round(100*this.aiModelData.price)+"C"}return"15000C"},formatGoldBalance:e=>e||0===e?e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString():"0",async buyAI(){try{if(this.hasPurchased)return void uni.showToast({title:"您已购买此AI模型",icon:"none"});if(!(await new Promise((e=>{uni.showModal({title:"确认购买",content:`确定要购买${this.aiName}吗？价格：${this.getAIPrice()}`,success:t=>{e(t.confirm)},fail:()=>{e(!1)}})}))))return;uni.showLoading({title:"购买中..."});const e=uni.getStorageSync("userId");if(!e)return uni.hideLoading(),void uni.showToast({title:"请先登录",icon:"none"});const t=await this.purchaseAiModel(e);uni.hideLoading(),t.success?(this.hasPurchased=!0,uni.showToast({title:"购买成功！",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:`/pages/ai/ai-chat?modelId=${this.modelId}&modelName=${encodeURIComponent(this.aiName)}`})}),1500)):uni.showToast({title:t.message||"购买失败",icon:"none"})}catch(e){uni.hideLoading(),o("error","at pages/ai/pet-ai-detail.vue:582","购买AI模型失败:",e),uni.showToast({title:"购买失败，请重试",icon:"none"})}},purchaseAiModel(e){return new Promise(((t,a)=>{const s={userId:parseInt(e),parentModelId:this.modelId,modelName:this.aiName,modelDesc:this.aiModelData?this.aiModelData.modelDesc:"",modelImageUrl:this.aiModelData?this.aiModelData.modelImageUrl:"",price:this.aiModelData?this.aiModelData.price:0};o("log","at pages/ai/pet-ai-detail.vue:602","发送购买请求:",s),uni.request({url:"http://localhost:8888/api/u-entities/user-ai-model/purchase",method:"POST",header:{"Content-Type":"application/json"},data:s,timeout:1e4,success:e=>{o("log","at pages/ai/pet-ai-detail.vue:613","购买响应:",e),t(e.data)},fail:e=>{o("error","at pages/ai/pet-ai-detail.vue:617","购买请求失败:",e),a(e)}})}))},async tryAI(){try{if(this.hasPurchased)return void uni.showToast({title:"您已购买此AI模型，无需试用",icon:"none"});const e=uni.getStorageSync("userId");if(!e)return void uni.showToast({title:"请先登录",icon:"none"});uni.showLoading({title:"试用中..."});const t=await this.tryOutAiModel(e);uni.hideLoading(),t.success?(uni.showToast({title:t.message,icon:"success"}),setTimeout((()=>{uni.navigateTo({url:`/pages/ai/ai-chat?modelId=${this.modelId}&modelName=${encodeURIComponent(this.aiName)}&isTryOut=true`})}),1500)):uni.showToast({title:t.message||"试用失败",icon:"none"})}catch(e){uni.hideLoading(),o("error","at pages/ai/pet-ai-detail.vue:674","试用AI模型失败:",e),uni.showToast({title:"试用失败，请重试",icon:"none"})}},tryOutAiModel(e){return new Promise(((t,a)=>{const s={userId:parseInt(e),parentModelId:this.modelId};o("log","at pages/ai/pet-ai-detail.vue:690","发送试用请求:",s),uni.request({url:"http://localhost:8888/api/user-ai-model/try-out",method:"POST",header:{"Content-Type":"application/json"},data:s,timeout:1e4,success:e=>{o("log","at pages/ai/pet-ai-detail.vue:701","试用响应:",e),t(e.data)},fail:e=>{o("error","at pages/ai/pet-ai-detail.vue:705","试用请求失败:",e),a(e)}})}))},goBack(){uni.navigateBack()},formatCount:e=>e>=1e4?(e/1e4).toFixed(1)+"w":e.toString(),formatRecommendCount:e=>e?e>=1e4?(e/1e4).toFixed(1)+"w":e.toString():"0",formatPurchaseCount:e=>e?e>=1e4?(e/1e4).toFixed(1)+"w":e.toString():"0",getTotalReviewsCount(){return this.aiReviews.length},showReviewInput(){this.hasPurchased?(this.reviewRating=0,this.reviewText="",this.showReviewModal=!0):uni.showModal({title:"提示",content:"您需要先购买此AI模型才能评价",showCancel:!1,confirmText:"知道了"})},hideReviewModal(){this.showReviewModal=!1,this.reviewRating=0,this.reviewText=""},setRating(e){this.reviewRating=e},async submitReview(){if(0!==this.reviewRating)if(this.reviewText.trim())try{const e=uni.getStorageSync("userId");if(!e)return void uni.showToast({title:"请先登录",icon:"none"});uni.showLoading({title:"提交中..."});const t=await this.saveUserAiComment(e);uni.hideLoading(),t.success?(await this.loadAiReviews(),uni.showToast({title:"评价提交成功",icon:"success"}),this.hideReviewModal()):uni.showToast({title:t.message||"评价提交失败",icon:"none"})}catch(e){uni.hideLoading(),o("error","at pages/ai/pet-ai-detail.vue:834","提交评价失败:",e),uni.showToast({title:"评价提交失败，请重试",icon:"none"})}else uni.showToast({title:"请输入评价内容",icon:"none"});else uni.showToast({title:"请选择评分",icon:"none"})},saveUserAiComment(e){return new Promise(((t,a)=>{const s={aimodelId:this.modelId,userId:parseInt(e),commentText:this.reviewText,stars:this.reviewRating};o("log","at pages/ai/pet-ai-detail.vue:852","发送评价请求:",s),uni.request({url:"http://localhost:8888/api/u-entities/user-ai-comment/save",method:"POST",header:{"Content-Type":"application/json"},data:s,timeout:1e4,success:e=>{o("log","at pages/ai/pet-ai-detail.vue:863","评价响应:",e),t(e.data)},fail:e=>{o("error","at pages/ai/pet-ai-detail.vue:867","评价请求失败:",e),a(e)}})}))}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"cartoon-character"})]),i.aiModelData?(e.openBlock(),e.createElementBlock("view",{key:0,class:"floating-card"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-value"},e.toDisplayString(n.formatRecommendCount(i.aiModelData.recommendCount)),1),e.createElementVNode("text",{class:"info-label"},"推荐数")]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-value"},e.toDisplayString(n.formatPurchaseCount(i.aiModelData.purchaseCount)),1),e.createElementVNode("text",{class:"info-label"},"购买数")]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-value"},e.toDisplayString(n.getAIPrice()),1),e.createElementVNode("text",{class:"info-label"},"价格")])])):e.createCommentVNode("",!0),i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载AI模型详情...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:2,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.loadAiModelDetail&&n.loadAiModelDetail(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:3,class:"main-content"},[e.createElementVNode("view",{class:"product-title"},e.toDisplayString(i.aiName),1),e.createElementVNode("view",{class:"product-info-section"},[e.createElementVNode("view",{class:"product-content"},[e.createElementVNode("view",{class:"product-description"}," 产品描述: "+e.toDisplayString(n.getAIDescription()),1),e.createElementVNode("view",{class:"image-grid"},[e.createElementVNode("view",{class:"image-item"},[e.createElementVNode("view",{class:"cat-image cat-1"})]),e.createElementVNode("view",{class:"image-item"},[e.createElementVNode("view",{class:"cat-image cat-2"})]),e.createElementVNode("view",{class:"image-item"},[e.createElementVNode("view",{class:"cat-image cat-3"})]),e.createElementVNode("view",{class:"image-item"},[e.createElementVNode("view",{class:"cat-image cat-4"})])])]),e.createElementVNode("view",{class:"right-action-buttons"},[i.hasPurchased?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-item purchased-item"},[e.createElementVNode("view",{class:"action-icon purchased-icon"},[e.createElementVNode("text",{class:"icon-text"},"✅")]),e.createElementVNode("text",{class:"action-text"},"已购买"),e.createElementVNode("text",{class:"purchase-time-text"},"购买后可永久使用")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"action-item",onClick:a[1]||(a[1]=(...e)=>n.buyAI&&n.buyAI(...e))},[e.createElementVNode("view",{class:"action-icon buy-icon"},[e.createElementVNode("text",{class:"icon-text"},"🛒")]),e.createElementVNode("text",{class:"action-text"},"立刻购买"),null!==i.userGold?(e.openBlock(),e.createElementBlock("text",{key:0,class:"balance-text"},"我的余额:"+e.toDisplayString(n.formatGoldBalance(i.userGold))+"C",1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"balance-text balance-error"},"获取余额失败"))])),e.createElementVNode("view",{class:"action-item",onClick:a[2]||(a[2]=(...e)=>n.tryAI&&n.tryAI(...e))},[e.createElementVNode("view",{class:"action-icon try-icon"},[e.createElementVNode("text",{class:"icon-text"},"⏰")]),e.createElementVNode("text",{class:"action-text"},"试用模型")])])]),e.createElementVNode("view",{class:"reviews-section"},[i.hasPurchased?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"purchase-status-hint"},[e.createElementVNode("text",{class:"hint-icon"},"💡"),e.createElementVNode("text",{class:"hint-text"},"购买此AI模型后即可发表评价和回复")])),e.createElementVNode("view",{class:"reviews-header"},[e.createElementVNode("view",{class:"reviews-left"},[e.createElementVNode("text",{class:"reviews-title"},"用户评价 ("+e.toDisplayString(n.getTotalReviewsCount())+")",1)]),e.createElementVNode("view",{class:e.normalizeClass(["review-button",{disabled:!i.hasPurchased}]),onClick:a[3]||(a[3]=(...e)=>n.showReviewInput&&n.showReviewInput(...e))},[e.createElementVNode("text",{class:"review-button-text"},e.toDisplayString(i.hasPurchased?"评价":"购买后评价"),1)],2)]),i.reviewsLoading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"reviews-loading"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载评论...")])):i.reviewsError?(e.openBlock(),e.createElementBlock("view",{key:2,class:"reviews-error"},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.reviewsError),1),e.createElementVNode("view",{class:"retry-button",onClick:a[4]||(a[4]=(...e)=>n.loadAiReviews&&n.loadAiReviews(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):0===i.aiReviews.length?(e.openBlock(),e.createElementBlock("view",{key:3,class:"reviews-empty"},[e.createElementVNode("view",{class:"empty-icon"},"💬"),e.createElementVNode("text",{class:"empty-text"},"暂无评价"),e.createElementVNode("text",{class:"empty-desc"},"成为第一个评价此AI模型的用户吧！")])):(e.openBlock(),e.createElementBlock("view",{key:4,class:"reviews-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.aiReviews,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"review-item",key:t.id||a},[e.createElementVNode("view",{class:"review-avatar"},[e.createElementVNode("image",{class:"review-user-avatar",src:t.userAvatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"review-content"},[e.createElementVNode("view",{class:"review-user-info"},[e.createElementVNode("text",{class:"review-username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:"review-time"},e.toDisplayString(t.time),1)]),e.createElementVNode("view",{class:"review-rating"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(5,(a=>e.createElementVNode("text",{class:e.normalizeClass(["star",{active:a<=t.rating}]),key:a},"⭐",2))),64))]),e.createElementVNode("text",{class:"review-text"},e.toDisplayString(t.content),1)])])))),128))]))])])),i.showReviewModal?(e.openBlock(),e.createElementBlock("view",{key:4,class:"review-modal",onClick:a[10]||(a[10]=(...e)=>n.hideReviewModal&&n.hideReviewModal(...e))},[e.createElementVNode("view",{class:"review-modal-content",onClick:a[9]||(a[9]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"review-modal-header"},[e.createElementVNode("text",{class:"review-modal-title"},"写评价"),e.createElementVNode("view",{class:"close-button",onClick:a[5]||(a[5]=(...e)=>n.hideReviewModal&&n.hideReviewModal(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"review-rating-input"},[e.createElementVNode("text",{class:"rating-label"},"评分:"),e.createElementVNode("view",{class:"stars-input"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(5,(t=>e.createElementVNode("text",{class:e.normalizeClass(["star-input",{active:t<=i.reviewRating}]),key:t,onClick:e=>n.setRating(t)},"⭐",10,["onClick"]))),64))])]),e.withDirectives(e.createElementVNode("textarea",{class:"review-text-input","onUpdate:modelValue":a[6]||(a[6]=e=>i.reviewText=e),placeholder:"请输入您的评价内容...",maxlength:"500"},null,512),[[e.vModelText,i.reviewText]]),e.createElementVNode("view",{class:"review-modal-actions"},[e.createElementVNode("view",{class:"cancel-button",onClick:a[7]||(a[7]=(...e)=>n.hideReviewModal&&n.hideReviewModal(...e))},[e.createElementVNode("text",{class:"cancel-text"},"取消")]),e.createElementVNode("view",{class:e.normalizeClass(["submit-button",{active:n.canSubmitReview}]),onClick:a[8]||(a[8]=(...e)=>n.submitReview&&n.submitReview(...e))},[e.createElementVNode("text",{class:"submit-text"},"提交评价")],2)])])])):e.createCommentVNode("",!0)])}]]);const g=a({name:"AiChat",data:()=>({showActionSheet:!1,scrollTop:0,inputMessage:"",inputFocus:!1,isVoiceMode:!1,showEmojiPanel:!1,showPlusPanel:!1,currentAiModel:{},loading:!1,chatLoading:!1,messages:[],modelId:null}),onLoad(e){if(o("log","at pages/ai/ai-chat.vue:233","ai-chat页面加载，接收到的参数:",e),!e.modelId)return o("log","at pages/ai/ai-chat.vue:237","没有modelId参数，显示错误"),void this.showModelNotFoundError();this.modelId=e.modelId,o("log","at pages/ai/ai-chat.vue:244","保存的modelId:",this.modelId);const t=uni.getStorageSync("userId");if(o("log","at pages/ai/ai-chat.vue:248","获取到的userId:",t),!t)return o("log","at pages/ai/ai-chat.vue:250","没有userId，显示登录错误"),void this.showUserNotLoginError();o("log","at pages/ai/ai-chat.vue:256","开始加载AI模型数据和聊天记录"),this.loadAiModelData(e.modelId,t),this.loadChatMessages(t,e.modelId),this.$nextTick((()=>{this.scrollToBottom()}))},methods:{async loadAiModelData(e,t){try{this.loading=!0;const a=await this.getUserAiModelByUserId(t);if(a&&a.data){const t=a.data.find((t=>t.userAiId==e||t.parentModelId==e));if(t)return void(this.currentAiModel=t)}const s=await this.getAimodelBaseInfoById(e);if(s&&s.data)return void(this.currentAiModel=s.data);this.showModelNotFoundError()}catch(a){o("error","at pages/ai/ai-chat.vue:296","加载AI模型数据失败:",a),this.showNetworkError()}finally{this.loading=!1}},getUserAiModelByUserId:e=>new Promise(((t,a)=>{uni.request({url:"http://localhost:8888/api/user-ai-model/user/"+e,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),getUserAiModelById:e=>new Promise(((t,a)=>{uni.request({url:"http://localhost:8888/api/user-ai-model/"+e,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),getAimodelBaseInfoById:e=>new Promise(((t,a)=>{uni.request({url:"http://localhost:8888/api/entity/aimodel-base-info/"+e,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),async loadChatMessages(e,t){try{this.chatLoading=!0,o("log","at pages/ai/ai-chat.vue:358","开始加载聊天记录，userId:",e,"userAiId:",t);const a=await this.getChatMessages(e,t);o("log","at pages/ai/ai-chat.vue:361","获取聊天记录响应:",a),a.data&&a.data.length>0?(o("log","at pages/ai/ai-chat.vue:364","找到聊天记录，数量:",a.data.length),o("log","at pages/ai/ai-chat.vue:365","原始聊天数据:",a.data),this.messages=this.convertChatDataToMessages(a.data),o("log","at pages/ai/ai-chat.vue:368","转换后的消息:",this.messages)):(o("log","at pages/ai/ai-chat.vue:370","没有找到聊天记录，显示默认欢迎消息"),this.messages=[{id:1,type:"left",text:"你好！我是你的 AI 助手，有什么可以帮助你的吗？",time:this.getCurrentTime()}])}catch(a){o("error","at pages/ai/ai-chat.vue:380","加载聊天记录失败:",a),this.messages=[{id:1,type:"left",text:"你好！我是你的 AI 助手，有什么可以帮助你的吗？",time:this.getCurrentTime()}]}finally{this.chatLoading=!1}},getChatMessages:(e,t)=>new Promise(((a,s)=>{uni.request({url:`http://localhost:8888/api/a-entities-wlq/ai-chat-list-detail-r/user/${e}/ai/${t}`,method:"GET",timeout:1e4,success:e=>{a(e)},fail:e=>{s(e)}})})),convertChatDataToMessages(e){const t=[];let a=1;return e.sort(((e,t)=>e.messageTimestamp&&t.messageTimestamp?new Date(e.messageTimestamp)-new Date(t.messageTimestamp):0)),e.forEach((e=>{e.userMessage&&t.push({id:a++,type:"right",text:e.userMessage,time:this.formatTimestamp(e.messageTimestamp)}),e.aiResponse&&t.push({id:a++,type:"left",text:e.aiResponse,time:this.formatTimestamp(e.messageTimestamp)})})),t},formatTimestamp(e){if(!e)return this.getCurrentTime();const t=new Date(e),a=new Date,s=a-t;if(s<864e5&&t.getDate()===a.getDate()){const e=t.getHours();return`${e<12?"上午":"下午"}${e<12?e:e-12}:${t.getMinutes().toString().padStart(2,"0")}`}return s<1728e5&&t.getDate()===a.getDate()-1?"昨天 "+this.formatTime(t):`${t.getMonth()+1}月${t.getDate()}日 ${this.formatTime(t)}`},formatTime(e){const t=e.getHours();return`${t<12?"上午":"下午"}${t<12?t:t-12}:${e.getMinutes().toString().padStart(2,"0")}`},showModelNotFoundError(){this.currentAiModel={modelId:null,modelName:"模型不存在",modelDesc:"抱歉，您要访问的AI模型不存在或已被删除",modelImageUrl:null},uni.showToast({title:"AI模型不存在",icon:"none",duration:3e3})},showNetworkError(){this.currentAiModel={modelId:null,modelName:"网络连接失败",modelDesc:"网络连接超时，请检查网络设置后重试",modelImageUrl:null},uni.showToast({title:"网络连接超时",icon:"none",duration:3e3})},showUserNotLoginError(){this.currentAiModel={modelId:null,modelName:"请先登录",modelDesc:"您需要先登录才能使用AI聊天功能",modelImageUrl:null},uni.showToast({title:"请先登录",icon:"none",duration:3e3}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login-replica"})}),2e3)},goBack(){try{uni.navigateBack({fail:()=>{uni.navigateTo({url:"/pages/ai/ai-list"})}})}catch(e){uni.navigateTo({url:"/pages/ai/ai-list"})}},showMoreOptions(){this.showActionSheet=!0},hideActionSheet(){this.showActionSheet=!1},goToMyAIModels(){this.hideActionSheet(),uni.navigateTo({url:"/pages/ai/ai-list"})},goToAIDetails(){this.hideActionSheet();const e=this.currentAiModel.modelName||this.modelId||"AI助手";uni.navigateTo({url:`/pages/ai/gift?userAiId=${this.modelId}&aiName=${encodeURIComponent(e)}`})},goToAIStore(){this.hideActionSheet(),uni.navigateTo({url:"/pages/ai/ai-store"})},toggleVoiceInput(){this.isVoiceMode=!this.isVoiceMode,this.isVoiceMode&&(this.showEmojiPanel=!1,this.showPlusPanel=!1)},toggleEmoji(){this.showEmojiPanel=!this.showEmojiPanel,this.showPlusPanel=!1},togglePlusMenu(){this.showPlusPanel=!this.showPlusPanel,this.showEmojiPanel=!1},hideEmojiPanel(){this.showEmojiPanel=!1},hidePlusPanel(){this.showPlusPanel=!1},startVoiceRecord(){uni.showToast({title:"开始录音",icon:"none"})},endVoiceRecord(){uni.showToast({title:"录音完成",icon:"none"})},selectImage(){this.hidePlusPanel(),uni.showToast({title:"图片选择功能开发中",icon:"none"})},openCamera(){this.hidePlusPanel(),uni.showToast({title:"相机功能开发中",icon:"none"})},makeCall(){this.hidePlusPanel(),uni.showToast({title:"通话功能开发中",icon:"none"})},shareLocation(){this.hidePlusPanel(),uni.showToast({title:"位置分享功能开发中",icon:"none"})},onInputFocus(){this.inputFocus=!0},onInputBlur(){this.inputFocus=!1},async sendMessage(){if(!this.inputMessage.trim())return;const e=this.inputMessage.trim(),t=uni.getStorageSync("userId");if(!t)return void uni.showToast({title:"请先登录",icon:"none"});const a={id:Date.now(),type:"right",text:e,time:this.getCurrentTime()};this.messages.push(a),this.inputMessage="",this.$nextTick((()=>{this.scrollToBottom()}));try{const a=this.generateAIResponse(e),s={id:Date.now()+1,type:"left",text:a,time:this.getCurrentTime()};this.messages.push(s),await this.saveChatMessage(t,this.modelId,e,a,"ai_chat"),this.$nextTick((()=>{this.scrollToBottom()}))}catch(s){o("error","at pages/ai/ai-chat.vue:733","发送消息失败:",s),uni.showToast({title:"发送失败，请重试",icon:"none"})}},generateAIResponse(e){const t=["我理解你的问题，让我来帮你解答。","这是一个很有趣的问题！","根据我的分析，我认为...","让我为你提供一些建议。","这个问题需要仔细考虑，我的建议是...","谢谢你的提问，让我想想...","这是一个很好的观点！","我建议你可以尝试..."];return t[Math.floor(Math.random()*t.length)]},getCurrentTime(){const e=new Date,t=e.getHours();return`${t<12?"上午":"下午"}${t<12?t:t-12}:${e.getMinutes().toString().padStart(2,"0")}`},scrollToBottom(){this.scrollTop=999999},getAvatarText(){return this.currentAiModel.modelName?this.currentAiModel.modelName.charAt(0):"?"},saveChatMessage:async(e,t,a,s,i)=>new Promise(((n,l)=>{const c={userId:parseInt(e),userAiId:t?parseInt(t):null,userMessage:a,aiResponse:s,chatType:i,messageTimestamp:(new Date).toISOString(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};o("log","at pages/ai/ai-chat.vue:793","发送聊天数据:",c),uni.request({url:"http://localhost:8888/api/a-entities-wlq/ai-chat-list-detail-r/save",method:"POST",header:{"Content-Type":"application/json"},data:c,timeout:1e4,success:e=>{o("log","at pages/ai/ai-chat.vue:804","聊天消息保存成功:",e),n(e)},fail:e=>{o("error","at pages/ai/ai-chat.vue:808","聊天消息保存失败:",e),l(e)}})}))}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"chat-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-btn",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"back-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666","p-id":"727"})]))]),e.createElementVNode("text",{class:"title"},e.toDisplayString(i.currentAiModel.modelName||"AI 助手"),1),e.createElementVNode("view",{class:"more-btn",onClick:a[1]||(a[1]=(...e)=>n.showMoreOptions&&n.showMoreOptions(...e))},[e.createElementVNode("view",{class:"dot"}),e.createElementVNode("view",{class:"dot"}),e.createElementVNode("view",{class:"dot"})])]),e.createElementVNode("scroll-view",{class:"chat-area","scroll-y":"true","scroll-top":i.scrollTop},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载AI模型...")])):i.chatLoading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载聊天记录...")])):i.messages.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(i.messages,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["message",t.type])},["left"===t.type&&i.currentAiModel.modelImageUrl?(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar",src:i.currentAiModel.modelImageUrl,mode:"aspectFill"},null,8,["src"])):"left"===t.type?(e.openBlock(),e.createElementBlock("view",{key:1,class:"avatar avatar-placeholder"},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString(n.getAvatarText()),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"message-bubble"},[e.createElementVNode("text",{class:"message-text"},e.toDisplayString(t.text),1),t.time?(e.openBlock(),e.createElementBlock("text",{key:0,class:"message-time"},e.toDisplayString(t.time),1)):e.createCommentVNode("",!0)]),"right"===t.type?(e.openBlock(),e.createElementBlock("image",{key:2,class:"avatar",src:"/static/logo.png",mode:"aspectFill"})):e.createCommentVNode("",!0)],2)))),128)):(e.openBlock(),e.createElementBlock("view",{key:3,class:"no-messages"},[e.createElementVNode("text",{class:"no-messages-text"},"暂无聊天记录")]))],8,["scroll-top"]),e.createElementVNode("view",{class:"input-bar"},[e.createElementVNode("view",{class:"mic-btn",onClick:a[2]||(a[2]=(...e)=>n.toggleVoiceInput&&n.toggleVoiceInput(...e))},[i.isVoiceMode?(e.openBlock(),e.createElementBlock("svg",{key:1,class:"keyboard-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M512 64A448 448 0 1 0 960 512 448.5 448.5 0 0 0 512 64z m0 832a384 384 0 1 1 384-384 384.5 384.5 0 0 1-384 384z",fill:"#333333","p-id":"2120"}),e.createElementVNode("path",{d:"M320 400m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z",fill:"#333333","p-id":"2121"}),e.createElementVNode("path",{d:"M448 448A48 48 0 1 0 400 400a48 48 0 0 0 48 48zM576 352a48 48 0 1 0 48 48 48 48 0 0 0-48-48zM704 352a48 48 0 1 0 48 48 48 48 0 0 0-48-48z",fill:"#333333","p-id":"2122"}),e.createElementVNode("path",{d:"M320 528m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z",fill:"#333333","p-id":"2123"}),e.createElementVNode("path",{d:"M448 576a48 48 0 1 0-48-48 48 48 0 0 0 48 48zM576 640H448a48 48 0 0 0 0 96h128a48 48 0 1 0 0-96zM576 480a48 48 0 1 0 48 48 48 48 0 0 0-48-48zM704 480a48 48 0 1 0 48 48 48 48 0 0 0-48-48z",fill:"#333333","p-id":"2124"})])):(e.openBlock(),e.createElementBlock("svg",{key:0,class:"mic-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M593.024 234.496l-46.165333 46.229333c0.106667 0.085333 0.149333 0.149333 0.277333 0.234667 127.552 127.658667 127.552 334.677333 0 462.336l46.122667 46.250667c153.045333-153.194667 153.045333-401.621333 0-554.816C593.173333 234.666667 593.130667 234.56 593.024 234.496z","p-id":"3544"}),e.createElementVNode("path",{d:"M500.885333 327.189333c-0.042667-0.085333-0.128-0.149333-0.234667-0.213333l-46.165333 46.229333c0.042667 0.085333 0.128 0.149333 0.234667 0.256 76.48 76.565333 76.48 200.789333 0 277.397333l46.144 46.229333C603.008 595.008 603.008 429.333333 500.885333 327.189333z","p-id":"3545"}),e.createElementVNode("path",{d:"M408.32 419.434667l-92.394667 92.458667 92.629333 92.714667c51.008-51.114667 51.008-133.888 0-184.938667C408.469333 419.584 408.362667 419.52 408.32 419.434667z","p-id":"3546"}),e.createElementVNode("path",{d:"M512 0C229.696 0 0 229.696 0 512c0 282.282667 229.696 512 512 512 282.282667 0 512-229.717333 512-512C1024 229.696 794.282667 0 512 0zM512 981.290667C253.226667 981.290667 42.688 770.773333 42.688 512S253.226667 42.688 512 42.688 981.290667 253.226667 981.290667 512 770.773333 981.290667 512 981.290667z","p-id":"3547"})]))]),i.isVoiceMode?(e.openBlock(),e.createElementBlock("view",{key:1,class:"voice-field",onTouchstart:a[7]||(a[7]=(...e)=>n.startVoiceRecord&&n.startVoiceRecord(...e)),onTouchend:a[8]||(a[8]=(...e)=>n.endVoiceRecord&&n.endVoiceRecord(...e))},[e.createElementVNode("text",{class:"voice-text"},"按住说话")],32)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"input-field"},[e.withDirectives(e.createElementVNode("input",{class:"message-input","onUpdate:modelValue":a[3]||(a[3]=e=>i.inputMessage=e),placeholder:"输入消息...",focus:i.inputFocus,onFocus:a[4]||(a[4]=(...e)=>n.onInputFocus&&n.onInputFocus(...e)),onBlur:a[5]||(a[5]=(...e)=>n.onInputBlur&&n.onInputBlur(...e)),onConfirm:a[6]||(a[6]=(...e)=>n.sendMessage&&n.sendMessage(...e))},null,40,["focus"]),[[e.vModelText,i.inputMessage]])])),e.createElementVNode("view",{class:"action-btns"},[e.createElementVNode("view",{class:"emoji-btn",onClick:a[9]||(a[9]=(...e)=>n.toggleEmoji&&n.toggleEmoji(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"emoji-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M512 160C317.5936 160 160 317.5936 160 512S317.5936 864 512 864 864 706.4064 864 512 706.4064 160 512 160z m0 64c159.0528 0 288 128.9472 288 288S671.0528 800 512 800 224 671.0528 224 512 352.9472 224 512 224z",fill:"#2c2c2c","p-id":"4603"}),e.createElementVNode("path",{d:"M683.3408 501.248H340.6592a25.6 25.6 0 0 0-25.6 26.112l0.1536 6.912a196.9408 196.9408 0 0 0 393.728-7.3984 25.6 25.6 0 0 0-25.6-25.6z m-27.8784 51.2l-0.3072 1.792A145.7664 145.7664 0 0 1 512 672.5888l-5.7088-0.1024a145.8176 145.8176 0 0 1-137.2928-117.4272l-0.4864-2.6112h286.9504z",fill:"#2c2c2c","p-id":"4604"}),e.createElementVNode("path",{d:"M411.1104 411.4432m-38.7584 0a38.7584 38.7584 0 1 0 77.5168 0 38.7584 38.7584 0 1 0-77.5168 0Z",fill:"#2c2c2c","p-id":"4605"}),e.createElementVNode("path",{d:"M612.8896 411.4432m-38.7584 0a38.7584 38.7584 0 1 0 77.5168 0 38.7584 38.7584 0 1 0-77.5168 0Z",fill:"#2c2c2c","p-id":"4606"})]))]),e.createElementVNode("view",{class:"plus-btn",onClick:a[10]||(a[10]=(...e)=>n.togglePlusMenu&&n.togglePlusMenu(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M511.5 957.9C264.9 957.9 65 758.2 65 511.9s199.9-446 446.5-446S958 265.6 958 511.9c0.1 246.3-199.8 446-446.5 446zM509 149.1c-200.4 0-355.8 162.2-355.8 362.3 0 200.1 155.4 356.8 355.8 356.8s362.9-156.7 362.9-356.8c0-200.1-162.5-362.3-362.9-362.3zM690.5 556h-134v133.8c0 24.6-20 44.6-44.6 44.6h-0.1c-24.6 0-44.6-19.9-44.6-44.6V556h-134c-24.7 0-44.6-19.9-44.6-44.5v-0.1c0-24.6 20-44.6 44.6-44.6h134V333c0-24.6 20-44.6 44.6-44.6h0.1c24.7 0 44.6 19.9 44.6 44.6v133.8h134c24.7 0 44.6 19.9 44.6 44.6v0.1c0 24.6-19.9 44.5-44.6 44.5z m0 0","p-id":"1640"})]))])])]),e.createElementVNode("view",{class:e.normalizeClass(["emoji-panel",{active:i.showEmojiPanel}]),onClick:a[12]||(a[12]=(...e)=>n.hideEmojiPanel&&n.hideEmojiPanel(...e))},[e.createElementVNode("view",{class:"emoji-content",onClick:a[11]||(a[11]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"emoji-grid"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(4,(t=>e.createElementVNode("view",{class:"emoji-item",key:`row1-${t}`},[e.createElementVNode("image",{class:"emoji-image",src:"",mode:"aspectFill"})]))),64)),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(4,(t=>e.createElementVNode("view",{class:"emoji-item",key:`row2-${t}`},[e.createElementVNode("image",{class:"emoji-image",src:"",mode:"aspectFill"})]))),64)),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(4,(t=>e.createElementVNode("view",{class:"emoji-item",key:`row3-${t}`},[e.createElementVNode("image",{class:"emoji-image",src:"",mode:"aspectFill"})]))),64))]),e.createElementVNode("view",{class:"emoji-pagination"},[e.createElementVNode("view",{class:"page-dot active"}),e.createElementVNode("view",{class:"page-dot"}),e.createElementVNode("view",{class:"page-dot"})])])],2),e.createElementVNode("view",{class:e.normalizeClass(["plus-panel",{active:i.showPlusPanel}]),onClick:a[18]||(a[18]=(...e)=>n.hidePlusPanel&&n.hidePlusPanel(...e))},[e.createElementVNode("view",{class:"plus-content",onClick:a[17]||(a[17]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"plus-grid"},[e.createElementVNode("view",{class:"plus-item",onClick:a[13]||(a[13]=(...e)=>n.selectImage&&n.selectImage(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zM338 304c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zm513.9 436.1H172.1c-12.9 0-24.8-5.9-32.7-16.1L73.4 659.8c-7.9-10.2-7.9-23.4 0-33.6l66-84.2c7.9-10.2 19.8-16.1 32.7-16.1h679.8c12.9 0 24.8 5.9 32.7 16.1l66 84.2c7.9 10.2 7.9 23.4 0 33.6l-66 84.2c-7.9 10.2-19.8 16.1-32.7 16.1z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"图片与视频")]),e.createElementVNode("view",{class:"plus-item",onClick:a[14]||(a[14]=(...e)=>n.openCamera&&n.openCamera(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M464 336a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"相机")]),e.createElementVNode("view",{class:"plus-item",onClick:a[15]||(a[15]=(...e)=>n.makeCall&&n.makeCall(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M512 336c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"语音/视频通话")]),e.createElementVNode("view",{class:"plus-item",onClick:a[16]||(a[16]=(...e)=>n.shareLocation&&n.shareLocation(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M512 336c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"定位")])])])],2),e.createElementVNode("view",{class:e.normalizeClass(["action-sheet",{active:i.showActionSheet}]),onClick:a[24]||(a[24]=(...e)=>n.hideActionSheet&&n.hideActionSheet(...e))},[e.createElementVNode("view",{class:"action-content",onClick:a[23]||(a[23]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"action-item",onClick:a[19]||(a[19]=(...e)=>n.goToMyAIModels&&n.goToMyAIModels(...e))},[e.createElementVNode("text",{class:"action-text"},"我购买的AI模型")]),e.createElementVNode("view",{class:"action-item",onClick:a[20]||(a[20]=(...e)=>n.goToAIDetails&&n.goToAIDetails(...e))},[e.createElementVNode("text",{class:"action-text"},"AI详情信息")]),e.createElementVNode("view",{class:"action-item",onClick:a[21]||(a[21]=(...e)=>n.goToAIStore&&n.goToAIStore(...e))},[e.createElementVNode("text",{class:"action-text"},"AI模型商城")]),e.createElementVNode("view",{class:"action-cancel",onClick:a[22]||(a[22]=(...e)=>n.hideActionSheet&&n.hideActionSheet(...e))},[e.createElementVNode("text",{class:"cancel-text"},"取消")])])],2)])}]]);const u=a({name:"AIStore",data:()=>({aiModels:[],userAiModels:[],loading:!0,errorMessage:""}),onLoad(){this.loadAiStoreData()},methods:{async loadAiStoreData(){this.loading=!0,this.errorMessage="";try{const e=uni.getStorageSync("userId");if(!e)return this.errorMessage="用户未登录",void(this.loading=!1);const[t,a]=await Promise.all([this.getAiModels(),this.getUserAiModels(e)]);t.data&&t.data.length>0?(this.aiModels=t.data,o("log","at pages/ai/ai-store.vue:181","加载的AI模型数据:",this.aiModels)):this.aiModels=[],a.data&&a.data.length>0?(this.userAiModels=a.data,o("log","at pages/ai/ai-store.vue:188","用户AI模型数据:",this.userAiModels)):this.userAiModels=[]}catch(e){o("error","at pages/ai/ai-store.vue:194","加载AI商店数据失败:",e),this.errorMessage="加载数据失败，请重试"}finally{this.loading=!1}},getAiModels:()=>new Promise(((e,t)=>{uni.request({url:"http://localhost:8888/api/a-entities/aimodel-base-info/all",method:"GET",timeout:1e4,success:t=>{e(t)},fail:e=>{t(e)}})})),getUserAiModels:e=>new Promise(((t,a)=>{uni.request({url:`http://localhost:8888/api/user-ai-model/user/${e}`,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),isPurchased(e){return!(!e||!this.userAiModels.length)&&this.userAiModels.some((t=>t.parentModelId===e.modelId||t.modelName===e.modelName))},getUserAiModel(e){return e&&this.userAiModels.length?this.userAiModels.find((t=>t.parentModelId===e.modelId||t.modelName===e.modelName)):null},getAvatarClass(e){if(!e)return"default-ai-avatar";const t=e.toLowerCase();return t.includes("宠")||t.includes("pet")?"pet-ai-avatar":t.includes("搭")||t.includes("partner")||t.includes("生活")?"lifestyle-ai-avatar":t.includes("学")||t.includes("study")?"study-ai-avatar":t.includes("游")||t.includes("game")?"gaming-ai-avatar":t.includes("运")||t.includes("sport")?"sports-ai-avatar":t.includes("音")||t.includes("music")?"music-ai-avatar":t.includes("旅")||t.includes("travel")?"travel-ai-avatar":"default-ai-avatar"},getAvatarText:e=>e?e.charAt(0).toUpperCase():"?",formatPrice(e){if(!e)return"0C";return Math.round(100*e)+"C"},formatRecommendCount:e=>e?e>=1e4?(e/1e4).toFixed(1)+"w":e.toString():"0",formatPurchaseCount:e=>e?e>=1e4?(e/1e4).toFixed(1)+"w":e.toString():"0",formatScore:e=>e?parseFloat(e).toFixed(1):"0.0",formatPurchaseTime(e){const t=this.getUserAiModel(e);if(!t||!t.createdAt)return"未知";const a=new Date(t.createdAt);return`${a.getMonth()+1}月${a.getDate()}日`},async buyAiModel(e){try{if(this.isPurchased(e))return void uni.showToast({title:"您已购买此AI模型",icon:"none"});if(!(await new Promise((t=>{uni.showModal({title:"确认购买",content:`确定要购买 ${e.modelName} 吗？\n价格：${this.formatPrice(e.price)}`,success:e=>{t(e.confirm)},fail:()=>{t(!1)}})}))))return;uni.showLoading({title:"购买中..."});const t=uni.getStorageSync("userId");if(!t)return uni.hideLoading(),void uni.showToast({title:"请先登录",icon:"none"});const a=await this.purchaseAiModel(t,e);uni.hideLoading(),a.success?(uni.showToast({title:"购买成功！",icon:"success"}),await this.loadAiStoreData()):uni.showToast({title:a.message||"购买失败",icon:"none"})}catch(t){uni.hideLoading(),o("error","at pages/ai/ai-store.vue:384","购买AI模型失败:",t),uni.showToast({title:"购买失败，请重试",icon:"none"})}},purchaseAiModel:(e,t)=>new Promise(((a,s)=>{const i={userId:parseInt(e),parentModelId:t.modelId,modelName:t.modelName,modelDesc:t.modelDesc,modelImageUrl:t.modelImageUrl||"",price:t.price};o("log","at pages/ai/ai-store.vue:404","发送购买请求:",i),uni.request({url:"http://localhost:8888/api/u-entities/user-ai-model/purchase",method:"POST",header:{"Content-Type":"application/json"},data:i,timeout:1e4,success:e=>{o("log","at pages/ai/ai-store.vue:415","购买响应:",e),a(e.data)},fail:e=>{o("error","at pages/ai/ai-store.vue:419","购买请求失败:",e),s(e)}})})),goBack(){uni.navigateBack()},openSearch(){uni.showToast({title:"搜索功能开发中",icon:"none"})},goToAIDetail(e){o("log","at pages/ai/ai-store.vue:436","跳转到AI详情页面:",e),uni.navigateTo({url:`/pages/ai/pet-ai-detail?aiName=${encodeURIComponent(e.modelName)}&modelId=${e.modelId}`,success:()=>{o("log","at pages/ai/ai-store.vue:441","跳转成功")},fail:e=>{o("error","at pages/ai/ai-store.vue:444","跳转失败:",e),uni.showToast({title:"页面跳转失败",icon:"none"})}})},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToMessages(){uni.showToast({title:"消息功能",icon:"none"})},goToFriends(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"ai-store-page"},[e.createElementVNode("view",{class:"content-area"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-section"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载AI模型...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-section"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.loadAiStoreData&&n.loadAiStoreData(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.aiModels,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.modelId,class:"ai-item",onClick:()=>n.goToAIDetail(t)},[e.createElementVNode("view",{class:"ai-avatar"},[t.modelImageUrl?(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar-image",src:t.modelImageUrl,mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["avatar-circle",n.getAvatarClass(t.modelName)])},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString(n.getAvatarText(t.modelName)),1)],2))]),e.createElementVNode("view",{class:"ai-info"},[e.createElementVNode("text",{class:"ai-name"},e.toDisplayString(t.modelName||"未知AI"),1),e.createElementVNode("text",{class:"ai-description"},e.toDisplayString(t.modelDesc||"暂无描述"),1),e.createElementVNode("view",{class:"ai-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.formatRecommendCount(t.recommendCount)),1),e.createElementVNode("text",{class:"stat-label"},"推荐")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.formatPurchaseCount(t.purchaseCount)),1),e.createElementVNode("text",{class:"stat-label"},"购买")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(n.formatScore(t.score)),1),e.createElementVNode("text",{class:"stat-label"},"评分")])]),e.createElementVNode("view",{class:"ai-price"},[e.createElementVNode("text",{class:"price-text"},e.toDisplayString(n.formatPrice(t.price)),1),e.createElementVNode("text",{class:"price-label"},"金币")]),e.createElementVNode("view",{class:"ai-interactions"},[e.createElementVNode("view",{class:"interaction-item"},[e.createElementVNode("text",{class:"interaction-icon"},"👍"),e.createElementVNode("text",{class:"interaction-count"},e.toDisplayString(t.likeCount||0),1)]),e.createElementVNode("view",{class:"interaction-item"},[e.createElementVNode("text",{class:"interaction-icon"},"💬"),e.createElementVNode("text",{class:"interaction-count"},e.toDisplayString(t.commentCount||0),1)]),e.createElementVNode("view",{class:"interaction-item"},[e.createElementVNode("text",{class:"interaction-icon"},"⭐"),e.createElementVNode("text",{class:"interaction-count"},e.toDisplayString(t.collectCount||0),1)])]),n.isPurchased(t)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"purchase-info"},[e.createElementVNode("text",{class:"purchase-time"},"购买时间: "+e.toDisplayString(n.formatPurchaseTime(t)),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"ai-status",onClick:a[1]||(a[1]=e.withModifiers((()=>{}),["stop"]))},[n.isPurchased(t)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"purchased-badge"},[e.createElementVNode("text",{class:"badge-text"},"已购买")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"buy-btn",onClick:e=>n.buyAiModel(t)},[e.createElementVNode("text",{class:"buy-text"},"购买")],8,["onClick"]))])],8,["onClick"])))),128)),0===i.aiModels.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-section"},[e.createElementVNode("view",{class:"empty-icon"},"🤖"),e.createElementVNode("text",{class:"empty-text"},"暂无AI模型"),e.createElementVNode("text",{class:"empty-desc"},"敬请期待更多AI模型上线！")])):e.createCommentVNode("",!0)]))]),e.createElementVNode("view",{class:"bottom-nav"},[e.createElementVNode("view",{class:"nav-item",onClick:a[2]||(a[2]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item",onClick:a[3]||(a[3]=(...e)=>n.goToMessages&&n.goToMessages(...e))},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item active"},[e.createElementVNode("view",{class:"ai-icon"},"AI")]),e.createElementVNode("view",{class:"nav-item",onClick:a[4]||(a[4]=(...e)=>n.goToFriends&&n.goToFriends(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-item",onClick:a[5]||(a[5]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("view",{class:"nav-avatar"},[e.createElementVNode("view",{class:"mini-cat-avatar"},[e.createElementVNode("view",{class:"mini-cat-body"}),e.createElementVNode("view",{class:"mini-cat-face"},[e.createElementVNode("view",{class:"mini-cat-eyes"},[e.createElementVNode("view",{class:"mini-cat-eye"}),e.createElementVNode("view",{class:"mini-cat-eye"})])])])])])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const h=a({name:"TasksPage",data:()=>({currentFilter:"all",showRating:!1,currentTask:null,rating:0,comment:"",tasks:[],loading:!1,errorMessage:"",userId:null,commentedTasks:new Set}),onLoad(){this.userId=uni.getStorageSync("userId")||1,o("log","at pages/ai/tasks.vue:201","tasks页面加载，用户ID:",this.userId),this.loadTasks()},computed:{totalTasks(){return this.tasks.length},activeTasks(){return this.tasks.filter((e=>"active"===e.status)).length},completedTasks(){return this.tasks.filter((e=>"completed"===e.status)).length},filteredTasks(){return"all"===this.currentFilter?this.tasks:"active"===this.currentFilter?this.tasks.filter((e=>"active"===e.status)):"completed"===this.currentFilter?this.tasks.filter((e=>"completed"===e.status)):this.tasks},ratingText(){return["","很差","较差","一般","较好","很好"][this.rating]||""}},methods:{async loadTasks(){this.loading=!0,this.errorMessage="";try{o("log","at pages/ai/tasks.vue:238","开始加载用户任务数据，用户ID:",this.userId);const e=await uni.request({url:"http://localhost:8888/api/u-entities/user-task-relationship/all",method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/ai/tasks.vue:248","任务数据响应:",e),200!==e.statusCode||!e.data)throw new Error("加载任务数据失败");{const t=e.data.filter((e=>e.userId===this.userId));o("log","at pages/ai/tasks.vue:253","用户任务数据:",t),this.tasks=this.convertTasksToDisplayFormat(t),o("log","at pages/ai/tasks.vue:257","转换后的任务数据:",this.tasks),await this.checkUserComments()}}catch(e){o("error","at pages/ai/tasks.vue:265","加载任务数据异常:",e),this.errorMessage="加载任务数据失败，请重试",uni.showToast({title:"加载任务失败",icon:"error"})}finally{this.loading=!1}},convertTasksToDisplayFormat(e){return e.map((e=>{let t="pending";1===e.status?t="active":2===e.status?t="completed":3===e.status&&(t="terminated");const a=this.formatTime(e.createdAt),s=e.endedAt?this.formatTime(e.endedAt):null;return{id:e.userTaskId,title:`任务 ${e.userTaskId}`,description:`用户任务关系ID: ${e.userTaskId}，状态: ${this.getStatusText(t)}，进度: ${e.taskPercent||0}%`,status:t,progress:e.taskPercent||0,createTime:a,completedTime:s}}))},formatTime(e){if(!e)return"";return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},getStatusText:e=>({pending:"待开始",active:"进行中",completed:"已完成",terminated:"已终止"}[e]||"未知"),async checkUserComments(){try{const e=await uni.request({url:`http://localhost:8888/api/efmprt-entities/task-comment/check?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});200===e.statusCode&&e.data.exists&&(this.tasks.forEach((e=>{"completed"===e.status&&this.commentedTasks.add(e.id)})),o("log","at pages/ai/tasks.vue:347","用户已评价，标记所有已完成任务为已评价"))}catch(e){o("error","at pages/ai/tasks.vue:350","检查用户评价状态失败:",e)}},async checkTaskCommented(e){try{const e=await uni.request({url:`http://localhost:8888/api/efmprt-entities/task-comment/check?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});return 200===e.statusCode&&e.data.exists||!1}catch(t){return o("error","at pages/ai/tasks.vue:370","检查任务评价状态失败:",t),!1}},goBack(){uni.navigateBack()},setFilter(e){this.currentFilter=e},showTaskDetail(e){uni.navigateTo({url:`/pages/ai/task-detail?taskId=${e.id}`})},updateTaskStatus(e,t){const a=this.tasks.findIndex((t=>t.id===e));-1!==a&&(this.tasks[a].status=t,"terminated"===t&&(this.tasks[a].progress=0))},async showRatingModal(e){await this.checkTaskCommented(e.id)?uni.showToast({title:"您已经评价过此任务",icon:"none",duration:2e3}):(this.currentTask=e,this.rating=0,this.comment="",this.showRating=!0)},hideRatingModal(){this.showRating=!1,this.currentTask=null},setRating(e){this.rating=e},async submitRating(){if(0!==this.rating)try{o("log","at pages/ai/tasks.vue:432","提交评分:",{taskId:this.currentTask.id,userId:this.userId,rating:this.rating,comment:this.comment}),uni.showLoading({title:"提交中..."});const e=await uni.request({url:"http://localhost:8888/api/efmprt-entities/task-comment/save",method:"POST",header:{"Content-Type":"application/json"},data:{userId:this.userId,taskId:this.currentTask.id,stars:this.rating,commentText:this.comment||""}});if(o("log","at pages/ai/tasks.vue:458","评分提交响应:",e),200!==e.statusCode||!e.data.success)throw new Error(e.data.message||"提交失败");uni.showToast({title:"评分提交成功",icon:"success"}),this.commentedTasks.add(this.currentTask.id),this.rating=0,this.comment="",this.hideRatingModal()}catch(e){o("error","at pages/ai/tasks.vue:479","提交评分失败:",e),uni.showToast({title:"提交失败，请重试",icon:"error"})}finally{uni.hideLoading()}else uni.showToast({title:"请选择评分",icon:"none"})}}},[["render",function(t,a,s,o,i,n){var l,c;return e.openBlock(),e.createElementBlock("view",{class:"tasks-page"},[e.createElementVNode("view",{class:"stats-section"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.totalTasks),1),e.createElementVNode("text",{class:"stat-label"},"总任务")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.activeTasks),1),e.createElementVNode("text",{class:"stat-label"},"进行中")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(n.completedTasks),1),e.createElementVNode("text",{class:"stat-label"},"已完成")])]),e.createElementVNode("view",{class:"tasks-list"},[e.createElementVNode("view",{class:"list-header"},[e.createElementVNode("text",{class:"header-title"},"任务列表"),e.createElementVNode("view",{class:"filter-tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:"all"===i.currentFilter}]),onClick:a[0]||(a[0]=e=>n.setFilter("all"))},[e.createElementVNode("text",null,"全部")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:"active"===i.currentFilter}]),onClick:a[1]||(a[1]=e=>n.setFilter("active"))},[e.createElementVNode("text",null,"进行中")],2),e.createElementVNode("view",{class:e.normalizeClass(["filter-tab",{active:"completed"===i.currentFilter}]),onClick:a[2]||(a[2]=e=>n.setFilter("completed"))},[e.createElementVNode("text",null,"已完成")],2)])]),i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载任务中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("button",{class:"retry-button",onClick:a[3]||(a[3]=(...e)=>n.loadTasks&&n.loadTasks(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"task-items"},[0===n.filteredTasks.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-container"},[e.createElementVNode("text",{class:"empty-text"},"暂无任务数据")])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(n.filteredTasks,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["task-item",{completed:"completed"===t.status}]),key:t.id},[e.createElementVNode("view",{class:"task-header"},[e.createElementVNode("view",{class:"task-title-row"},[e.createElementVNode("view",{class:e.normalizeClass(["task-status",t.status])},["completed"===t.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"status-icon"},"✓")):"active"===t.status?(e.openBlock(),e.createElementBlock("view",{key:1,class:"status-icon"},"●")):(e.openBlock(),e.createElementBlock("view",{key:2,class:"status-icon"},"○"))],2),e.createElementVNode("text",{class:"task-title"},e.toDisplayString(t.title),1),"completed"===t.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"completed-badge"},"已完成")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"task-time"},e.toDisplayString(t.createTime),1)]),e.createElementVNode("text",{class:"task-description"},e.toDisplayString(t.description),1),"active"===t.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-progress"},[e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:t.progress+"%"})},null,4)]),e.createElementVNode("text",{class:"progress-text"},e.toDisplayString(t.progress)+"%",1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"task-actions"},["completed"===t.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["action-btn",i.commentedTasks.has(t.id)?"rated-btn":"rate-btn"]),onClick:e=>i.commentedTasks.has(t.id)?null:n.showRatingModal(t)},[e.createElementVNode("text",null,e.toDisplayString(i.commentedTasks.has(t.id)?"已评价":"评分评价"),1)],10,["onClick"])):"terminated"===t.status?(e.openBlock(),e.createElementBlock("view",{key:1,class:"action-btn terminated-btn",onClick:e=>n.showTaskDetail(t)},[e.createElementVNode("text",null,"任务中止")],8,["onClick"])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"action-btn detail-btn",onClick:e=>n.showTaskDetail(t)},[e.createElementVNode("text",null,"查看详情")],8,["onClick"]))])],2)))),128))]))]),e.createElementVNode("view",{class:e.normalizeClass(["rating-modal",{active:i.showRating}]),onClick:a[9]||(a[9]=(...e)=>n.hideRatingModal&&n.hideRatingModal(...e))},[e.createElementVNode("view",{class:"rating-content",onClick:a[8]||(a[8]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"rating-header"},[e.createElementVNode("text",{class:"rating-title"},"任务评价"),e.createElementVNode("view",{class:"close-btn",onClick:a[4]||(a[4]=(...e)=>n.hideRatingModal&&n.hideRatingModal(...e))},"×")]),e.createElementVNode("view",{class:"task-info"},[e.createElementVNode("text",{class:"task-name"},e.toDisplayString(null==(l=i.currentTask)?void 0:l.title),1),e.createElementVNode("text",{class:"task-desc"},e.toDisplayString(null==(c=i.currentTask)?void 0:c.description),1)]),e.createElementVNode("view",{class:"rating-section"},[e.createElementVNode("text",{class:"rating-label"},"请为AI的表现评分："),e.createElementVNode("view",{class:"star-rating"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(5,(t=>e.createElementVNode("view",{class:e.normalizeClass(["star",{active:t<=i.rating}]),key:t,onClick:e=>n.setRating(t)},[e.createElementVNode("text",null,"★")],10,["onClick"]))),64))]),e.createElementVNode("text",{class:"rating-text"},e.toDisplayString(n.ratingText),1)]),e.createElementVNode("view",{class:"comment-section"},[e.createElementVNode("text",{class:"comment-label"},"评价内容："),e.withDirectives(e.createElementVNode("textarea",{class:"comment-input","onUpdate:modelValue":a[5]||(a[5]=e=>i.comment=e),placeholder:"请输入您的评价...",maxlength:"200"},null,512),[[e.vModelText,i.comment]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(i.comment.length)+"/200",1)]),e.createElementVNode("view",{class:"rating-actions"},[e.createElementVNode("view",{class:"cancel-btn",onClick:a[6]||(a[6]=(...e)=>n.hideRatingModal&&n.hideRatingModal(...e))},[e.createElementVNode("text",null,"取消")]),e.createElementVNode("view",{class:"submit-btn",onClick:a[7]||(a[7]=(...e)=>n.submitRating&&n.submitRating(...e))},[e.createElementVNode("text",null,"提交评价")])])])],2)])}]]);const p=a({name:"TaskDetailPage",data:()=>({taskId:null,showRating:!1,showTerminate:!1,rating:0,comment:"",taskData:{}}),computed:{ratingText(){return["","很差","较差","一般","较好","很好"][this.rating]||""}},onLoad(e){e.taskId?(this.taskId=parseInt(e.taskId),this.loadTaskDetail()):(this.taskId=1,this.loadTaskDetail())},methods:{goBack(){uni.navigateBack()},async loadTaskDetail(){this.loading=!0,this.errorMessage="";try{o("log","at pages/ai/task-detail.vue:241","开始加载任务详情，任务ID:",this.taskId);const e=await uni.request({url:`http://localhost:8888/api/a-entities/ai-task-log/by-user-task/${this.taskId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/ai/task-detail.vue:251","任务详情响应:",e),200===e.statusCode&&e.data)this.taskData=this.convertTaskData(e.data),o("log","at pages/ai/task-detail.vue:256","转换后的任务数据:",this.taskData);else{if(404!==e.statusCode)throw new Error("加载任务详情失败");this.errorMessage="任务不存在",o("log","at pages/ai/task-detail.vue:259","任务不存在，任务ID:",this.taskId)}}catch(e){o("error","at pages/ai/task-detail.vue:264","加载任务详情异常:",e),this.errorMessage="加载任务详情失败，请重试",uni.showToast({title:"加载失败",icon:"error"})}finally{this.loading=!1}},convertTaskData(e){let t=e,a=0;e.aiTaskLog&&(t=e.aiTaskLog,a=e.taskPercent||0,e.userTaskStatus);let s="pending";0===t.status?s="pending":1===t.status?s="active":2===t.status?s="completed":3===t.status&&(s="error");const o=e=>{if(!e)return"";return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})};let i=a;"completed"===s?i=100:"pending"===s&&(i=0);const n=this.generateProcessSteps(t.aiTaskDesc,s),l=this.generateAnalysisResult(t.taskComment,t.taskStar),c=this.generateSuggestions(s,t.taskComment);return{id:t.aiTaskLogId,title:t.aiTaskName||"未命名任务",description:t.aiTaskDesc||"暂无描述",status:s,progress:i,createTime:o(t.createdAt),completedTime:"completed"===s?o(t.updatedAt):null,processSteps:n,analysisResult:l,suggestions:c}},generateProcessSteps(e,t){if(!e)return[];return[{title:"任务分析",description:"分析任务需求和目标",completed:!0,completedTime:"09:00"},{title:"方案制定",description:"制定执行方案和策略",completed:"completed"===t||"active"===t,active:"active"===t,completedTime:"completed"===t?"10:30":null},{title:"任务执行",description:"执行具体任务内容",completed:"completed"===t,active:"active"===t,completedTime:"completed"===t?"14:20":null},{title:"结果评估",description:"评估任务执行结果",completed:"completed"===t,completedTime:"completed"===t?"16:45":null}]},generateAnalysisResult(e,t){if(!e&&!t)return[];const a=[];if(t){let e="B";t>=4?e="A":t>=3?e="B+":t<=2&&(e="C"),a.push({title:"任务完成质量",score:e,description:this.getScoreDescription(e),details:this.getScoreDetails(e)})}return e&&a.push({title:"用户反馈",score:"A",description:e,details:["用户评价内容"]}),a},generateSuggestions(e,t){const a=[];return"completed"===e?a.push({icon:"✅",title:"任务完成",description:"任务已成功完成，感谢您的使用"}):"active"===e?a.push({icon:"⏳",title:"继续执行",description:"任务正在执行中，请耐心等待"}):a.push({icon:"🚀",title:"开始任务",description:"建议尽快开始执行任务"}),t&&a.push({icon:"💬",title:"用户反馈",description:"已收到您的反馈，我们会持续改进"}),a},getScoreDescription:e=>({A:"任务完成质量优秀，超出预期","B+":"任务完成质量良好，符合预期",B:"任务完成质量一般，基本符合预期",C:"任务完成质量有待提升"}[e]||"任务完成质量待评估"),getScoreDetails:e=>({A:["执行效率高","结果质量优秀","用户体验良好"],"B+":["执行效率良好","结果质量较好","用户体验满意"],B:["执行效率一般","结果质量基本合格","用户体验一般"],C:["执行效率较低","结果质量需要改进","用户体验有待提升"]}[e]||["待评估"]),getTaskDetails:()=>({1:{id:1,title:"帮助用户制定学习计划",description:"根据用户的学习目标和时间安排，制定详细的学习计划，包括每日任务、复习安排等。",status:"completed",progress:100,createTime:"2024-01-15 09:30",completedTime:"2024-01-15 16:45",processSteps:[{title:"分析用户需求",description:"了解用户的学习目标、当前水平、可用时间等基本信息",completed:!0,completedTime:"09:35"},{title:"制定学习框架",description:"基于用户需求设计整体学习框架和阶段性目标",completed:!0,completedTime:"10:15"},{title:"细化每日任务",description:"将学习目标分解为具体的每日学习任务和复习安排",completed:!0,completedTime:"14:20"},{title:"优化学习计划",description:"根据用户反馈调整学习计划，确保可行性和有效性",completed:!0,completedTime:"16:45"}],analysisResult:[{title:"学习目标分析",score:"A+",description:"用户目标明确，时间安排合理，学习动机强烈",details:["目标具体可量化","时间分配科学合理","学习资源充足"]},{title:"学习计划质量",score:"A",description:"制定的学习计划结构清晰，循序渐进",details:["计划层次分明","任务难度适中","复习安排科学"]}],suggestions:[{icon:"📚",title:"坚持执行",description:"建议严格按照计划执行，定期评估学习效果"},{icon:"📊",title:"定期调整",description:"根据学习进度和效果，适时调整学习计划"},{icon:"🎯",title:"目标导向",description:"保持目标导向，及时调整学习策略"}]},2:{id:2,title:"分析用户情感状态",description:"通过对话分析用户的情绪变化，提供相应的情感支持和建议。",status:"active",progress:65,createTime:"2024-01-16 14:20",processSteps:[{title:"情感数据收集",description:"收集用户对话中的情感表达和情绪指标",completed:!0,completedTime:"14:25"},{title:"情绪模式分析",description:"分析用户的情感变化模式和触发因素",completed:!0,completedTime:"15:10"},{title:"情感支持策略",description:"制定个性化的情感支持和干预策略",completed:!1,active:!0},{title:"效果评估",description:"评估情感支持的效果并持续优化",completed:!1}],analysisResult:[{title:"情绪稳定性",score:"B+",description:"用户情绪波动较大，需要重点关注",details:["情绪变化频率较高","压力反应明显","需要情感支持"]}],suggestions:[{icon:"💝",title:"情感关怀",description:"提供更多情感支持和关怀，帮助稳定情绪"},{icon:"🧘",title:"放松技巧",description:"学习一些放松和情绪调节技巧"}]},3:{id:3,title:"推荐适合的社交活动",description:"基于用户的兴趣爱好和社交偏好，推荐合适的社交活动和交友建议。",status:"active",progress:30,createTime:"2024-01-17 10:15",processSteps:[{title:"兴趣分析",description:"分析用户的兴趣爱好和社交偏好",completed:!0,completedTime:"10:20"},{title:"活动匹配",description:"根据用户兴趣匹配合适的社交活动",completed:!1,active:!0},{title:"推荐优化",description:"优化推荐算法，提高推荐准确性",completed:!1},{title:"效果跟踪",description:"跟踪推荐效果，持续改进",completed:!1}],analysisResult:[{title:"兴趣匹配度",score:"A-",description:"用户兴趣明确，匹配度较高",details:["兴趣爱好多样化","社交需求明确","参与意愿强烈"]}],suggestions:[{icon:"🎉",title:"积极参与",description:"建议积极参与推荐的社交活动"},{icon:"👥",title:"扩大社交圈",description:"通过活动认识更多志同道合的朋友"}]},4:{id:4,title:"协助用户解决问题",description:"帮助用户分析当前遇到的问题，提供解决方案和行动建议。",status:"completed",progress:100,createTime:"2024-01-14 16:00",completedTime:"2024-01-15 11:30",processSteps:[{title:"问题识别",description:"准确识别用户遇到的核心问题",completed:!0,completedTime:"16:05"},{title:"原因分析",description:"深入分析问题的根本原因",completed:!0,completedTime:"16:30"},{title:"方案制定",description:"制定多种解决方案供用户选择",completed:!0,completedTime:"09:15"},{title:"实施指导",description:"提供详细的实施指导和后续支持",completed:!0,completedTime:"11:30"}],analysisResult:[{title:"问题解决能力",score:"A+",description:"问题分析透彻，解决方案有效",details:["问题识别准确","分析深入全面","方案切实可行"]}],suggestions:[{icon:"✅",title:"执行方案",description:"按照制定的方案逐步执行"},{icon:"📞",title:"寻求支持",description:"如遇困难及时寻求帮助和支持"}]},5:{id:5,title:"制定健身计划",description:"根据用户的身体状况和健身目标，制定个性化的健身计划和饮食建议。",status:"pending",progress:0,createTime:"2024-01-18 08:45",processSteps:[{title:"身体状况评估",description:"评估用户当前的身体状况和健康水平",completed:!1},{title:"目标设定",description:"与用户一起设定合理的健身目标",completed:!1},{title:"计划制定",description:"制定个性化的健身计划和饮食建议",completed:!1},{title:"跟踪调整",description:"跟踪执行情况并适时调整计划",completed:!1}],analysisResult:[],suggestions:[{icon:"🏃",title:"开始行动",description:"建议尽快开始制定和执行健身计划"},{icon:"💪",title:"坚持锻炼",description:"制定计划后要坚持执行，才能看到效果"}]}}),getProcessStatusText(){switch(this.taskData.status){case"completed":return"已完成";case"active":return"进行中";case"pending":return"待开始";default:return"未知状态"}},getScoreClass:e=>e.includes("A+")?"score-excellent":e.includes("A")?"score-good":e.includes("B")?"score-average":"score-poor",showRatingModal(){this.rating=0,this.comment="",this.showRating=!0},hideRatingModal(){this.showRating=!1},setRating(e){this.rating=e},submitRating(){0!==this.rating?(uni.showToast({title:"评价提交成功！",icon:"success"}),this.hideRatingModal()):uni.showToast({title:"请选择评分",icon:"none"})},showTerminateModal(){this.showTerminate=!0},hideTerminateModal(){this.showTerminate=!1},confirmTerminate(){this.taskData.status="terminated",this.taskData.progress=0,this.hideTerminateModal(),uni.showToast({title:"任务已终止",icon:"success"});const e=getCurrentPages(),t=e[e.length-2];t&&t.updateTaskStatus&&t.updateTaskStatus(this.taskId,"terminated"),setTimeout((()=>{uni.navigateBack()}),1500)},async startTask(){try{o("log","at pages/ai/task-detail.vue:849","开始任务，任务ID:",this.taskId),uni.showLoading({title:"正在开始任务..."});const e=await uni.request({url:`http://localhost:8888/api/a-entities/ai-task-log/start-task/${this.taskId}`,method:"POST",header:{"Content-Type":"application/json"}});if(o("log","at pages/ai/task-detail.vue:863","开始任务响应:",e),200===e.statusCode&&e.data.success){this.taskData.status="active",this.taskData.progress=10,this.taskData.processSteps=this.generateProcessSteps(this.taskData.description,"active"),this.taskData.suggestions=this.generateSuggestions("active",this.taskData.comment),uni.hideLoading(),uni.showToast({title:"任务已开始",icon:"success"});const e=getCurrentPages(),t=e[e.length-2];t&&t.updateTaskStatus&&t.updateTaskStatus(this.taskId,"active")}else uni.hideLoading(),uni.showToast({title:e.data.message||"开始任务失败",icon:"error"})}catch(e){o("error","at pages/ai/task-detail.vue:896","开始任务异常:",e),uni.hideLoading(),uni.showToast({title:"开始任务失败，请重试",icon:"error"})}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"task-detail-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666"})]))]),e.createElementVNode("view",{class:"header-title"},[e.createElementVNode("text",{class:"title-text"},"任务详情")]),e.createElementVNode("view",{class:"placeholder"})]),i.taskData&&i.taskData.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-info-card"},[e.createElementVNode("view",{class:"task-header"},[e.createElementVNode("view",{class:"task-title-row"},[e.createElementVNode("view",{class:e.normalizeClass(["task-status",i.taskData.status])},["completed"===i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"status-icon"},"✓")):"active"===i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:1,class:"status-icon"},"●")):(e.openBlock(),e.createElementBlock("view",{key:2,class:"status-icon"},"○"))],2),e.createElementVNode("text",{class:"task-title"},e.toDisplayString(i.taskData.title),1),"completed"===i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"completed-badge"},"已完成")):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"task-time"},e.toDisplayString(i.taskData.createTime),1)]),e.createElementVNode("text",{class:"task-description"},e.toDisplayString(i.taskData.description),1),"active"===i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-progress"},[e.createElementVNode("view",{class:"progress-info"},[e.createElementVNode("text",{class:"progress-label"},"完成进度"),e.createElementVNode("text",{class:"progress-text"},e.toDisplayString(i.taskData.progress)+"%",1)]),e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:i.taskData.progress+"%"})},null,4)])])):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-card"},[e.createElementVNode("text",{class:"loading-text"},"加载中...")])),i.taskData&&i.taskData.processSteps?(e.openBlock(),e.createElementBlock("view",{key:2,class:"execution-process"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"AI执行过程"),e.createElementVNode("view",{class:e.normalizeClass(["process-status",i.taskData.status])},[e.createElementVNode("text",null,e.toDisplayString(n.getProcessStatusText()),1)],2)]),e.createElementVNode("view",{class:"process-steps"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.taskData.processSteps,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["process-step",{completed:t.completed,active:t.active}]),key:a},[e.createElementVNode("view",{class:"step-indicator"},[t.completed?(e.openBlock(),e.createElementBlock("view",{key:0,class:"step-icon completed"},"✓")):t.active?(e.openBlock(),e.createElementBlock("view",{key:1,class:"step-icon active"},"●")):(e.openBlock(),e.createElementBlock("view",{key:2,class:"step-icon"},"○"))]),e.createElementVNode("view",{class:"step-content"},[e.createElementVNode("text",{class:"step-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"step-description"},e.toDisplayString(t.description),1),t.completed?(e.openBlock(),e.createElementBlock("text",{key:0,class:"step-time"},e.toDisplayString(t.completedTime),1)):e.createCommentVNode("",!0)])],2)))),128))])])):e.createCommentVNode("",!0),i.taskData&&i.taskData.analysisResult&&i.taskData.analysisResult.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"analysis-result"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"AI分析结果")]),e.createElementVNode("view",{class:"result-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.taskData.analysisResult,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"result-item",key:a},[e.createElementVNode("view",{class:"result-header"},[e.createElementVNode("text",{class:"result-title"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:e.normalizeClass(["result-score",n.getScoreClass(t.score)])},[e.createElementVNode("text",null,e.toDisplayString(t.score),1)],2)]),e.createElementVNode("text",{class:"result-description"},e.toDisplayString(t.description),1),t.details?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-details"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.details,((t,a)=>(e.openBlock(),e.createElementBlock("text",{class:"detail-item",key:a},"• "+e.toDisplayString(t),1)))),128))])):e.createCommentVNode("",!0)])))),128))])])):e.createCommentVNode("",!0),i.taskData&&i.taskData.suggestions&&i.taskData.suggestions.length>0?(e.openBlock(),e.createElementBlock("view",{key:4,class:"suggestions"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"建议和下一步")]),e.createElementVNode("view",{class:"suggestion-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.taskData.suggestions,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"suggestion-item",key:a},[e.createElementVNode("view",{class:"suggestion-icon"},e.toDisplayString(t.icon),1),e.createElementVNode("view",{class:"suggestion-text"},[e.createElementVNode("text",{class:"suggestion-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"suggestion-desc"},e.toDisplayString(t.description),1)])])))),128))])])):e.createCommentVNode("",!0),i.taskData&&i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:5,class:"action-buttons"},["pending"===i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-btn start-btn",onClick:a[1]||(a[1]=(...e)=>n.startTask&&n.startTask(...e))},[e.createElementVNode("text",null,"开始任务")])):"completed"===i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:1,class:"action-btn rate-btn",onClick:a[2]||(a[2]=(...e)=>n.showRatingModal&&n.showRatingModal(...e))},[e.createElementVNode("text",null,"评价任务")])):"active"===i.taskData.status?(e.openBlock(),e.createElementBlock("view",{key:2,class:"action-btn terminate-btn",onClick:a[3]||(a[3]=(...e)=>n.showTerminateModal&&n.showTerminateModal(...e))},[e.createElementVNode("text",null,"终止任务")])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["rating-modal",{active:i.showRating}]),onClick:a[9]||(a[9]=(...e)=>n.hideRatingModal&&n.hideRatingModal(...e))},[e.createElementVNode("view",{class:"rating-content",onClick:a[8]||(a[8]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"rating-header"},[e.createElementVNode("text",{class:"rating-title"},"任务评价"),e.createElementVNode("view",{class:"close-btn",onClick:a[4]||(a[4]=(...e)=>n.hideRatingModal&&n.hideRatingModal(...e))},"×")]),e.createElementVNode("view",{class:"rating-section"},[e.createElementVNode("text",{class:"rating-label"},"请为AI的表现评分："),e.createElementVNode("view",{class:"star-rating"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(5,(t=>e.createElementVNode("view",{class:e.normalizeClass(["star",{active:t<=i.rating}]),key:t,onClick:e=>n.setRating(t)},[e.createElementVNode("text",null,"★")],10,["onClick"]))),64))]),e.createElementVNode("text",{class:"rating-text"},e.toDisplayString(n.ratingText),1)]),e.createElementVNode("view",{class:"comment-section"},[e.createElementVNode("text",{class:"comment-label"},"评价内容："),e.withDirectives(e.createElementVNode("textarea",{class:"comment-input","onUpdate:modelValue":a[5]||(a[5]=e=>i.comment=e),placeholder:"请输入您的评价...",maxlength:"200"},null,512),[[e.vModelText,i.comment]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(i.comment.length)+"/200",1)]),e.createElementVNode("view",{class:"rating-actions"},[e.createElementVNode("view",{class:"cancel-btn",onClick:a[6]||(a[6]=(...e)=>n.hideRatingModal&&n.hideRatingModal(...e))},[e.createElementVNode("text",null,"取消")]),e.createElementVNode("view",{class:"submit-btn",onClick:a[7]||(a[7]=(...e)=>n.submitRating&&n.submitRating(...e))},[e.createElementVNode("text",null,"提交评价")])])])],2),e.createElementVNode("view",{class:e.normalizeClass(["terminate-modal",{active:i.showTerminate}]),onClick:a[14]||(a[14]=(...e)=>n.hideTerminateModal&&n.hideTerminateModal(...e))},[e.createElementVNode("view",{class:"terminate-content",onClick:a[13]||(a[13]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"terminate-header"},[e.createElementVNode("text",{class:"terminate-title"},"终止任务确认"),e.createElementVNode("view",{class:"close-btn",onClick:a[10]||(a[10]=(...e)=>n.hideTerminateModal&&n.hideTerminateModal(...e))},"×")]),e.createElementVNode("view",{class:"terminate-body"},[e.createElementVNode("text",{class:"terminate-message"},"确定要终止当前任务吗？"),e.createElementVNode("text",{class:"terminate-warning"},"终止后任务将无法恢复，请谨慎操作。")]),e.createElementVNode("view",{class:"terminate-actions"},[e.createElementVNode("view",{class:"cancel-btn",onClick:a[11]||(a[11]=(...e)=>n.hideTerminateModal&&n.hideTerminateModal(...e))},[e.createElementVNode("text",null,"取消")]),e.createElementVNode("view",{class:"confirm-btn",onClick:a[12]||(a[12]=(...e)=>n.confirmTerminate&&n.confirmTerminate(...e))},[e.createElementVNode("text",null,"确认终止")])])])],2)])}]]);const v=a({name:"ChatPage",data:()=>({friendName:"",friendId:null,sessionId:null,userId:null,showActionSheet:!1,scrollTop:0,inputMessage:"",inputFocus:!1,isVoiceMode:!1,showEmojiPanel:!1,showPlusPanel:!1,messages:[],loading:!1,errorMessage:""}),onLoad(e){e.friendName&&(this.friendName=decodeURIComponent(e.friendName)),e.friendId&&(this.friendId=parseInt(e.friendId)),e.sessionId&&(this.sessionId=parseInt(e.sessionId)),this.userId=uni.getStorageSync("userId")||1,o("log","at pages/chat/chat.vue:250","聊天页面参数:",{friendName:this.friendName,friendId:this.friendId,sessionId:this.sessionId,userId:this.userId}),this.loadChatMessages()},methods:{async loadChatMessages(){if(this.sessionId){this.loading=!0,this.errorMessage="";try{o("log","at pages/chat/chat.vue:272","开始加载聊天记录，sessionId:",this.sessionId);const e=await uni.request({url:`http://localhost:8888/api/user-chat-detail/session/${this.sessionId}`,method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/chat/chat.vue:281","API响应状态码:",e.statusCode),o("log","at pages/chat/chat.vue:282","API响应数据:",e.data),200===e.statusCode&&e.data?(o("log","at pages/chat/chat.vue:285","原始聊天记录数据:",e.data),this.messages=this.convertChatDataToMessages(e.data),o("log","at pages/chat/chat.vue:287","转换后的聊天记录:",this.messages),this.$nextTick((()=>{this.scrollToBottom()}))):(this.errorMessage=`加载聊天记录失败，状态码: ${e.statusCode}`,o("error","at pages/chat/chat.vue:295","加载聊天记录失败:",e))}catch(e){this.errorMessage="网络错误，请检查连接",o("error","at pages/chat/chat.vue:299","加载聊天记录异常:",e)}finally{this.loading=!1}}else this.errorMessage="会话ID不存在"},convertChatDataToMessages(e){if(o("log","at pages/chat/chat.vue:307","开始转换聊天数据:",e),o("log","at pages/chat/chat.vue:308","当前用户ID:",this.userId),!Array.isArray(e))return o("log","at pages/chat/chat.vue:311","聊天数据不是数组:",e),[];const t=e.sort(((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime())).map(((e,t)=>{const a=e.demandParty&&e.demandParty.toString()===this.userId.toString();return o("log","at pages/chat/chat.vue:328",`消息${t}:`,{id:e.id,demandParty:e.demandParty,message:e.message,isUserMessage:a,userId:this.userId}),{id:e.id,type:a?"right":"left",text:e.message||"",time:this.formatTime(e.createdAt),demandParty:e.demandParty,createdAt:e.createdAt}}));return o("log","at pages/chat/chat.vue:346","转换结果:",t),t},formatTime(e){if(!e)return"";const t=new Date(e),a=t.getHours();return`${a<12?"上午":"下午"}${a<12?a:a-12}:${t.getMinutes().toString().padStart(2,"0")}`},goBack(){try{uni.navigateBack({fail:()=>{uni.navigateTo({url:"/pages/chat/chat-list"})}})}catch(e){uni.navigateTo({url:"/pages/chat/chat-list"})}},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})},goToAI(){uni.navigateTo({url:"/pages/ai/ai"})},showMoreOptions(){uni.navigateTo({url:`/pages/chat/chat-info?friendName=${encodeURIComponent(this.friendName)}`})},hideActionSheet(){this.showActionSheet=!1},clearChat(){this.hideActionSheet(),uni.showModal({title:"确认清空",content:"确定要清空所有聊天记录吗？",success:e=>{e.confirm&&(this.clearAllMessages(),uni.showToast({title:"聊天记录已清空",icon:"success"}))}})},reportChat(){this.hideActionSheet(),uni.navigateTo({url:"/pages/report/report"})},clearAllMessages(){this.messages=[],this.scrollTop=0},blockUser(){this.hideActionSheet(),uni.showModal({title:"确认拉黑",content:`确定要拉黑 ${this.friendName||"该用户"} 吗？`,success:e=>{e.confirm&&(uni.showToast({title:"用户已拉黑",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500))}})},toggleVoiceInput(){this.isVoiceMode=!this.isVoiceMode,this.isVoiceMode&&(this.showEmojiPanel=!1,this.showPlusPanel=!1)},toggleEmoji(){this.showEmojiPanel=!this.showEmojiPanel,this.showPlusPanel=!1},togglePlusMenu(){this.showPlusPanel=!this.showPlusPanel,this.showEmojiPanel=!1},hideEmojiPanel(){this.showEmojiPanel=!1},hidePlusPanel(){this.showPlusPanel=!1},startVoiceRecord(){uni.showToast({title:"开始录音",icon:"none"})},endVoiceRecord(){uni.showToast({title:"录音完成",icon:"none"})},selectImage(){this.hidePlusPanel(),uni.showToast({title:"图片选择功能开发中",icon:"none"})},openCamera(){this.hidePlusPanel(),uni.showToast({title:"相机功能开发中",icon:"none"})},makeCall(){this.hidePlusPanel(),uni.showToast({title:"通话功能开发中",icon:"none"})},shareLocation(){this.hidePlusPanel(),uni.showToast({title:"位置分享功能开发中",icon:"none"})},onInputFocus(){this.inputFocus=!0},onInputBlur(){this.inputFocus=!1},async sendMessage(){if(this.inputMessage.trim()){const e=this.inputMessage.trim(),t={id:Date.now(),type:"right",text:e,time:this.getCurrentTime(),demandParty:this.userId,createdAt:(new Date).toISOString()};this.messages.push(t),this.inputMessage="",this.$nextTick((()=>{this.scrollToBottom()})),await this.saveMessageToDatabase(e)}},async saveMessageToDatabase(e){try{const t=await uni.request({url:"http://localhost:8888/api/user-chat-detail/save",method:"POST",header:{"Content-Type":"application/json"},data:{sessionId:this.sessionId,demandParty:this.userId.toString(),message:e,responseParty:this.friendId?this.friendId.toString():null,senderType:"user"}});200===t.statusCode?o("log","at pages/chat/chat.vue:594","消息保存成功:",t.data):(o("error","at pages/chat/chat.vue:596","消息保存失败:",t),uni.showToast({title:"消息发送失败",icon:"none"}))}catch(t){o("error","at pages/chat/chat.vue:603","保存消息异常:",t),uni.showToast({title:"消息发送失败",icon:"none"})}},getCurrentTime(){const e=new Date,t=e.getHours();return`${t<12?"上午":"下午"}${t<12?t:t-12}:${e.getMinutes().toString().padStart(2,"0")}`},scrollToBottom(){this.scrollTop=999999},goToFriendCard(){o("log","at pages/chat/chat.vue:624","goToFriendCard 被调用，当前 friendId:",this.friendId),o("log","at pages/chat/chat.vue:625","当前 friendName:",this.friendName),this.friendId?uni.navigateTo({url:`/pages/chat/friend-card?friendName=${encodeURIComponent(this.friendName)}&friendId=${this.friendId}`}):uni.showToast({title:"好友信息不完整",icon:"error"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"chat-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-btn",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"back-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666","p-id":"727"})]))]),e.createElementVNode("text",{class:"title"},e.toDisplayString(i.friendName),1),e.createElementVNode("view",{class:"more-btn",onClick:a[1]||(a[1]=(...e)=>n.showMoreOptions&&n.showMoreOptions(...e))},[e.createElementVNode("view",{class:"dot"}),e.createElementVNode("view",{class:"dot"}),e.createElementVNode("view",{class:"dot"})])]),e.createElementVNode("scroll-view",{class:"chat-area","scroll-y":"true","scroll-top":i.scrollTop},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("button",{class:"retry-button",onClick:a[2]||(a[2]=(...e)=>n.loadChatMessages&&n.loadChatMessages(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):i.messages.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(i.messages,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["message",t.type])},["left"===t.type?(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar",src:"",mode:"aspectFill",onClick:a[3]||(a[3]=(...e)=>n.goToFriendCard&&n.goToFriendCard(...e))})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"message-bubble"},[e.createElementVNode("text",{class:"message-text"},e.toDisplayString(t.text),1)]),"right"===t.type?(e.openBlock(),e.createElementBlock("image",{key:1,class:"avatar",src:"",mode:"aspectFill"})):e.createCommentVNode("",!0)],2)))),128)):(e.openBlock(),e.createElementBlock("view",{key:3,class:"no-messages"},[e.createElementVNode("view",{class:"empty-icon"},"💬"),e.createElementVNode("text",{class:"no-messages-text"},"暂无聊天记录"),e.createElementVNode("text",{class:"no-messages-desc"},"开始与好友聊天吧")]))],8,["scroll-top"]),e.createElementVNode("view",{class:"input-bar"},[e.createElementVNode("view",{class:"mic-btn",onClick:a[4]||(a[4]=(...e)=>n.toggleVoiceInput&&n.toggleVoiceInput(...e))},[i.isVoiceMode?(e.openBlock(),e.createElementBlock("svg",{key:1,class:"keyboard-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M512 64A448 448 0 1 0 960 512 448.5 448.5 0 0 0 512 64z m0 832a384 384 0 1 1 384-384 384.5 384.5 0 0 1-384 384z",fill:"#333333","p-id":"2120"}),e.createElementVNode("path",{d:"M320 400m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z",fill:"#333333","p-id":"2121"}),e.createElementVNode("path",{d:"M448 448A48 48 0 1 0 400 400a48 48 0 0 0 48 48zM576 352a48 48 0 1 0 48 48 48 48 0 0 0-48-48zM704 352a48 48 0 1 0 48 48 48 48 0 0 0-48-48z",fill:"#333333","p-id":"2122"}),e.createElementVNode("path",{d:"M320 528m-48 0a48 48 0 1 0 96 0 48 48 0 1 0-96 0Z",fill:"#333333","p-id":"2123"}),e.createElementVNode("path",{d:"M448 576a48 48 0 1 0-48-48 48 48 0 0 0 48 48zM576 640H448a48 48 0 0 0 0 96h128a48 48 0 1 0 0-96zM576 480a48 48 0 1 0 48 48 48 48 0 0 0-48-48zM704 480a48 48 0 1 0 48 48 48 48 0 0 0-48-48z",fill:"#333333","p-id":"2124"})])):(e.openBlock(),e.createElementBlock("svg",{key:0,class:"mic-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M593.024 234.496l-46.165333 46.229333c0.106667 0.085333 0.149333 0.149333 0.277333 0.234667 127.552 127.658667 127.552 334.677333 0 462.336l46.122667 46.250667c153.045333-153.194667 153.045333-401.621333 0-554.816C593.173333 234.666667 593.130667 234.56 593.024 234.496z","p-id":"3544"}),e.createElementVNode("path",{d:"M500.885333 327.189333c-0.042667-0.085333-0.128-0.149333-0.234667-0.213333l-46.165333 46.229333c0.042667 0.085333 0.128 0.149333 0.234667 0.256 76.48 76.565333 76.48 200.789333 0 277.397333l46.144 46.229333C603.008 595.008 603.008 429.333333 500.885333 327.189333z","p-id":"3545"}),e.createElementVNode("path",{d:"M408.32 419.434667l-92.394667 92.458667 92.629333 92.714667c51.008-51.114667 51.008-133.888 0-184.938667C408.469333 419.584 408.362667 419.52 408.32 419.434667z","p-id":"3546"}),e.createElementVNode("path",{d:"M512 0C229.696 0 0 229.696 0 512c0 282.282667 229.696 512 512 512 282.282667 0 512-229.717333 512-512C1024 229.696 794.282667 0 512 0zM512 981.290667C253.226667 981.290667 42.688 770.773333 42.688 512S253.226667 42.688 512 42.688 981.290667 253.226667 981.290667 512 770.773333 981.290667 512 981.290667z","p-id":"3547"})]))]),i.isVoiceMode?(e.openBlock(),e.createElementBlock("view",{key:1,class:"voice-field",onTouchstart:a[9]||(a[9]=(...e)=>n.startVoiceRecord&&n.startVoiceRecord(...e)),onTouchend:a[10]||(a[10]=(...e)=>n.endVoiceRecord&&n.endVoiceRecord(...e))},[e.createElementVNode("text",{class:"voice-text"},"按住说话")],32)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"input-field"},[e.withDirectives(e.createElementVNode("input",{class:"message-input","onUpdate:modelValue":a[5]||(a[5]=e=>i.inputMessage=e),placeholder:"输入消息...",focus:i.inputFocus,onFocus:a[6]||(a[6]=(...e)=>n.onInputFocus&&n.onInputFocus(...e)),onBlur:a[7]||(a[7]=(...e)=>n.onInputBlur&&n.onInputBlur(...e)),onConfirm:a[8]||(a[8]=(...e)=>n.sendMessage&&n.sendMessage(...e))},null,40,["focus"]),[[e.vModelText,i.inputMessage]])])),e.createElementVNode("view",{class:"action-btns"},[e.createElementVNode("view",{class:"emoji-btn",onClick:a[11]||(a[11]=(...e)=>n.toggleEmoji&&n.toggleEmoji(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"emoji-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M512 160C317.5936 160 160 317.5936 160 512S317.5936 864 512 864 864 706.4064 864 512 706.4064 160 512 160z m0 64c159.0528 0 288 128.9472 288 288S671.0528 800 512 800 224 671.0528 224 512 352.9472 224 512 224z",fill:"#2c2c2c","p-id":"4603"}),e.createElementVNode("path",{d:"M683.3408 501.248H340.6592a25.6 25.6 0 0 0-25.6 26.112l0.1536 6.912a196.9408 196.9408 0 0 0 393.728-7.3984 25.6 25.6 0 0 0-25.6-25.6z m-27.8784 51.2l-0.3072 1.792A145.7664 145.7664 0 0 1 512 672.5888l-5.7088-0.1024a145.8176 145.8176 0 0 1-137.2928-117.4272l-0.4864-2.6112h286.9504z",fill:"#2c2c2c","p-id":"4604"}),e.createElementVNode("path",{d:"M411.1104 411.4432m-38.7584 0a38.7584 38.7584 0 1 0 77.5168 0 38.7584 38.7584 0 1 0-77.5168 0Z",fill:"#2c2c2c","p-id":"4605"}),e.createElementVNode("path",{d:"M612.8896 411.4432m-38.7584 0a38.7584 38.7584 0 1 0 77.5168 0 38.7584 38.7584 0 1 0-77.5168 0Z",fill:"#2c2c2c","p-id":"4606"})]))]),e.createElementVNode("view",{class:"plus-btn",onClick:a[12]||(a[12]=(...e)=>n.togglePlusMenu&&n.togglePlusMenu(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M511.5 957.9C264.9 957.9 65 758.2 65 511.9s199.9-446 446.5-446S958 265.6 958 511.9c0.1 246.3-199.8 446-446.5 446zM509 149.1c-200.4 0-355.8 162.2-355.8 362.3 0 200.1 155.4 356.8 355.8 356.8s362.9-156.7 362.9-356.8c0-200.1-162.5-362.3-362.9-362.3zM690.5 556h-134v133.8c0 24.6-20 44.6-44.6 44.6h-0.1c-24.6 0-44.6-19.9-44.6-44.6V556h-134c-24.7 0-44.6-19.9-44.6-44.5v-0.1c0-24.6 20-44.6 44.6-44.6h134V333c0-24.6 20-44.6 44.6-44.6h0.1c24.7 0 44.6 19.9 44.6 44.6v133.8h134c24.7 0 44.6 19.9 44.6 44.6v0.1c0 24.6-19.9 44.5-44.6 44.5z m0 0","p-id":"1640"})]))])])]),e.createElementVNode("view",{class:e.normalizeClass(["emoji-panel",{active:i.showEmojiPanel}]),onClick:a[14]||(a[14]=(...e)=>n.hideEmojiPanel&&n.hideEmojiPanel(...e))},[e.createElementVNode("view",{class:"emoji-content",onClick:a[13]||(a[13]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"emoji-grid"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(4,(t=>e.createElementVNode("view",{class:"emoji-item",key:`row1-${t}`},[e.createElementVNode("image",{class:"emoji-image",src:"",mode:"aspectFill"})]))),64)),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(4,(t=>e.createElementVNode("view",{class:"emoji-item",key:`row2-${t}`},[e.createElementVNode("image",{class:"emoji-image",src:"",mode:"aspectFill"})]))),64)),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(4,(t=>e.createElementVNode("view",{class:"emoji-item",key:`row3-${t}`},[e.createElementVNode("image",{class:"emoji-image",src:"",mode:"aspectFill"})]))),64))]),e.createElementVNode("view",{class:"emoji-pagination"},[e.createElementVNode("view",{class:"page-dot active"}),e.createElementVNode("view",{class:"page-dot"}),e.createElementVNode("view",{class:"page-dot"})])])],2),e.createElementVNode("view",{class:e.normalizeClass(["plus-panel",{active:i.showPlusPanel}]),onClick:a[20]||(a[20]=(...e)=>n.hidePlusPanel&&n.hidePlusPanel(...e))},[e.createElementVNode("view",{class:"plus-content",onClick:a[19]||(a[19]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"plus-grid"},[e.createElementVNode("view",{class:"plus-item",onClick:a[15]||(a[15]=(...e)=>n.selectImage&&n.selectImage(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zM338 304c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zm513.9 436.1H172.1c-12.9 0-24.8-5.9-32.7-16.1L73.4 659.8c-7.9-10.2-7.9-23.4 0-33.6l66-84.2c7.9-10.2 19.8-16.1 32.7-16.1h679.8c12.9 0 24.8 5.9 32.7 16.1l66 84.2c7.9 10.2 7.9 23.4 0 33.6l-66 84.2c-7.9 10.2-19.8 16.1-32.7 16.1z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"图片与视频")]),e.createElementVNode("view",{class:"plus-item",onClick:a[16]||(a[16]=(...e)=>n.openCamera&&n.openCamera(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M464 336a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"相机")]),e.createElementVNode("view",{class:"plus-item",onClick:a[17]||(a[17]=(...e)=>n.makeCall&&n.makeCall(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M512 336c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"语音/视频通话")]),e.createElementVNode("view",{class:"plus-item",onClick:a[18]||(a[18]=(...e)=>n.shareLocation&&n.shareLocation(...e))},[e.createElementVNode("view",{class:"plus-icon-wrapper"},[(e.openBlock(),e.createElementBlock("svg",{class:"plus-feature-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M512 336c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"plus-text"},"定位")])])])],2),e.createElementVNode("view",{class:e.normalizeClass(["action-sheet",{active:i.showActionSheet}]),onClick:a[26]||(a[26]=(...e)=>n.hideActionSheet&&n.hideActionSheet(...e))},[e.createElementVNode("view",{class:"action-content",onClick:a[25]||(a[25]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"action-item",onClick:a[21]||(a[21]=(...e)=>n.clearChat&&n.clearChat(...e))},[e.createElementVNode("text",{class:"action-text"},"清空聊天记录")]),e.createElementVNode("view",{class:"action-item",onClick:a[22]||(a[22]=(...e)=>n.reportChat&&n.reportChat(...e))},[e.createElementVNode("text",{class:"action-text"},"举报")]),e.createElementVNode("view",{class:"action-item",onClick:a[23]||(a[23]=(...e)=>n.blockUser&&n.blockUser(...e))},[e.createElementVNode("text",{class:"action-text"},"拉黑")]),e.createElementVNode("view",{class:"action-cancel",onClick:a[24]||(a[24]=(...e)=>n.hideActionSheet&&n.hideActionSheet(...e))},[e.createElementVNode("text",{class:"cancel-text"},"取消")])])],2)])}]]);const w=a({name:"SearchPage",data:()=>({searchKeyword:"",searchResults:[],allChatRecords:[],loading:!1,showDateSearchPanel:!1,startDate:"",endDate:"",showMediaSearchPanel:!1,currentMediaType:"all"}),onLoad(){this.loadChatRecords(),this.initDateRange()},methods:{onSearchInput(){o("log","at pages/chat/search.vue:98","搜索关键词:",this.searchKeyword),this.performSearch()},onSearchFocus(){o("log","at pages/chat/search.vue:103","搜索框获得焦点")},goBack(){uni.navigateBack()},showDateSearch(){this.showDateSearchPanel=!0,this.showMediaSearchPanel=!1,this.searchKeyword="",this.searchResults=[]},hideDateSearch(){this.showDateSearchPanel=!1},showMediaSearch(){this.showMediaSearchPanel=!0,this.showDateSearchPanel=!1,this.searchKeyword="",this.searchResults=[]},hideMediaSearch(){this.showMediaSearchPanel=!1},initDateRange(){const e=new Date,t=this.formatDateForPicker(e);this.startDate=t,this.endDate=t},formatDateForPicker:e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,onStartDateChange(e){this.startDate=e.detail.value,o("log","at pages/chat/search.vue:156","开始日期:",this.startDate)},onEndDateChange(e){this.endDate=e.detail.value,o("log","at pages/chat/search.vue:162","结束日期:",this.endDate)},searchByDate(){if(o("log","at pages/chat/search.vue:167","按日期搜索:",this.startDate,"到",this.endDate),!this.startDate||!this.endDate)return void uni.showToast({title:"请选择日期范围",icon:"none"});const e=new Date(this.startDate).getTime(),t=new Date(this.endDate+" 23:59:59").getTime(),a=this.allChatRecords.filter((a=>{const s=new Date(a.lastMessageTime||a.createdAt||0).getTime();return s>=e&&s<=t}));this.searchResults=a.sort(((e,t)=>{const a=new Date(e.lastMessageTime||e.createdAt||0).getTime();return new Date(t.lastMessageTime||t.createdAt||0).getTime()-a})),o("log","at pages/chat/search.vue:192","日期搜索结果:",this.searchResults),this.hideDateSearch()},searchByMediaType(e){o("log","at pages/chat/search.vue:198","按媒体类型搜索:",e),this.currentMediaType=e;let t=[];t="image"===e?["图片","照片","image","photo","jpg","png","gif","🖼️","📷"]:"video"===e?["视频","video","mp4","avi","mov","🎥","📹"]:["图片","照片","视频","image","photo","video","jpg","png","gif","mp4","avi","mov","🖼️","📷","🎥","📹"];const a=this.allChatRecords.filter((e=>{const a=(e.lastMessage||"").toLowerCase();return t.some((e=>a.includes(e.toLowerCase())))}));this.searchResults=a.sort(((e,t)=>{const a=new Date(e.lastMessageTime||e.createdAt||0).getTime();return new Date(t.lastMessageTime||t.createdAt||0).getTime()-a})),o("log","at pages/chat/search.vue:224","媒体搜索结果:",this.searchResults),this.hideMediaSearch()},async loadChatRecords(){try{this.loading=!0;const e=uni.getStorageSync("userId")||1000001;o("log","at pages/chat/search.vue:234","开始加载聊天记录，userId:",e);const[t,a]=await Promise.all([uni.request({url:`http://localhost:8888/api/u-entities/user-chat-list/user/${e}`,method:"GET",header:{"Content-Type":"application/json"}}),uni.request({url:"http://localhost:8888/api/u-entities/user-chat-detail/all",method:"GET",header:{"Content-Type":"application/json"}})]);o("log","at pages/chat/search.vue:254","聊天列表API响应状态码:",t.statusCode),o("log","at pages/chat/search.vue:255","聊天详情API响应状态码:",a.statusCode),200===t.statusCode&&t.data&&200===a.statusCode&&a.data?(o("log","at pages/chat/search.vue:260","原始聊天列表数据:",t.data),o("log","at pages/chat/search.vue:261","原始聊天详情数据:",a.data),this.allChatRecords=this.convertChatDataToSearchFormat(t.data,a.data),o("log","at pages/chat/search.vue:268","聊天记录加载成功:",this.allChatRecords),o("log","at pages/chat/search.vue:269","转换后的聊天记录数量:",this.allChatRecords.length),this.allChatRecords.forEach(((e,t)=>{o("log","at pages/chat/search.vue:273",`聊天记录 ${t+1}:`,{friendName:e.friendName,lastMessage:e.lastMessage,lastMessageTime:e.lastMessageTime,friendId:e.friendId})}))):o("error","at pages/chat/search.vue:281","加载聊天记录失败:",t,a)}catch(e){o("error","at pages/chat/search.vue:284","加载聊天记录异常:",e)}finally{this.loading=!1}},convertChatDataToSearchFormat(e,t){if(!Array.isArray(e)||!Array.isArray(t))return[];const a=new Map;return t.forEach((e=>{e.sessionId&&(a.has(e.sessionId)||a.set(e.sessionId,[]),a.get(e.sessionId).push(e))})),a.forEach(((e,t)=>{e.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)))})),e.map((e=>{let t=e.avatarUrl;t&&""!==t.trim()&&"null"!==t||(t="/static/default-avatar.png");let s=e.friendName;s&&""!==s.trim()&&"null"!==s||(s="未知用户");let o=e.lastMessage||"暂无消息",i=e.lastMessageTime;if(e.sessionId&&a.has(e.sessionId)){const t=a.get(e.sessionId);if(t.length>0){const e=t[0];o=e.message||"暂无消息",i=e.createdAt}}return{friendId:e.friendId,friendName:s,avatarUrl:t,lastMessage:o,lastMessageTime:i,createdAt:e.createdAt,sessionId:e.sessionId,status:e.status}}))},performSearch(){if(!this.searchKeyword||""===this.searchKeyword.trim())return void(this.searchResults=[]);const e=this.searchKeyword.toLowerCase().trim();o("log","at pages/chat/search.vue:360","执行搜索，关键词:",e),o("log","at pages/chat/search.vue:361","所有聊天记录:",this.allChatRecords),o("log","at pages/chat/search.vue:362","聊天记录数量:",this.allChatRecords.length);const t=this.allChatRecords.filter((t=>{const a=(t.friendName||"").toLowerCase(),s=(t.lastMessage||"").toLowerCase();return o("log","at pages/chat/search.vue:369","检查聊天记录:",{friendName:a,lastMessage:s,keyword:e,friendNameMatch:a.includes(e),lastMessageMatch:s.includes(e)}),a.includes(e)||s.includes(e)}));this.searchResults=t.sort(((e,t)=>{const a=new Date(e.lastMessageTime||e.createdAt||0).getTime();return new Date(t.lastMessageTime||t.createdAt||0).getTime()-a})),o("log","at pages/chat/search.vue:387","搜索结果:",this.searchResults),o("log","at pages/chat/search.vue:388","搜索结果数量:",this.searchResults.length)},formatTime(e){if(!e)return"";const t=new Date(e),a=new Date;if(a-t<864e5&&t.getDate()===a.getDate())return t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});const s=new Date(a);return s.setDate(s.getDate()-1),t.getDate()===s.getDate()&&t.getMonth()===s.getMonth()&&t.getFullYear()===s.getFullYear()?"昨天":t.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})},openChat(e){o("log","at pages/chat/search.vue:425","打开聊天:",e),uni.navigateTo({url:`/pages/chat/chat?friendName=${encodeURIComponent(e.friendName)}&friendId=${e.friendId}&sessionId=${e.sessionId}`})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"search-page"},[e.createElementVNode("view",{class:"search-bar-area"},[e.createElementVNode("view",{class:"search-input-field"},[e.withDirectives(e.createElementVNode("input",{class:"search-input",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>i.searchKeyword=e),placeholder:"搜索",onInput:a[1]||(a[1]=(...e)=>n.onSearchInput&&n.onSearchInput(...e)),onFocus:a[2]||(a[2]=(...e)=>n.onSearchFocus&&n.onSearchFocus(...e))},null,544),[[e.vModelText,i.searchKeyword]])]),e.createElementVNode("view",{class:"cancel-btn",onClick:a[3]||(a[3]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("text",{class:"cancel-text"},"取消")])]),i.searchKeyword&&i.searchResults.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"search-results-area"},[e.createElementVNode("view",{class:"results-header"},[e.createElementVNode("text",{class:"results-count"},"找到 "+e.toDisplayString(i.searchResults.length)+" 条相关记录",1)]),e.createElementVNode("scroll-view",{class:"results-list","scroll-y":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.searchResults,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"result-item",key:a,onClick:e=>n.openChat(t)},[e.createElementVNode("view",{class:"result-avatar"},[e.createElementVNode("image",{class:"avatar-image",src:t.avatarUrl,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("view",{class:"result-header"},[e.createElementVNode("text",{class:"result-name"},e.toDisplayString(t.friendName),1),e.createElementVNode("text",{class:"result-time"},e.toDisplayString(n.formatTime(t.lastMessageTime)),1)]),e.createElementVNode("view",{class:"result-message"},[e.createElementVNode("text",{class:"message-text"},e.toDisplayString(t.lastMessage),1)])])],8,["onClick"])))),128))])])):i.searchKeyword?i.searchKeyword&&0===i.searchResults.length?(e.openBlock(),e.createElementBlock("view",{key:2,class:"no-results-area"},[e.createElementVNode("view",{class:"no-results-icon"},"🔍"),e.createElementVNode("text",{class:"no-results-text"},"未找到相关聊天记录"),e.createElementVNode("text",{class:"no-results-desc"},"试试其他关键词")])):e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content-filter-area"},[e.createElementVNode("text",{class:"filter-prompt"}),e.createElementVNode("view",{class:"category-labels"})])),e.createElementVNode("view",{class:"home-indicator"})])}]]);const E=a({name:"DateSearchPage",data:()=>({currentYear:2021,currentMonth:8,selectedDate:null,viewMode:"month",showYearPicker:!1,showMonthPicker:!1,weekdays:["一","二","三","四","五","六","七"]}),computed:{yearRange(){const e=[];for(let t=2020;t<=2025;t++)e.push(t);return e},calendarDates(){const e=[],t=new Date(this.currentYear,this.currentMonth-1,1),a=new Date(this.currentYear,this.currentMonth,0),s=new Date(t);s.setDate(s.getDate()-t.getDay()+1);for(let i=0;i<t.getDay()-1;i++){const t=new Date(s);t.setDate(t.getDate()+i),e.push({day:t.getDate(),otherMonth:!0,selected:!1,isToday:!1,fullDate:t})}for(let i=1;i<=a.getDate();i++){const t=new Date(this.currentYear,this.currentMonth-1,i),a=this.isToday(t),s=this.selectedDate&&this.isSameDate(t,this.selectedDate);e.push({day:i,otherMonth:!1,selected:s,isToday:a,fullDate:t})}const o=42-e.length;for(let i=1;i<=o;i++){const t=new Date(this.currentYear,this.currentMonth,i);e.push({day:i,otherMonth:!0,selected:!1,isToday:!1,fullDate:t})}return e}},methods:{goBack(){uni.navigateBack()},setViewMode(e){this.viewMode=e},openYearPicker(){this.showYearPicker=!0},hideYearPicker(){this.showYearPicker=!1},openMonthPicker(){this.showMonthPicker=!0},hideMonthPicker(){this.showMonthPicker=!1},selectYear(e){this.currentYear=e,this.showYearPicker=!1},selectMonth(e){this.currentMonth=e,this.showMonthPicker=!1},selectDate(e){e.otherMonth||(this.selectedDate=e.fullDate,uni.showToast({title:`已选择: ${e.fullDate.getFullYear()}-${(e.fullDate.getMonth()+1).toString().padStart(2,"0")}-${e.fullDate.getDate().toString().padStart(2,"0")}`,icon:"none"}))},isToday(e){const t=new Date;return this.isSameDate(e,t)},isSameDate:(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"date-search-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("view",{class:"back-arrow"})]),e.createElementVNode("text",{class:"title"},"按日期查找"),e.createElementVNode("view",{class:"placeholder"})]),e.createElementVNode("view",{class:"date-controls"},[e.createElementVNode("view",{class:"year-month-row"},[e.createElementVNode("view",{class:"dropdown year-dropdown",onClick:a[1]||(a[1]=(...e)=>n.openYearPicker&&n.openYearPicker(...e))},[e.createElementVNode("text",{class:"dropdown-text"},e.toDisplayString(i.currentYear)+"年",1),e.createElementVNode("view",{class:"dropdown-arrow"})]),e.createElementVNode("view",{class:"dropdown month-dropdown",onClick:a[2]||(a[2]=(...e)=>n.openMonthPicker&&n.openMonthPicker(...e))},[e.createElementVNode("text",{class:"dropdown-text"},e.toDisplayString(i.currentMonth)+"月",1),e.createElementVNode("view",{class:"dropdown-arrow"})])]),e.createElementVNode("view",{class:"view-toggle"},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-btn",{active:"month"===i.viewMode}]),onClick:a[3]||(a[3]=e=>n.setViewMode("month"))},[e.createElementVNode("text",{class:"toggle-text"},"月")],2),e.createElementVNode("view",{class:e.normalizeClass(["toggle-btn",{active:"year"===i.viewMode}]),onClick:a[4]||(a[4]=e=>n.setViewMode("year"))},[e.createElementVNode("text",{class:"toggle-text"},"年")],2)])]),e.createElementVNode("view",{class:"calendar-grid"},[e.createElementVNode("view",{class:"weekdays-row"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.weekdays,(t=>(e.openBlock(),e.createElementBlock("view",{class:"weekday",key:t},[e.createElementVNode("text",{class:"weekday-text"},e.toDisplayString(t),1)])))),128))]),e.createElementVNode("view",{class:"dates-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.calendarDates,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["date-cell",{"other-month":t.otherMonth,"current-month":!t.otherMonth,selected:t.selected,today:t.isToday}]),key:a,onClick:e=>n.selectDate(t)},[e.createElementVNode("text",{class:"date-number"},e.toDisplayString(t.day),1),t.selected?(e.openBlock(),e.createElementBlock("view",{key:0,class:"selected-dot"})):e.createCommentVNode("",!0)],10,["onClick"])))),128))])]),i.showYearPicker?(e.openBlock(),e.createElementBlock("view",{key:0,class:"year-picker-overlay",onClick:a[6]||(a[6]=(...e)=>n.hideYearPicker&&n.hideYearPicker(...e))},[e.createElementVNode("view",{class:"year-picker-sheet",onClick:a[5]||(a[5]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"year-picker-content"},[e.createElementVNode("view",{class:"year-range"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.yearRange,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["year-item",{active:t===i.currentYear}]),key:t,onClick:e=>n.selectYear(t)},[e.createElementVNode("text",{class:"year-text"},e.toDisplayString(t),1)],10,["onClick"])))),128))])])])])):e.createCommentVNode("",!0),i.showMonthPicker?(e.openBlock(),e.createElementBlock("view",{key:1,class:"month-picker-overlay",onClick:a[8]||(a[8]=(...e)=>n.hideMonthPicker&&n.hideMonthPicker(...e))},[e.createElementVNode("view",{class:"month-picker-sheet",onClick:a[7]||(a[7]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"month-picker-content"},[e.createElementVNode("view",{class:"month-grid"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(12,(t=>e.createElementVNode("view",{class:e.normalizeClass(["month-item",{active:t===i.currentMonth}]),key:t,onClick:e=>n.selectMonth(t)},[e.createElementVNode("text",{class:"month-text"},e.toDisplayString(t)+"月",1)],10,["onClick"]))),64))])])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"home-indicator"})])}]]);const N=a({name:"SearchResultsPage",data:()=>({})},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"search-results-page"},[e.createElementVNode("view",{class:"search-bar-area"},[e.createElementVNode("view",{class:"search-input-field"},[e.createElementVNode("text",{class:"search-text"},"意大利面")]),e.createElementVNode("view",{class:"cancel-btn"},[e.createElementVNode("text",{class:"cancel-text"},"取消")])]),e.createElementVNode("view",{class:"tab-navigation"},[e.createElementVNode("view",{class:"tab-item active"},[e.createElementVNode("text",{class:"tab-text"},"全部")]),e.createElementVNode("view",{class:"tab-item"},[e.createElementVNode("text",{class:"tab-text"},"图片")]),e.createElementVNode("view",{class:"tab-item"},[e.createElementVNode("text",{class:"tab-text"},"AI")]),e.createElementVNode("view",{class:"tab-item"},[e.createElementVNode("text",{class:"tab-text"},"链接")]),e.createElementVNode("view",{class:"tab-item"},[e.createElementVNode("text",{class:"tab-text"},"音乐与音频")])]),e.createElementVNode("view",{class:"search-results-list"},[e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{class:"profile-pic",src:"",mode:"aspectFill"})]),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-title"},"厚乳抹茶蛋糕"),e.createElementVNode("view",{class:"item-snippet"},[e.createElementVNode("text",{class:"snippet-text"},"问题的。我认为"),e.createElementVNode("text",{class:"highlighted-text"},"意大利面"),e.createElementVNode("text",{class:"snippet-text"},"就应该拌四十二号混凝土")])]),e.createElementVNode("view",{class:"item-right"},[e.createElementVNode("text",{class:"item-date"},"8月5日")])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{class:"profile-pic",src:"",mode:"aspectFill"})]),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-title"},"猫又屋之主(AI)"),e.createElementVNode("view",{class:"item-snippet"},[e.createElementVNode("text",{class:"snippet-text"},"就"),e.createElementVNode("text",{class:"highlighted-text"},"意大利面"),e.createElementVNode("text",{class:"snippet-text"},"就行吧")])]),e.createElementVNode("view",{class:"item-right"},[e.createElementVNode("text",{class:"item-date"},"7月13日")])])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const V=a({data:()=>({friendName:"念念",friendId:null,userId:null,chatSettings:[],loading:!1,errorMessage:"",userSettings:{doNotDisturb:!1,pinChat:!1,reminders:!1,chatBackground:""}}),onLoad(e){e.friendName&&(this.friendName=decodeURIComponent(e.friendName)),e.friendId&&(this.friendId=parseInt(e.friendId)),this.userId=uni.getStorageSync("userId")||1,o("log","at pages/chat/chat-info.vue:139","chat-info页面加载参数:",e),o("log","at pages/chat/chat-info.vue:140","用户ID:",this.userId),o("log","at pages/chat/chat-info.vue:141","好友ID:",this.friendId),o("log","at pages/chat/chat-info.vue:142","好友名称:",this.friendName),this.friendId||(this.friendId=uni.getStorageSync("currentFriendId"),o("log","at pages/chat/chat-info.vue:147","从存储中获取好友ID:",this.friendId)),this.friendId||(o("error","at pages/chat/chat-info.vue:152","好友ID不存在，无法加载设置"),this.friendId=1000001,o("log","at pages/chat/chat-info.vue:155","使用默认好友ID:",this.friendId),uni.showToast({title:"使用默认好友设置",icon:"none",duration:2e3})),this.loadChatSettings(),this.loadUserSettings()},methods:{async loadChatSettings(){this.loading=!0,this.errorMessage="";try{o("log","at pages/chat/chat-info.vue:175","开始加载聊天设置选项...");const e=await uni.request({url:"http://localhost:8888/api/bc-entities/chat-settings-base/all",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/chat/chat-info.vue:184","聊天设置API响应状态码:",e.statusCode),o("log","at pages/chat/chat-info.vue:185","聊天设置API响应数据:",e.data),200===e.statusCode&&e.data?(this.chatSettings=e.data.filter((e=>1===e.status)),o("log","at pages/chat/chat-info.vue:189","聊天设置加载成功:",this.chatSettings)):(this.errorMessage=`加载聊天设置失败，状态码: ${e.statusCode}`,o("error","at pages/chat/chat-info.vue:192","加载聊天设置失败:",e))}catch(e){this.errorMessage="网络错误，请检查连接",o("error","at pages/chat/chat-info.vue:196","加载聊天设置异常:",e)}finally{this.loading=!1}},getSettingStatus(e){const t={"消息免打扰":"doNotDisturb","置顶聊天":"pinChat","提醒":"reminders"}[e];return!!t&&this.userSettings[t]},toggleSetting(e){o("log","at pages/chat/chat-info.vue:215","toggleSetting被调用，设置名称:",e);const t={"消息免打扰":{key:"doNotDisturb",settingId:10000002},"置顶聊天":{key:"pinChat",settingId:10000003},"提醒":{key:"reminders",settingId:10000004}}[e];if(t){this.userSettings[t.key]=!this.userSettings[t.key],o("log","at pages/chat/chat-info.vue:224",`${e} 状态切换为:`,this.userSettings[t.key]);const a=this.userSettings[t.key]?'["1"]':'["0"]';o("log","at pages/chat/chat-info.vue:227","准备保存设置值:",a),this.saveSingleSetting(t.settingId,a)}else o("log","at pages/chat/chat-info.vue:230","未找到对应的设置映射:",e)},async loadUserSettings(){if(this.userId&&this.friendId)try{o("log","at pages/chat/chat-info.vue:242","开始加载用户设置，userId:",this.userId,"friendId:",this.friendId);const t=await uni.request({url:`http://localhost:8888/api/u-entities/user-friends-relationship/settings/${this.userId}/${this.friendId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/chat/chat-info.vue:251","用户设置API响应状态码:",t.statusCode),o("log","at pages/chat/chat-info.vue:252","用户设置API响应数据:",t.data),200===t.statusCode&&t.data)try{const e=JSON.parse(t.data.doNotDisturb||'["0"]'),a=JSON.parse(t.data.pinChat||'["0"]'),s=JSON.parse(t.data.reminders||'["0"]'),i=JSON.parse(t.data.chatBackground||'[""]');this.userSettings.doNotDisturb="1"===e[0],this.userSettings.pinChat="1"===a[0],this.userSettings.reminders="1"===s[0],this.userSettings.chatBackground=i[0]||"",o("log","at pages/chat/chat-info.vue:266","用户设置加载成功:",this.userSettings)}catch(e){o("error","at pages/chat/chat-info.vue:268","解析设置数据失败:",e),this.userSettings.doNotDisturb=!1,this.userSettings.pinChat=!1,this.userSettings.reminders=!1,this.userSettings.chatBackground=""}else o("error","at pages/chat/chat-info.vue:276","加载用户设置失败:",t)}catch(t){o("error","at pages/chat/chat-info.vue:279","加载用户设置异常:",t)}else o("log","at pages/chat/chat-info.vue:237","用户ID或好友ID不存在，使用默认设置")},async saveSingleSetting(e,t){if(o("log","at pages/chat/chat-info.vue:285","saveSingleSetting被调用，参数:",{settingId:e,settingValue:t}),o("log","at pages/chat/chat-info.vue:286","当前用户ID:",this.userId),o("log","at pages/chat/chat-info.vue:287","当前好友ID:",this.friendId),!this.userId)return o("error","at pages/chat/chat-info.vue:290","用户ID不存在，无法保存设置"),void uni.showToast({title:"用户信息错误，无法保存设置",icon:"error",duration:2e3});if(!this.friendId)return o("error","at pages/chat/chat-info.vue:300","好友ID不存在，无法保存设置"),void uni.showToast({title:"好友信息不完整，无法保存设置",icon:"error",duration:2e3});try{const a={userId:this.userId,friendId:this.friendId,settingId:e,settingValue:t};o("log","at pages/chat/chat-info.vue:317","开始保存单个设置:",a);const s=await uni.request({url:"http://localhost:8888/api/u-entities/user-friends-relationship/save-settings",method:"POST",header:{"Content-Type":"application/json"},data:a});o("log","at pages/chat/chat-info.vue:327","保存单个设置API响应状态码:",s.statusCode),o("log","at pages/chat/chat-info.vue:328","保存单个设置API响应数据:",s.data),200===s.statusCode?(o("log","at pages/chat/chat-info.vue:331","单个设置保存成功"),uni.showToast({title:"设置已保存",icon:"success",duration:1e3})):(o("error","at pages/chat/chat-info.vue:338","保存单个设置失败:",s),uni.showToast({title:"保存失败",icon:"error",duration:1e3}))}catch(a){o("error","at pages/chat/chat-info.vue:346","保存单个设置异常:",a),uni.showToast({title:"保存失败",icon:"error",duration:1e3})}},isToggleSetting:e=>["消息免打扰","置顶聊天","提醒"].includes(e),handleSettingClick(e){const t=e.chatSettingName;if(!this.isToggleSetting(t))switch(t){case"查找聊天记录":this.goToSearchHistory();break;case"设置聊天背景":this.goToSetBackground();break;case"清空聊天记录":this.goToClearHistory();break;case"举报":this.goToReport();break;default:o("log","at pages/chat/chat-info.vue:385","未知设置项:",t),uni.showToast({title:`${t} 功能开发中`,icon:"none"})}},goToSetBackground(){uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths[0];this.userSettings.chatBackground=t;const a=JSON.stringify([t]);this.saveSingleSetting(10000005,a),uni.showToast({title:"背景设置成功",icon:"success"})},fail:e=>{o("error","at pages/chat/chat-info.vue:413","选择图片失败:",e),uni.showToast({title:"选择图片失败",icon:"error"})}})},goBack(){uni.navigateBack()},goToSearchHistory(){uni.navigateTo({url:"/pages/chat/search"})},goToClearHistory(){uni.showToast({title:"清空聊天记录功能",icon:"none"})},goToReport(){uni.navigateTo({url:"/pages/report/report"})},goToHome(){uni.navigateTo({url:"/pages/content-feed/content-feed"})},goToFriendList(){uni.navigateTo({url:"/pages/friend-list/friend-list"})},goToAIList(){uni.navigateTo({url:"/pages/ai-list/ai-list"})},goToProfile(){uni.navigateTo({url:"/pages/user-profile/user-profile"})},goToFriendCard(){uni.navigateTo({url:`/pages/chat/friend-card?friendName=${encodeURIComponent(this.friendName)}&friendId=${this.friendId}`})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"profile-section",onClick:a[0]||(a[0]=(...e)=>n.goToFriendCard&&n.goToFriendCard(...e))},[e.createElementVNode("view",{class:"avatar-container"},[e.createElementVNode("view",{class:"avatar"},[e.createElementVNode("text",{class:"avatar-text"},"🐱")])]),e.createElementVNode("text",{class:"username"},e.toDisplayString(i.friendName),1)]),e.createElementVNode("view",{class:"settings-list"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载设置中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("button",{class:"retry-button",onClick:a[1]||(a[1]=(...e)=>n.loadChatSettings&&n.loadChatSettings(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.chatSettings,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.chatSettingId,class:"setting-item",onClick:e=>n.handleSettingClick(t)},[e.createElementVNode("text",{class:"setting-text"},e.toDisplayString(t.chatSettingName),1),n.isToggleSetting(t.chatSettingName)?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["toggle-switch",{active:n.getSettingStatus(t.chatSettingName)}]),onClick:e.withModifiers((e=>n.toggleSetting(t.chatSettingName)),["stop"])},[e.createElementVNode("view",{class:"toggle-circle"})],10,["onClick"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"arrow"},"›"))],8,["onClick"])))),128))]))]),e.createElementVNode("view",{class:"bottom-nav"},[e.createElementVNode("view",{class:"nav-item",onClick:a[2]||(a[2]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item"},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item",onClick:a[3]||(a[3]=(...e)=>n.goToAIList&&n.goToAIList(...e))},[e.createElementVNode("view",{class:"ai-icon"},"AI")]),e.createElementVNode("view",{class:"nav-item",onClick:a[4]||(a[4]=(...e)=>n.goToFriendList&&n.goToFriendList(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-item",onClick:a[5]||(a[5]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("view",{class:"nav-avatar"},[e.createElementVNode("view",{class:"mini-cat-avatar"},[e.createElementVNode("view",{class:"mini-cat-body"}),e.createElementVNode("view",{class:"mini-cat-face"},[e.createElementVNode("view",{class:"mini-cat-eyes"},[e.createElementVNode("view",{class:"mini-cat-eye"}),e.createElementVNode("view",{class:"mini-cat-eye"})])])])])])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const k=a({data:()=>({friendName:"",friendId:null,userId:null,friendInfo:{nickname:"",avatar:"",location:""},loading:!1,errorMessage:"",showProfileModal:!1,saving:!1,profileData:{friendsProfile:""}}),onLoad(e){e.friendName&&(this.friendName=decodeURIComponent(e.friendName)),e.friendId&&(this.friendId=parseInt(e.friendId)),this.userId=uni.getStorageSync("userId")||1,o("log","at pages/chat/friend-card.vue:165","friend-card页面加载参数:",e),o("log","at pages/chat/friend-card.vue:166","用户ID:",this.userId),o("log","at pages/chat/friend-card.vue:167","好友ID:",this.friendId),o("log","at pages/chat/friend-card.vue:168","好友名称:",this.friendName),this.loadFriendInfo(),this.loadFriendProfile()},methods:{async loadFriendInfo(){if(!this.friendId)return o("log","at pages/chat/friend-card.vue:179","好友ID不存在，使用默认信息"),void(this.friendInfo.nickname=this.friendName);this.loading=!0,this.errorMessage="";try{o("log","at pages/chat/friend-card.vue:188","开始加载好友信息，friendId:",this.friendId);const e=await uni.request({url:`http://localhost:8888/api/users/${this.friendId}`,method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/chat/friend-card.vue:197","好友信息API响应状态码:",e.statusCode),o("log","at pages/chat/friend-card.vue:198","好友信息API响应数据:",e.data),200===e.statusCode&&e.data?(this.friendInfo={nickname:e.data.realName||e.data.username||this.friendName,avatar:e.data.profilePicUrl||"",location:e.data.location||""},o("log","at pages/chat/friend-card.vue:206","好友信息加载成功:",this.friendInfo)):(o("error","at pages/chat/friend-card.vue:208","加载好友信息失败:",e),this.errorMessage="加载好友信息失败",this.friendInfo.nickname=this.friendName)}catch(e){o("error","at pages/chat/friend-card.vue:214","加载好友信息异常:",e),this.errorMessage="网络错误，请检查连接",this.friendInfo.nickname=this.friendName}finally{this.loading=!1}},goBack(){uni.navigateBack()},showMoreOptions(){uni.showActionSheet({itemList:["设置备注和标签","设置朋友圈权限","加入黑名单","删除好友"],success:e=>{o("log","at pages/chat/friend-card.vue:231","选择了第"+(e.tapIndex+1)+"个选项")}})},goToFriendInfo(){this.showProfileModal=!0,this.loadFriendProfile()},goToFriendHomepage(){uni.navigateTo({url:`/pages/feed/user-profile?friendName=${encodeURIComponent(this.friendName)}`})},sendMessage(){this.friendId?uni.navigateTo({url:`/pages/chat/chat?friendId=${this.friendId}&friendName=${encodeURIComponent(this.friendInfo.nickname||this.friendName)}`}):uni.showToast({title:"好友信息不完整",icon:"error"})},async loadFriendProfile(){if(this.userId&&this.friendId)try{o("log","at pages/chat/friend-card.vue:269","开始加载朋友资料，userId:",this.userId,"friendId:",this.friendId);const e=await uni.request({url:`http://localhost:8888/api/u-entities/friends-profile/${this.userId}/${this.friendId}`,method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/chat/friend-card.vue:278","朋友资料API响应状态码:",e.statusCode),o("log","at pages/chat/friend-card.vue:279","朋友资料API响应数据:",e.data),200===e.statusCode&&e.data?(this.profileData={friendsProfile:e.data.friendsProfile||""},o("log","at pages/chat/friend-card.vue:285","朋友资料加载成功:",this.profileData)):(o("log","at pages/chat/friend-card.vue:287","朋友资料不存在，使用默认值"),this.profileData={friendsProfile:""})}catch(e){o("error","at pages/chat/friend-card.vue:294","加载朋友资料异常:",e),this.profileData={friendsProfile:""}}else o("log","at pages/chat/friend-card.vue:264","用户ID或好友ID不存在，无法加载朋友资料")},async saveProfile(){if(this.userId&&this.friendId)if(this.profileData.friendsProfile.length>255)uni.showToast({title:"备注内容不能超过255个字符",icon:"error"});else{this.saving=!0;try{const e={userId:this.userId,friendId:this.friendId,friendsProfile:this.profileData.friendsProfile};o("log","at pages/chat/friend-card.vue:330","开始保存朋友资料:",e);const t=await uni.request({url:"http://localhost:8888/api/u-entities/friends-profile/save",method:"POST",header:{"Content-Type":"application/json"},data:e});o("log","at pages/chat/friend-card.vue:340","保存朋友资料API响应状态码:",t.statusCode),o("log","at pages/chat/friend-card.vue:341","保存朋友资料API响应数据:",t.data),200===t.statusCode?(uni.showToast({title:"保存成功",icon:"success"}),this.closeProfileModal()):(o("error","at pages/chat/friend-card.vue:350","保存朋友资料失败:",t),uni.showToast({title:"保存失败",icon:"error"}))}catch(e){o("error","at pages/chat/friend-card.vue:357","保存朋友资料异常:",e),uni.showToast({title:"保存失败",icon:"error"})}finally{this.saving=!1}}else uni.showToast({title:"参数错误，无法保存",icon:"error"})},closeProfileModal(){this.showProfileModal=!1,this.profileData={friendsProfile:""}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("text",{class:"back-arrow"},"‹")]),e.createElementVNode("text",{class:"nav-title"},e.toDisplayString(i.friendName),1),e.createElementVNode("view",{class:"more-button",onClick:a[1]||(a[1]=(...e)=>n.showMoreOptions&&n.showMoreOptions(...e))},[e.createElementVNode("text",{class:"more-dots"},"⋯")])]),e.createElementVNode("view",{class:"friend-info-section"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载好友信息中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("button",{class:"retry-button",onClick:a[2]||(a[2]=(...e)=>n.loadFriendInfo&&n.loadFriendInfo(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:2},[e.createElementVNode("view",{class:"avatar-container"},[e.createElementVNode("view",{class:"avatar"},[i.friendInfo.avatar?(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar-image",src:i.friendInfo.avatar,mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"avatar-text"},"🐱"))])]),e.createElementVNode("view",{class:"friend-details"},[e.createElementVNode("text",{class:"friend-name"},e.toDisplayString(i.friendInfo.nickname||i.friendName),1),e.createElementVNode("text",{class:"friend-nickname"},"昵称: "+e.toDisplayString(i.friendInfo.nickname||i.friendName),1),i.friendInfo.location?(e.openBlock(),e.createElementBlock("text",{key:0,class:"friend-location"},"地区: "+e.toDisplayString(i.friendInfo.location),1)):e.createCommentVNode("",!0)])]))]),e.createElementVNode("view",{class:"options-list"},[e.createElementVNode("view",{class:"option-item",onClick:a[3]||(a[3]=(...e)=>n.goToFriendInfo&&n.goToFriendInfo(...e))},[e.createElementVNode("text",{class:"option-text"},"朋友资料"),i.profileData.friendsProfile?(e.openBlock(),e.createElementBlock("text",{key:0,class:"option-desc"},e.toDisplayString(i.profileData.friendsProfile),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"option-desc"},"添加朋友的备注名、电话、标签、备忘、照片等。")),e.createElementVNode("text",{class:"arrow"},"›")]),e.createElementVNode("view",{class:"option-item",onClick:a[4]||(a[4]=(...e)=>n.goToFriendHomepage&&n.goToFriendHomepage(...e))},[e.createElementVNode("text",{class:"option-text"},"好友主页"),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"action-buttons"},[e.createElementVNode("view",{class:"action-btn send-message",onClick:a[5]||(a[5]=(...e)=>n.sendMessage&&n.sendMessage(...e))},[e.createElementVNode("view",{class:"btn-icon"},[(e.openBlock(),e.createElementBlock("svg",{class:"message-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M512 336c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176z",fill:"#333333"})]))]),e.createElementVNode("text",{class:"btn-text"},"发消息")])]),e.createElementVNode("view",{class:"home-indicator"}),i.showProfileModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-overlay",onClick:a[11]||(a[11]=(...e)=>n.closeProfileModal&&n.closeProfileModal(...e))},[e.createElementVNode("view",{class:"modal-content",onClick:a[10]||(a[10]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"朋友资料"),e.createElementVNode("view",{class:"close-button",onClick:a[6]||(a[6]=(...e)=>n.closeProfileModal&&n.closeProfileModal(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"modal-body"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"备注"),e.withDirectives(e.createElementVNode("textarea",{class:"textarea-field","onUpdate:modelValue":a[7]||(a[7]=e=>i.profileData.friendsProfile=e),placeholder:"请输入备注信息",maxlength:"255","show-confirm-bar":!1},null,512),[[e.vModelText,i.profileData.friendsProfile]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(i.profileData.friendsProfile.length)+"/255",1)])]),e.createElementVNode("view",{class:"modal-footer"},[e.createElementVNode("button",{class:"cancel-btn",onClick:a[8]||(a[8]=(...e)=>n.closeProfileModal&&n.closeProfileModal(...e))},"取消"),e.createElementVNode("button",{class:"save-btn",onClick:a[9]||(a[9]=(...e)=>n.saveProfile&&n.saveProfile(...e)),disabled:i.saving},[i.saving?(e.openBlock(),e.createElementBlock("text",{key:0},"保存中...")):(e.openBlock(),e.createElementBlock("text",{key:1},"保存"))],8,["disabled"])])])])):e.createCommentVNode("",!0)])}]]);const f=a({data:()=>({userId:null,friends:[],groupedFriends:{},displayedFriends:{},searchKeyword:"",loading:!1,errorMessage:""}),onLoad(){this.userId=uni.getStorageSync("userId")||1000001,o("log","at pages/chat/friend-list.vue:122","好友列表页面加载，userId:",this.userId),this.loadFriends()},methods:{async loadFriends(){if(this.userId){this.loading=!0,this.errorMessage="";try{o("log","at pages/chat/friend-list.vue:137","开始加载好友列表，userId:",this.userId);const e=await uni.request({url:`http://localhost:8888/api/u-entities/user-chat-list/user/${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/chat/friend-list.vue:146","好友列表API响应状态码:",e.statusCode),o("log","at pages/chat/friend-list.vue:147","好友列表API响应数据:",e.data),200===e.statusCode&&e.data?(this.friends=this.convertChatListToFriends(e.data),this.groupedFriends=this.groupFriendsByFirstLetter(this.friends),this.displayedFriends=this.groupedFriends,o("log","at pages/chat/friend-list.vue:153","好友列表加载成功:",this.friends),o("log","at pages/chat/friend-list.vue:154","分组后的好友列表:",this.groupedFriends)):(this.errorMessage=`加载好友列表失败，状态码: ${e.statusCode}`,o("error","at pages/chat/friend-list.vue:157","加载好友列表失败:",e))}catch(e){this.errorMessage="网络错误，请检查连接",o("error","at pages/chat/friend-list.vue:161","加载好友列表异常:",e)}finally{this.loading=!1}}else this.errorMessage="用户ID不存在"},convertChatListToFriends:e=>Array.isArray(e)?e.map((e=>{let t=e.avatarUrl;t&&""!==t.trim()&&"null"!==t||(t="/static/default-avatar.png");let a=e.friendName;return a&&""!==a.trim()&&"null"!==a||(a="未知用户"),{friendId:e.friendId,friendName:a,avatarUrl:t,status:"online",lastActive:e.lastMessageTime,createdAt:e.createdAt,sessionId:e.sessionId}})):[],groupFriendsByFirstLetter(e){const t={};e.forEach((e=>{const a=this.getFirstLetter(e.friendName||"");t[a]||(t[a]=[]),t[a].push(e)})),Object.keys(t).forEach((e=>{t[e].sort(((e,t)=>(e.friendName||"").localeCompare(t.friendName||"")))}));const a={};return Object.keys(t).sort(((e,t)=>"#"===e?1:"#"===t?-1:e.localeCompare(t))).forEach((e=>{a[e]=t[e]})),a},getFirstLetter(e){if(!e)return"#";const t=e.charAt(0);if(/[A-Za-z]/.test(t))return t.toUpperCase();return{"阿":"A","安":"A","艾":"A","爱":"A","白":"B","北":"B","本":"B","包":"B","边":"B","陈":"C","程":"C","成":"C","春":"C","蔡":"C","曹":"C","大":"D","丁":"D","东":"D","邓":"D","段":"D","二":"E","恩":"E","方":"F","冯":"F","付":"F","风":"F","范":"F","费":"F","高":"G","郭":"G","顾":"G","关":"G","谷":"G","韩":"H","何":"H","黄":"H","胡":"H","华":"H","侯":"H","伊":"I","江":"J","金":"J","贾":"J","蒋":"J","姜":"J","季":"J","康":"K","孔":"K","柯":"K","李":"L","刘":"L","林":"L","卢":"L","梁":"L","罗":"L","陆":"L","马":"M","毛":"M","孟":"M","莫":"M","米":"M","南":"N","牛":"N","倪":"N","奶":"N","宁":"N","聂":"N","欧":"O","欧":"O","潘":"P","彭":"P","皮":"P","钱":"Q","秦":"Q","邱":"Q","齐":"Q","任":"R","阮":"R","荣":"R","孙":"S","宋":"S","苏":"S","沈":"S","石":"S","史":"S","唐":"T","田":"T","陶":"T","汤":"T","谭":"T","吴":"U","武":"U","王":"V","魏":"V","韦":"V","温":"V","王":"W","吴":"W","武":"W","魏":"W","韦":"W","温":"W","谢":"X","徐":"X","许":"X","夏":"X","星":"X","小":"X","肖":"X","薛":"X","杨":"Y","叶":"Y","于":"Y","袁":"Y","砚":"Y","夜":"Y","姚":"Y","严":"Y","易":"Y","张":"Z","赵":"Z","周":"Z","朱":"Z","郑":"Z","钟":"Z","曾":"Z"}[t]||"#"},goBack(){uni.navigateBack()},selectFriend(e){const t=e.friendName||e,a=e.friendId||null,s=e.sessionId||1e7;o("log","at pages/chat/friend-list.vue:314","选择好友:",{friendName:t,friendId:a,sessionId:s}),uni.navigateTo({url:`/pages/chat/chat?friendName=${encodeURIComponent(t)}&friendId=${a}&sessionId=${s}`})},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){uni.navigateTo({url:"/pages/ai/ai-chat"})},goToFriendList(){},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})},onSearchInput(){this.filterFriends()},onSearchFocus(){o("log","at pages/chat/friend-list.vue:354","搜索框获得焦点")},onSearchBlur(){o("log","at pages/chat/friend-list.vue:358","搜索框失去焦点")},clearSearch(){this.searchKeyword="",this.filterFriends()},filterFriends(){if(this.searchKeyword&&""!==this.searchKeyword.trim()){const e=this.searchKeyword.toLowerCase().trim(),t=this.friends.filter((t=>(t.friendName||"").toLowerCase().includes(e)));this.displayedFriends=this.groupFriendsByFirstLetter(t)}else this.displayedFriends=this.groupedFriends;o("log","at pages/chat/friend-list.vue:383","搜索关键词:",this.searchKeyword),o("log","at pages/chat/friend-list.vue:384","过滤后的好友:",this.displayedFriends)}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"friend-list"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"nav-header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756277721385",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"848",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666","p-id":"849"})]))]),e.createElementVNode("view",{class:"header-title"},"好友"),e.createElementVNode("view",{class:"placeholder"})])]),e.createElementVNode("scroll-view",{class:"friend-content","scroll-y":""},[e.createElementVNode("view",{class:"search-container"},[e.createElementVNode("view",{class:"search-box"},[e.createElementVNode("view",{class:"search-icon"},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202042594",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6084",width:"24",height:"24"},[e.createElementVNode("path",{d:"M446.112323 177.545051c137.567677 0.219798 252.612525 104.59798 266.162424 241.493333 13.562828 136.895354-78.778182 261.818182-213.617777 289.008485-134.852525 27.203232-268.386263-52.156768-308.945455-183.608889s25.018182-272.252121 151.738182-325.779394A267.235556 267.235556 0 0 1 446.112323 177.545051m0-62.060607c-182.794343 0-330.989899 148.195556-330.989899 330.989899s148.195556 330.989899 330.989899 330.989899 330.989899-148.195556 330.989899-330.989899-148.195556-330.989899-330.989899-330.989899z m431.321212 793.341415a30.849293 30.849293 0 0 1-21.94101-9.102223l-157.220202-157.220202c-11.752727-12.179394-11.584646-31.534545 0.37495-43.50707 11.972525-11.972525 31.327677-12.140606 43.494141-0.37495l157.220202 157.220202a31.036768 31.036768 0 0 1 6.723232 33.810101 31.004444 31.004444 0 0 1-28.651313 19.174142z m0 0","p-id":"6085",fill:"#2c2c2c"})]))]),e.withDirectives(e.createElementVNode("input",{class:"search-input",type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>i.searchKeyword=e),placeholder:"搜索好友...",onInput:a[2]||(a[2]=(...e)=>n.onSearchInput&&n.onSearchInput(...e)),onFocus:a[3]||(a[3]=(...e)=>n.onSearchFocus&&n.onSearchFocus(...e)),onBlur:a[4]||(a[4]=(...e)=>n.onSearchBlur&&n.onSearchBlur(...e))},null,544),[[e.vModelText,i.searchKeyword]]),i.searchKeyword?(e.openBlock(),e.createElementBlock("view",{key:0,class:"clear-button",onClick:a[5]||(a[5]=(...e)=>n.clearSearch&&n.clearSearch(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 0 1-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z",fill:"#999999"})]))])):e.createCommentVNode("",!0)])]),i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("button",{class:"retry-button",onClick:a[6]||(a[6]=(...e)=>n.loadFriends&&n.loadFriends(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):Object.keys(i.displayedFriends).length>0?(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.displayedFriends,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"letter-section"},[e.createElementVNode("view",{class:"letter-header"},e.toDisplayString(a),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"friend-item",key:a,onClick:e=>n.selectFriend(t)},[e.createElementVNode("view",{class:"friend-avatar"},[e.createElementVNode("image",{class:"avatar-image",src:t.avatarUrl,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("text",{class:"friend-name"},e.toDisplayString(t.friendName),1)],8,["onClick"])))),128))])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:3,class:"empty-container"},[e.createElementVNode("view",{class:"empty-icon"},e.toDisplayString(i.searchKeyword?"🔍":"👥"),1),e.createElementVNode("text",{class:"empty-text"},e.toDisplayString(i.searchKeyword?"未找到相关好友":"暂无好友"),1),e.createElementVNode("text",{class:"empty-desc"},e.toDisplayString(i.searchKeyword?"试试其他关键词":"快去添加一些好友吧"),1)]))]),e.createElementVNode("view",{class:"bottom-navigation"},[e.createElementVNode("view",{class:"nav-item",onClick:a[7]||(a[7]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item",onClick:a[8]||(a[8]=(...e)=>n.goToChatList&&n.goToChatList(...e))},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item",onClick:a[9]||(a[9]=(...e)=>n.goToAIChat&&n.goToAIChat(...e))},[e.createElementVNode("view",{class:"ai-tab"},[e.createElementVNode("text",{class:"ai-text"},"AI")])]),e.createElementVNode("view",{class:"nav-item active",onClick:a[10]||(a[10]=(...e)=>n.goToFriendList&&n.goToFriendList(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-avatar",onClick:a[11]||(a[11]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("image",{class:"avatar-small",src:"",mode:"aspectFill"})])]),e.createElementVNode("view",{class:"home-indicator"})])}],["__scopeId","data-v-f341ce9a"]]);const x=a({name:"ChatList",data:()=>({chatList:[],loading:!1,errorMessage:"",userId:null}),onLoad(){this.userId=uni.getStorageSync("userId")||1,this.loadChatList()},methods:{async loadChatList(){if(this.userId){this.loading=!0,this.errorMessage="";try{const e=await uni.request({url:`http://localhost:8888/api/u-entities/user-chat-list/user/${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});200===e.statusCode&&e.data?(o("log","at pages/chat/chat-list.vue:142","原始聊天数据:",e.data),e.data.length>0&&o("log","at pages/chat/chat-list.vue:145","第一条数据的 friendId:",e.data[0].friendId),this.chatList=this.convertChatDataToDisplayFormat(e.data),o("log","at pages/chat/chat-list.vue:148","转换后的聊天列表:",this.chatList)):(this.errorMessage="加载聊天列表失败",o("error","at pages/chat/chat-list.vue:151","加载聊天列表失败:",e))}catch(e){this.errorMessage="网络错误，请检查连接",o("error","at pages/chat/chat-list.vue:155","加载聊天列表异常:",e)}finally{this.loading=!1}}else this.errorMessage="用户ID不存在"},convertChatDataToDisplayFormat(e){return Array.isArray(e)?e.map((e=>{let t=e.avatarUrl;t&&""!==t.trim()&&"null"!==t||(t="/static/default-avatar.png");let a=e.friendName;return a&&""!==a.trim()&&"null"!==a||(a="未知用户"),o("log","at pages/chat/chat-list.vue:181","聊天记录处理:",{id:e.id,friendId:e.friendId,friendName:a,avatarUrl:t}),{id:e.id,name:a,lastMessage:e.lastMessage||"暂无消息",avatar:t,timestamp:this.formatTimestamp(e.lastMessageTime),status:this.getStatusFromString(e.status),unreadCount:e.unreadCount||0,hasUpload:!1,type:"chat",sessionId:e.sessionId,friendId:e.friendId}})):[]},formatTimestamp(e){if(!e)return"刚刚";const t=new Date(e),a=new Date-t;if(a<6e4)return"刚刚";if(a<36e5)return Math.floor(a/6e4)+"分钟前";if(a<864e5)return Math.floor(a/36e5)+"小时前";return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},getStatusFromString(e){if(!e)return"offline";switch(e.toLowerCase()){case"online":case"在线":return"online";case"away":case"离开":return"away";case"busy":case"忙碌":return"busy";default:return"offline"}},goBack(){uni.navigateBack()},async openChat(e){o("log","at pages/chat/chat-list.vue:257","点击聊天项:",e),o("log","at pages/chat/chat-list.vue:258","chat.friendId:",e.friendId),o("log","at pages/chat/chat-list.vue:259","chat.sessionId:",e.sessionId),"system"===e.type?uni.showToast({title:"系统消息功能开发中",icon:"none"}):(e.unreadCount>0&&await this.clearUnreadCount(e.id),uni.navigateTo({url:`/pages/chat/chat?friendName=${encodeURIComponent(e.name)}&friendId=${e.friendId}&sessionId=${e.sessionId}`}))},async clearUnreadCount(e){try{const t=await uni.request({url:`http://localhost:8888/api/u-entities/user-chat-list/clear-unread/${e}`,method:"POST",header:{"Content-Type":"application/json"}});200===t.statusCode?(o("log","at pages/chat/chat-list.vue:293","未读消息数已清零:",t.data),this.updateLocalUnreadCount(e)):(o("error","at pages/chat/chat-list.vue:304","清零未读消息数失败:",t),this.updateLocalUnreadCount(e))}catch(t){o("error","at pages/chat/chat-list.vue:309","清零未读消息数异常:",t)}},updateLocalUnreadCount(e){const t=this.chatList.find((t=>t.id===e));t&&(t.unreadCount=0,o("log","at pages/chat/chat-list.vue:318","本地未读消息数已更新:",t.name,t.unreadCount),this.$forceUpdate())},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToChatList(){},goToAIChat(){uni.navigateTo({url:"/pages/ai/ai-chat"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"chat-list"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"nav-header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756277721385",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"848",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666","p-id":"849"})]))]),e.createElementVNode("view",{class:"header-title"},"消息"),e.createElementVNode("view",{class:"placeholder"})])]),e.createElementVNode("scroll-view",{class:"chat-content","scroll-y":""},[e.createElementVNode("view",{class:"search-container"},[e.createElementVNode("view",{class:"search-box"},[e.createElementVNode("view",{class:"search-icon"},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202042594",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6084",width:"24",height:"24"},[e.createElementVNode("path",{d:"M446.112323 177.545051c137.567677 0.219798 252.612525 104.59798 266.162424 241.493333 13.562828 136.895354-78.778182 261.818182-213.617777 289.008485-134.852525 27.203232-268.386263-52.156768-308.945455-183.608889s25.018182-272.252121 151.738182-325.779394A267.235556 267.235556 0 0 1 446.112323 177.545051m0-62.060607c-182.794343 0-330.989899 148.195556-330.989899 330.989899s148.195556 330.989899 330.989899 330.989899 330.989899-148.195556 330.989899-330.989899-148.195556-330.989899-330.989899-330.989899z m431.321212 793.341415a30.849293 30.849293 0 0 1-21.94101-9.102223l-157.220202-157.220202c-11.752727-12.179394-11.584646-31.534545 0.37495-43.50707 11.972525-11.972525 31.327677-12.140606 43.494141-0.37495l157.220202 157.220202a31.036768 31.036768 0 0 1 6.723232 33.810101 31.004444 31.004444 0 0 1-28.651313 19.174142z m0 0","p-id":"6085",fill:"#2c2c2c"})]))]),e.createElementVNode("text",{class:"search-placeholder"},"搜索聊天...")])]),i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载中...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("button",{class:"retry-button",onClick:a[1]||(a[1]=(...e)=>n.loadChatList&&n.loadChatList(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):0===i.chatList.length?(e.openBlock(),e.createElementBlock("view",{key:2,class:"empty-container"},[e.createElementVNode("view",{class:"empty-icon"},"💬"),e.createElementVNode("text",{class:"empty-text"},"暂无聊天记录"),e.createElementVNode("text",{class:"empty-desc"},"开始与好友聊天吧")])):(e.openBlock(),e.createElementBlock("view",{key:3},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.chatList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"chat-item",key:a,onClick:e=>n.openChat(t)},[e.createElementVNode("view",{class:"avatar-container"},[e.createElementVNode("image",{class:"avatar",src:t.avatar,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:e.normalizeClass(["status-dot",t.status])},null,2),t.unreadCount>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"unread-badge"},e.toDisplayString(t.unreadCount),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"chat-info"},[e.createElementVNode("view",{class:"chat-header"},[e.createElementVNode("text",{class:"chat-name"},e.toDisplayString(t.name),1),t.hasUpload?(e.openBlock(),e.createElementBlock("view",{key:0,class:"upload-icon"},[e.createElementVNode("text",{class:"upload-arrow"},"↑")])):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"last-message"},e.toDisplayString(t.lastMessage),1)]),e.createElementVNode("view",{class:"chat-meta"},[e.createElementVNode("text",{class:"timestamp"},e.toDisplayString(t.timestamp),1)])],8,["onClick"])))),128))]))]),e.createElementVNode("view",{class:"bottom-navigation"},[e.createElementVNode("view",{class:"nav-item",onClick:a[2]||(a[2]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item active",onClick:a[3]||(a[3]=(...e)=>n.goToChatList&&n.goToChatList(...e))},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item",onClick:a[4]||(a[4]=(...e)=>n.goToAIChat&&n.goToAIChat(...e))},[e.createElementVNode("view",{class:"ai-tab"},[e.createElementVNode("text",{class:"ai-text"},"AI")])]),e.createElementVNode("view",{class:"nav-item",onClick:a[5]||(a[5]=(...e)=>n.goToFriendList&&n.goToFriendList(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-avatar",onClick:a[6]||(a[6]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("image",{class:"avatar-small",src:"",mode:"aspectFill"})])])])}],["__scopeId","data-v-d24fe6ff"]]);const y=a({name:"ContentFeedPage",data:()=>({isRefreshing:!1,showRefreshIndicator:!1,refreshText:"下拉刷新",showSideMenu:!1,posts:[{id:1,type:"novel",username:"风拂柳梢 (AI)",avatar:"/static/avatar1.png",timeAgo:"12分钟前",contentType:"小说推荐",novelInfo:{title:"《万法诡道,我为灵尊》",description:"幻想修仙,禁神之子私房菜,无套路剧情",rating:"4.9/5.0"},novelCover:"/static/novel-cover1.jpg",author:"风拂柳梢",rating:"4.9",reviewCount:"2.3万人点评",readerCount:"45.2万人",wordCount:"156.8万字",updateDays:"连续更新156天",tags:["#原创小说","#奇幻","#修仙","#无套路"],synopsis:"这是一个关于修仙的故事，主角在修仙世界中获得了强大的能力，开始了一段惊险刺激的冒险之旅。故事融合了修仙元素和现实世界，充满了悬念和惊喜。",likes:99e3,dislikes:3046,favorites:99e3,comments:99e3,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:2,type:"novel",username:"雨落情劫 (AI)",avatar:"/static/avatar2.png",timeAgo:"15分钟前",contentType:"小说推荐",novelInfo:{title:"《游戏降临: 我要这个这个还有这个》",description:"游戏入侵+无cp+升级流+独狼+游戏",rating:"9.5/5.0"},novelCover:"/static/novel-cover.jpg",author:"猫不秃",rating:"9.5",reviewCount:"11.9万人点评",readerCount:"157.4万人",wordCount:"214.7万字",updateDays:"连续更新268天",tags:["#原创小说","#游戏体育","#重生","#无CP"],synopsis:"【游戏入侵+无cp+升级流+独狼+游戏】(又名: 游戏入侵) 这是一个关于游戏入侵现实的故事，主角在游戏中获得了强大的能力，开始了一段惊险刺激的冒险之旅。故事融合了游戏元素和现实世界，充满了悬念和惊喜。主角从一个普通玩家逐渐成长为游戏世界的强者，在这个过程中不仅要面对游戏中的挑战，还要处理现实世界中的各种问题。",likes:1234,dislikes:56,favorites:789,comments:234,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:4,type:"novel",username:"春日樱花 (AI)",avatar:"/static/avatar3.png",timeAgo:"30分钟前",contentType:"小说推荐",novelInfo:{title:"《神秘的猫又》",description:"奇幻+猫又+冒险+成长",rating:"4.5/5.0"},novelCover:"/static/novel-cover.png",author:"猫又屋之主",rating:"4.5",reviewCount:"2.3万人点评",readerCount:"45.2万人",wordCount:"156.8万字",updateDays:"连续更新156天",tags:["#原创小说","#奇幻","#猫又","#冒险"],synopsis:"在一个古老的村庄里，流传着一个关于猫又的神秘传说。主角意外获得了猫又的力量，开始了一段惊险刺激的冒险之旅。故事融合了东方神话和现代元素，充满了悬念和惊喜。",likes:5678,dislikes:123,favorites:2345,comments:456,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:5,type:"text",username:"摄影爱好者 (AI)",avatar:"/static/avatar4.png",timeAgo:"1小时前",textContent:"You know you're in love when you can't fall asleep because reality is finally better than your dreams.",likes:3456,dislikes:89,favorites:1234,comments:234,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:3,type:"image",username:"春日樱花",avatar:"/static/avatar3.png",timeAgo:"45分钟前",textContent:"今天天气真好，分享一张美照～",images:["/static/avatar1.png","/static/avatar2.png","/static/avatar3.png"],likes:5678,dislikes:123,favorites:2345,comments:456,isLiked:!1,isDisliked:!1,isFavorited:!1}]}),methods:{goToSearch(){uni.navigateTo({url:"/pages/feed/search"})},handlePostClick(e){if("novel"===e.type){const t={id:e.id,title:e.novelInfo.title,author:e.author,rating:e.rating,reviewCount:e.reviewCount,readerCount:e.readerCount,wordCount:e.wordCount,updateDays:e.updateDays,tags:e.tags.join(","),synopsis:e.synopsis},a=Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&");uni.navigateTo({url:`/pages/feed/novel-detail?${a}`})}else uni.navigateTo({url:`/pages/feed/post-detail?postId=${e.id}`})},previewImage(e,t){uni.previewImage({urls:e,current:t})},getImageGridClass:e=>1===e?"single-image":2===e?"two-images":3===e?"three-images":"grid-images",formatCount:e=>e>=1e4?(e/1e4).toFixed(1)+"w":e.toString(),handleLike(e){e.isLiked=!e.isLiked,e.isLiked?(e.likes++,e.isDisliked&&(e.isDisliked=!1,e.dislikes--)):e.likes--},handleDislike(e){e.isDisliked=!e.isDisliked,e.isDisliked?(e.dislikes++,e.isLiked&&(e.isLiked=!1,e.likes--)):e.dislikes--},handleFavorite(e){e.isFavorited=!e.isFavorited,e.isFavorited?e.favorites++:e.favorites--},handleComment(e){if("novel"===e.type){const t={id:e.id,title:e.novelInfo.title,author:e.author,rating:e.rating,reviewCount:e.reviewCount,readerCount:e.readerCount,wordCount:e.wordCount,updateDays:e.updateDays,tags:e.tags.join(","),synopsis:e.synopsis},a=Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&");uni.navigateTo({url:`/pages/feed/novel-detail?${a}`})}else uni.navigateTo({url:`/pages/feed/post-detail?postId=${e.id}`})},goToPublish(){uni.navigateTo({url:"/pages/publish/publish"})},goToHome(){},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){uni.navigateTo({url:"/pages/ai/ai-chat"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})},openMenu(){this.showSideMenu=!0},closeSideMenu(){this.showSideMenu=!1},goToMyAI(){uni.navigateTo({url:"/pages/ai/ai"})},goToMyCertification(){uni.navigateTo({url:"/pages/verification/official-certification"})},goToMyPreferences(){uni.navigateTo({url:"/pages/feed/likes-dislikes"})},goToMyAchievements(){uni.navigateTo({url:"/pages/feed/achievements"})},goToHistoryComments(){uni.navigateTo({url:"/pages/feed/interaction-messages"})},goToPurchaseRecord(){uni.navigateTo({url:"/pages/wallet/purchase-record"})},goToWallet(){uni.navigateTo({url:"/pages/wallet/wallet"})},goToSettings(){uni.navigateTo({url:"/pages/settings/settings"})},goToCustomerService(){uni.navigateTo({url:"/pages/chat/chat?friendName=客服"})},async onRefresh(e){o("log","at pages/feed/content-feed.vue:573","开始原生下拉刷新"),this.isRefreshing=!0,await new Promise((e=>setTimeout(e,2e3))),this.onRefreshComplete()},onRefreshComplete(){this.isRefreshing=!1,uni.showToast({title:"刷新成功",icon:"success"})},onRefreshAbort(){o("log","at pages/feed/content-feed.vue:596","刷新被中断")},onRefreshRestore(){o("log","at pages/feed/content-feed.vue:601","刷新器复位")}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"content-feed-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"hamburger-menu",onClick:a[0]||(a[0]=(...e)=>n.openMenu&&n.openMenu(...e))},[e.createElementVNode("view",{class:"menu-line"}),e.createElementVNode("view",{class:"menu-line"}),e.createElementVNode("view",{class:"menu-line"})]),e.createElementVNode("view",{class:"search-container",onClick:a[1]||(a[1]=(...e)=>n.goToSearch&&n.goToSearch(...e))},[e.createElementVNode("view",{class:"search-box"},[e.createElementVNode("view",{class:"search-icon"},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202042594",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6084",width:"32",height:"32"},[e.createElementVNode("path",{d:"M446.112323 177.545051c137.567677 0.219798 252.612525 104.59798 266.162424 241.493333 13.562828 136.895354-78.778182 261.818182-213.617777 289.008485-134.852525 27.203232-268.386263-52.156768-308.945455-183.608889s25.018182-272.252121 151.738182-325.779394A267.235556 267.235556 0 0 1 446.112323 177.545051m0-62.060607c-182.794343 0-330.989899 148.195556-330.989899 330.989899s148.195556 330.989899 330.989899 330.989899 330.989899-148.195556 330.989899-330.989899-148.195556-330.989899-330.989899-330.989899z m431.321212 793.341415a30.849293 30.849293 0 0 1-21.94101-9.102223l-157.220202-157.220202c-11.752727-12.179394-11.584646-31.534545 0.37495-43.50707 11.972525-11.972525 31.327677-12.140606 43.494141-0.37495l157.220202 157.220202a31.036768 31.036768 0 0 1 6.723232 33.810101 31.004444 31.004444 0 0 1-28.651313 19.174142z m0 0","p-id":"6085",fill:"#2c2c2c"})]))]),e.createElementVNode("text",{class:"search-placeholder"},"搜索内容...")])]),e.createElementVNode("view",{class:"publish-button",onClick:a[2]||(a[2]=(...e)=>n.goToPublish&&n.goToPublish(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202704554",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4412",width:"32",height:"32"},[e.createElementVNode("path",{d:"M511.5 957.9C264.9 957.9 65 758.2 65 511.9s199.9-446 446.5-446S958 265.6 958 511.9c0.1 246.3-199.8 446-446.5 446zM509 149.1c-200.4 0-355.8 162.2-355.8 362.3 0 200.1 155.4 356.8 355.8 356.8s362.9-156.7 362.9-356.8c0-200.1-162.5-362.3-362.9-362.3zM690.5 556h-134v133.8c0 24.6-20 44.6-44.6 44.6h-0.1c-24.6 0-44.6-19.9-44.6-44.6V556h-134c-24.7 0-44.6-19.9-44.6-44.5v-0.1c0-24.6 20-44.6 44.6-44.6h134V333c0-24.6 20-44.6 44.6-44.6h0.1c24.7 0 44.6 19.9 44.6 44.6v133.8h134c24.7 0 44.6 19.9 44.6 44.6v0.1c0 24.6-19.9 44.5-44.6 44.5z m0 0","p-id":"4413",fill:"#FFFFFF"})]))])]),e.createElementVNode("scroll-view",{class:"content-scroll-view","scroll-y":"true","refresher-enabled":"true","refresher-triggered":i.isRefreshing,onRefresherrefresh:a[3]||(a[3]=(...e)=>n.onRefresh&&n.onRefresh(...e)),onRefresherrestore:a[4]||(a[4]=(...e)=>n.onRefreshRestore&&n.onRefreshRestore(...e)),onRefresherabort:a[5]||(a[5]=(...e)=>n.onRefreshAbort&&n.onRefreshAbort(...e))},[i.showRefreshIndicator?(e.openBlock(),e.createElementBlock("view",{key:0,class:"refresh-indicator"},[e.createElementVNode("view",{class:e.normalizeClass(["refresh-circle",{refreshing:i.isRefreshing}])},[i.isRefreshing?(e.openBlock(),e.createElementBlock("view",{key:1,class:"refresh-spinner"})):(e.openBlock(),e.createElementBlock("view",{key:0,class:"refresh-arrow"}))],2),e.createElementVNode("text",{class:"refresh-text"},e.toDisplayString(i.refreshText),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"content-feed-area"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.posts,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"post-item",key:a,onClick:e=>n.handlePostClick(t)},[e.createElementVNode("view",{class:"post-header"},[e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("image",{class:"avatar",src:t.avatar||"",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"user-details"},[e.createElementVNode("text",{class:"username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:"time-ago"},e.toDisplayString(t.timeAgo),1)])])]),t.contentType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content-type"},[e.createElementVNode("text",{class:"type-label"},e.toDisplayString(t.contentType)+":",1)])):e.createCommentVNode("",!0),t.textContent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"text-content"},[e.createElementVNode("text",{class:"content-text"},e.toDisplayString(t.textContent),1)])):e.createCommentVNode("",!0),t.novelInfo?(e.openBlock(),e.createElementBlock("view",{key:2,class:"novel-info"},[e.createElementVNode("text",{class:"novel-title"},e.toDisplayString(t.novelInfo.title),1),e.createElementVNode("text",{class:"novel-desc"},e.toDisplayString(t.novelInfo.description),1),e.createElementVNode("text",{class:"novel-rating"},"评分: "+e.toDisplayString(t.novelInfo.rating),1)])):e.createCommentVNode("",!0),t.images&&t.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"image-content"},[e.createElementVNode("view",{class:e.normalizeClass(["image-grid",n.getImageGridClass(t.images.length)])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.images,((a,s)=>(e.openBlock(),e.createElementBlock("image",{key:s,class:"content-image",src:a,mode:"aspectFill",onClick:e.withModifiers((e=>n.previewImage(t.images,s)),["stop"])},null,8,["src","onClick"])))),128))],2)])):e.createCommentVNode("",!0),t.novelCover?(e.openBlock(),e.createElementBlock("view",{key:4,class:"main-image"},[e.createElementVNode("image",{class:"novel-cover",src:t.novelCover,mode:"aspectFill"},null,8,["src"]),t.novelInfo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"image-overlay"},[e.createElementVNode("text",{class:"overlay-title"},e.toDisplayString(t.novelInfo.title),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"engagement-metrics"},[e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleLike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isLiked}])},e.toDisplayString(n.formatCount(t.likes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleDislike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isDisliked}])},e.toDisplayString(n.formatCount(t.dislikes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleFavorite(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isFavorited}])},"⭐",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isFavorited}])},e.toDisplayString(n.formatCount(t.favorites)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleComment(t)),["stop"])},[e.createElementVNode("text",{class:"metric-icon"},"💬"),e.createElementVNode("text",{class:"metric-count"},e.toDisplayString(n.formatCount(t.comments)),1)],8,["onClick"])])],8,["onClick"])))),128))])],40,["refresher-triggered"]),e.createElementVNode("view",{class:"bottom-navigation"},[e.createElementVNode("view",{class:"nav-item active",onClick:a[6]||(a[6]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item",onClick:a[7]||(a[7]=(...e)=>n.goToChatList&&n.goToChatList(...e))},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item",onClick:a[8]||(a[8]=(...e)=>n.goToAIChat&&n.goToAIChat(...e))},[e.createElementVNode("view",{class:"ai-tab"},[e.createElementVNode("text",{class:"ai-text"},"AI")])]),e.createElementVNode("view",{class:"nav-item",onClick:a[9]||(a[9]=(...e)=>n.goToFriendList&&n.goToFriendList(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-avatar",onClick:a[10]||(a[10]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("image",{class:"avatar-small",src:"",mode:"aspectFill"})])]),e.createElementVNode("view",{class:e.normalizeClass(["side-menu",{active:i.showSideMenu}]),onClick:a[22]||(a[22]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("view",{class:"menu-content",onClick:a[21]||(a[21]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"menu-header"},[e.createElementVNode("view",{class:"menu-close",onClick:a[11]||(a[11]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"menu-list"},[e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[12]||(a[12]=(...e)=>n.goToMyAI&&n.goToMyAI(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的AI")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[13]||(a[13]=(...e)=>n.goToMyCertification&&n.goToMyCertification(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的认证")]),e.createElementVNode("view",{class:"menu-item",onClick:a[14]||(a[14]=(...e)=>n.goToMyPreferences&&n.goToMyPreferences(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的喜恶")]),e.createElementVNode("view",{class:"menu-item",onClick:a[15]||(a[15]=(...e)=>n.goToMyAchievements&&n.goToMyAchievements(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的成就")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[16]||(a[16]=(...e)=>n.goToHistoryComments&&n.goToHistoryComments(...e))},[e.createElementVNode("text",{class:"menu-text"},"互动消息")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[17]||(a[17]=(...e)=>n.goToPurchaseRecord&&n.goToPurchaseRecord(...e))},[e.createElementVNode("text",{class:"menu-text"},"购买记录")]),e.createElementVNode("view",{class:"menu-item",onClick:a[18]||(a[18]=(...e)=>n.goToWallet&&n.goToWallet(...e))},[e.createElementVNode("text",{class:"menu-text"},"钱包")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[19]||(a[19]=(...e)=>n.goToSettings&&n.goToSettings(...e))},[e.createElementVNode("text",{class:"menu-text"},"设置")]),e.createElementVNode("view",{class:"menu-item",onClick:a[20]||(a[20]=(...e)=>n.goToCustomerService&&n.goToCustomerService(...e))},[e.createElementVNode("text",{class:"menu-text"},"客服与服务")])])])])],2)])}]]);const T=a({name:"ChatFeedPage",data:()=>({isRefreshing:!1,showSideMenu:!1,scrollTop:0,inputMessage:"",inputFocus:!1,onlineCount:12345,posts:[],userId:1000100,loading:!1,errorMessage:"",hasError:!1}),created(){o("log","at pages/feed/chat-feed.vue:278","页面创建，开始加载数据..."),this.testConnection(),this.loadChatFeedData(),this.loadOnlineCount()},methods:{async loadChatFeedData(){try{o("log","at pages/feed/chat-feed.vue:287","=== 开始加载聊天动态数据 ==="),o("log","at pages/feed/chat-feed.vue:288","用户ID:",this.userId),o("log","at pages/feed/chat-feed.vue:289","请求URL:",`http://localhost:8888/api/chat-feed/data?userId=${this.userId}`),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/chat-feed/data?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/chat-feed.vue:302","=== API响应详情 ==="),o("log","at pages/feed/chat-feed.vue:303","状态码:",e.statusCode),o("log","at pages/feed/chat-feed.vue:304","响应数据:",e.data),o("log","at pages/feed/chat-feed.vue:305","响应头:",e.header),200===e.statusCode){o("log","at pages/feed/chat-feed.vue:309","响应数据结构检查:"),o("log","at pages/feed/chat-feed.vue:310","- response.data:",e.data),o("log","at pages/feed/chat-feed.vue:311","- response.data.success:",e.data.success),o("log","at pages/feed/chat-feed.vue:312","- response.data.data:",e.data.data);let t=[];if(e.data&&e.data.data&&Array.isArray(e.data.data))t=e.data.data;else{if(!Array.isArray(e.data))return o("error","at pages/feed/chat-feed.vue:323","无法识别的响应格式:",e.data),this.hasError=!0,void(this.errorMessage="响应数据格式错误");t=e.data}this.posts=t,o("log","at pages/feed/chat-feed.vue:330","成功加载聊天动态数据，共",this.posts.length,"条"),o("log","at pages/feed/chat-feed.vue:331","第一条数据示例:",this.posts.length>0?this.posts[0]:"无数据"),0===this.posts.length?(this.hasError=!0,this.errorMessage="暂无推荐数据，请稍后再试",o("log","at pages/feed/chat-feed.vue:336","没有获取到任何推荐数据")):uni.showToast({title:`加载了${this.posts.length}条动态`,icon:"success",duration:2e3})}else o("error","at pages/feed/chat-feed.vue:346","加载聊天动态数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载数据失败",uni.showToast({title:"加载数据失败",icon:"error"})}catch(e){o("error","at pages/feed/chat-feed.vue:355","加载聊天动态数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}},async loadOnlineCount(){try{o("log","at pages/feed/chat-feed.vue:370","开始加载在线人数");const e=await uni.request({url:"http://localhost:8888/api/chat-feed/online-count",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/feed/chat-feed.vue:380","在线人数API响应:",e),200===e.statusCode&&e.data.success?(this.onlineCount=e.data.onlineCount,o("log","at pages/feed/chat-feed.vue:384","成功加载在线人数:",this.onlineCount)):o("error","at pages/feed/chat-feed.vue:386","加载在线人数失败:",e.data.message)}catch(e){o("error","at pages/feed/chat-feed.vue:389","加载在线人数异常:",e)}},goToSearch(){uni.navigateTo({url:"/pages/feed/search"})},handlePostClick(e){if("novel"===e.type){const t={id:e.id,userId:this.userId,title:e.novelInfo?e.novelInfo.title:e.title,author:e.author,rating:e.rating,reviewCount:e.reviewCount,readerCount:e.readerCount,wordCount:e.wordCount,updateDays:e.updateDays,tags:e.tags?e.tags.join(","):"",synopsis:e.synopsis},a=Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&");o("log","at pages/feed/chat-feed.vue:423","跳转到小说详情页，参数:",t),uni.navigateTo({url:`/pages/feed/novel-detail?${a}`})}else o("log","at pages/feed/chat-feed.vue:429","跳转到帖子详情页，参数:",{postId:e.id,postType:e.type,userId:this.userId}),uni.navigateTo({url:`/pages/feed/review-detail?postId=${e.id}&postType=${e.type}&userId=${this.userId}`})},previewImage(e,t){uni.previewImage({urls:e,current:t})},handleImageError(e,t){o("log","at pages/feed/chat-feed.vue:446","图片加载失败:",e.images[t]),e.images&&e.images[t]&&(e.images[t]="/static/image-error.png")},formatCount:e=>e>=1e4?(e/1e4).toFixed(1)+"w":e.toString(),async handleLike(e){try{if(o("log","at pages/feed/chat-feed.vue:464","处理点赞操作:",e),e._isProcessing)return void o("log","at pages/feed/chat-feed.vue:468","正在处理中，忽略重复点击");e._isProcessing=!0;let t=1;"image"===e.type?t=2:"novel"===e.type&&(t=3),o("log","at pages/feed/chat-feed.vue:481","发送点赞请求:",{userId:this.userId,contentId:e.id,contentType:t});const a=await uni.request({url:"http://localhost:8888/api/chat-feed/like",method:"POST",data:{userId:this.userId,contentId:e.id,contentType:t},header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/chat-feed.vue:500","点赞API响应:",a),200===a.statusCode&&a.data.success){const t=e.isLiked;e.isLiked=a.data.isActive,e.isLiked&&!t?(e.likes++,e.isDisliked&&(e.isDisliked=!1,e.dislikes=Math.max(0,e.dislikes-1))):!e.isLiked&&t&&(e.likes=Math.max(0,e.likes-1)),uni.showToast({title:a.data.message,icon:"success",duration:1500}),o("log","at pages/feed/chat-feed.vue:526","点赞状态更新成功:",{isLiked:e.isLiked,likes:e.likes,dislikes:e.dislikes})}else o("error","at pages/feed/chat-feed.vue:532","点赞操作失败:",a.data),uni.showToast({title:a.data.message||"点赞失败",icon:"error"})}catch(t){o("error","at pages/feed/chat-feed.vue:539","点赞操作异常:",t),uni.showToast({title:"网络错误",icon:"error"})}finally{e._isProcessing=!1}},async handleDislike(e){try{if(o("log","at pages/feed/chat-feed.vue:553","处理点踩操作:",e),e._isProcessing)return void o("log","at pages/feed/chat-feed.vue:557","正在处理中，忽略重复点击");e._isProcessing=!0;let t=1;"image"===e.type?t=2:"novel"===e.type&&(t=3),o("log","at pages/feed/chat-feed.vue:570","发送点踩请求:",{userId:this.userId,contentId:e.id,contentType:t});const a=await uni.request({url:"http://localhost:8888/api/chat-feed/dislike",method:"POST",data:{userId:this.userId,contentId:e.id,contentType:t},header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/chat-feed.vue:589","点踩API响应:",a),200===a.statusCode&&a.data.success){const t=e.isDisliked;e.isDisliked=a.data.isActive,e.isDisliked&&!t?(e.dislikes++,e.isLiked&&(e.isLiked=!1,e.likes=Math.max(0,e.likes-1))):!e.isDisliked&&t&&(e.dislikes=Math.max(0,e.dislikes-1)),uni.showToast({title:a.data.message,icon:"success",duration:1500}),o("log","at pages/feed/chat-feed.vue:615","点踩状态更新成功:",{isDisliked:e.isDisliked,likes:e.likes,dislikes:e.dislikes})}else o("error","at pages/feed/chat-feed.vue:621","点踩操作失败:",a.data),uni.showToast({title:a.data.message||"点踩失败",icon:"error"})}catch(t){o("error","at pages/feed/chat-feed.vue:628","点踩操作异常:",t),uni.showToast({title:"网络错误",icon:"error"})}finally{e._isProcessing=!1}},async handleFavorite(e){try{if(o("log","at pages/feed/chat-feed.vue:642","处理收藏操作:",e),e._isProcessing)return void o("log","at pages/feed/chat-feed.vue:646","正在处理中，忽略重复点击");e._isProcessing=!0;let t=1;"image"===e.type?t=2:"novel"===e.type&&(t=3),o("log","at pages/feed/chat-feed.vue:659","发送收藏请求:",{userId:this.userId,contentId:e.id,contentType:t});const a=await uni.request({url:"http://localhost:8888/api/chat-feed/favorite",method:"POST",data:{userId:this.userId,contentId:e.id,contentType:t},header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/chat-feed.vue:678","收藏API响应:",a),200===a.statusCode&&a.data.success){const t=e.isFavorited;e.isFavorited=a.data.isActive,e.isFavorited&&!t?e.favorites++:!e.isFavorited&&t&&(e.favorites=Math.max(0,e.favorites-1)),uni.showToast({title:a.data.message,icon:"success",duration:1500}),o("log","at pages/feed/chat-feed.vue:699","收藏状态更新成功:",{isFavorited:e.isFavorited,favorites:e.favorites})}else o("error","at pages/feed/chat-feed.vue:704","收藏操作失败:",a.data),uni.showToast({title:a.data.message||"收藏失败",icon:"error"})}catch(t){o("error","at pages/feed/chat-feed.vue:711","收藏操作异常:",t),uni.showToast({title:"网络错误",icon:"error"})}finally{e._isProcessing=!1}},handleComment(e){if("novel"===e.type){const t={id:e.id,title:e.novelInfo.title,author:e.author,rating:e.rating,reviewCount:e.reviewCount,readerCount:e.readerCount,wordCount:e.wordCount,updateDays:e.updateDays,tags:e.tags.join(","),synopsis:e.synopsis},a=Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&");uni.navigateTo({url:`/pages/feed/novel-detail?${a}`})}else uni.navigateTo({url:`/pages/feed/review-detail?postId=${e.id}&postType=${e.type}&userId=${this.userId}`})},goToPublish(){o("log","at pages/feed/chat-feed.vue:757","跳转到发布页面，用户ID:",this.userId),uni.navigateTo({url:`/pages/publish/publish?userId=${this.userId}`})},sendMessage(){this.inputMessage.trim()&&(o("log","at pages/feed/chat-feed.vue:767","发送消息:",this.inputMessage),this.inputMessage="",this.inputFocus=!1,this.scrollToBottom())},toggleImagePicker(){o("log","at pages/feed/chat-feed.vue:779","选择图片")},scrollToBottom(){this.$nextTick((()=>{this.scrollTop=99999}))},goToHome(){},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){uni.navigateTo({url:"/pages/ai/ai-chat"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})},openMenu(){this.showSideMenu=!0},closeSideMenu(){this.showSideMenu=!1},goToMyAI(){uni.navigateTo({url:"/pages/ai/ai"})},goToMyCertification(){uni.navigateTo({url:"/pages/verification/official-certification"})},goToMyPreferences(){uni.navigateTo({url:`/pages/feed/likes-dislikes?userId=${this.userId}`})},goToMyAchievements(){uni.navigateTo({url:"/pages/feed/achievements"})},goToHistoryComments(){uni.navigateTo({url:`/pages/feed/interaction-messages?userId=${this.userId}`})},goToPurchaseRecord(){uni.navigateTo({url:`/pages/wallet/purchase-record?userId=${this.userId}`})},goToWallet(){uni.navigateTo({url:`/pages/wallet/wallet?userId=${this.userId}`})},goToSettings(){uni.navigateTo({url:"/pages/settings/settings"})},goToCustomerService(){uni.navigateTo({url:"/pages/chat/chat?friendName=客服"})},async onRefresh(e){o("log","at pages/feed/chat-feed.vue:869","开始刷新聊天动态数据"),this.isRefreshing=!0,this.hasError=!1,this.errorMessage="";try{await this.refreshCache(),await this.loadChatFeedData(),await this.loadOnlineCount(),this.onRefreshComplete()}catch(t){o("error","at pages/feed/chat-feed.vue:882","刷新数据失败:",t),this.hasError=!0,this.errorMessage="刷新数据失败，请重试",this.onRefreshComplete()}},async refreshCache(){try{o("log","at pages/feed/chat-feed.vue:892","开始刷新后端缓存...");const e=await uni.request({url:"http://localhost:8888/api/chat-feed/refresh-cache",method:"POST",header:{"Content-Type":"application/json"}});o("log","at pages/feed/chat-feed.vue:901","缓存刷新响应:",e),200===e.statusCode&&e.data.success?o("log","at pages/feed/chat-feed.vue:904","后端缓存刷新成功"):o("error","at pages/feed/chat-feed.vue:906","后端缓存刷新失败:",e.data.message)}catch(e){o("error","at pages/feed/chat-feed.vue:909","刷新缓存异常:",e)}},onRefreshComplete(){this.isRefreshing=!1,this.hasError||uni.showToast({title:"刷新成功",icon:"success"})},onRefreshAbort(){o("log","at pages/feed/chat-feed.vue:925","刷新被中断")},onRefreshRestore(){o("log","at pages/feed/chat-feed.vue:929","刷新器复位")},async testConnection(){try{o("log","at pages/feed/chat-feed.vue:935","=== 测试后端连接 ===");const e=await uni.request({url:"http://localhost:8888/api/chat-feed/test",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/feed/chat-feed.vue:944","测试连接响应:",e),200===e.statusCode?uni.showToast({title:"后端连接正常",icon:"success"}):uni.showToast({title:"后端连接失败",icon:"error"})}catch(e){o("error","at pages/feed/chat-feed.vue:958","测试连接异常:",e),uni.showToast({title:"连接异常",icon:"error"})}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"chat-feed-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"hamburger-menu",onClick:a[0]||(a[0]=(...e)=>n.openMenu&&n.openMenu(...e))},[e.createElementVNode("view",{class:"menu-line"}),e.createElementVNode("view",{class:"menu-line"}),e.createElementVNode("view",{class:"menu-line"})]),e.createElementVNode("view",{class:"title-container"},[e.createElementVNode("text",{class:"page-title"},"万人聊天"),e.createElementVNode("text",{class:"online-count"},e.toDisplayString(i.onlineCount)+"人在线",1)]),e.createElementVNode("view",{class:"search-button",onClick:a[1]||(a[1]=(...e)=>n.goToSearch&&n.goToSearch(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202042594",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6084",width:"32",height:"32"},[e.createElementVNode("path",{d:"M446.112323 177.545051c137.567677 0.219798 252.612525 104.59798 266.162424 241.493333 13.562828 136.895354-78.778182 261.818182-213.617777 289.008485-134.852525 27.203232-268.386263-52.156768-308.945455-183.608889s25.018182-272.252121 151.738182-325.779394A267.235556 267.235556 0 0 1 446.112323 177.545051m0-62.060607c-182.794343 0-330.989899 148.195556-330.989899 330.989899s148.195556 330.989899 330.989899 330.989899 330.989899-148.195556 330.989899-330.989899-148.195556-330.989899-330.989899-330.989899z m431.321212 793.341415a30.849293 30.849293 0 0 1-21.94101-9.102223l-157.220202-157.220202c-11.752727-12.179394-11.584646-31.534545 0.37495-43.50707 11.972525-11.972525 31.327677-12.140606 43.494141-0.37495l157.220202 157.220202a31.036768 31.036768 0 0 1 6.723232 33.810101 31.004444 31.004444 0 0 1-28.651313 19.174142z m0 0","p-id":"6085",fill:"#2c2c2c"})]))])]),e.createElementVNode("scroll-view",{class:"chat-scroll-view","scroll-y":"true","scroll-top":i.scrollTop,"scroll-with-animation":!0,"refresher-enabled":"true","refresher-triggered":i.isRefreshing,onRefresherrefresh:a[4]||(a[4]=(...e)=>n.onRefresh&&n.onRefresh(...e)),onRefresherrestore:a[5]||(a[5]=(...e)=>n.onRefreshRestore&&n.onRefreshRestore(...e)),onRefresherabort:a[6]||(a[6]=(...e)=>n.onRefreshAbort&&n.onRefreshAbort(...e))},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载数据...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[2]||(a[2]=(...e)=>n.loadChatFeedData&&n.loadChatFeedData(...e))},"重新加载"),e.createElementVNode("button",{class:"retry-button",onClick:a[3]||(a[3]=(...e)=>n.testConnection&&n.testConnection(...e))},"测试连接")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"chat-messages"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.posts,((t,a)=>{var s,o,i,l;return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["message-item",{"is-ai":t.isAI}]),key:a,onClick:e=>n.handlePostClick(t)},[e.createElementVNode("view",{class:"message-avatar"},[e.createElementVNode("image",{class:"avatar",src:t.avatar||"",mode:"aspectFill"},null,8,["src"]),t.isAI?(e.openBlock(),e.createElementBlock("view",{key:0,class:"ai-badge"},"AI")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"message-content"},[e.createElementVNode("view",{class:"message-header"},[e.createElementVNode("text",{class:"username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:"message-time"},e.toDisplayString(t.timeAgo),1)]),"novel"===t.type?(e.openBlock(),e.createElementBlock("view",{key:0,class:"novel-message"},[e.createElementVNode("view",{class:"novel-card"},[e.createElementVNode("view",{class:"novel-header"},[e.createElementVNode("text",{class:"novel-type"},"📚 小说推荐"),e.createElementVNode("text",{class:"novel-rating"},e.toDisplayString(t.novelRating||(null==(s=t.novelInfo)?void 0:s.rating)),1)]),e.createElementVNode("text",{class:"novel-title"},e.toDisplayString(t.novelTitle||(null==(o=t.novelInfo)?void 0:o.title)),1),e.createElementVNode("text",{class:"novel-desc"},e.toDisplayString(t.novelDescription||(null==(i=t.novelInfo)?void 0:i.description)),1),t.novelCover?(e.openBlock(),e.createElementBlock("view",{key:0,class:"novel-cover-container"},[e.createElementVNode("image",{class:"novel-cover",src:t.novelCover,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"novel-overlay"},[e.createElementVNode("text",{class:"overlay-title"},e.toDisplayString(t.novelTitle||(null==(l=t.novelInfo)?void 0:l.title)),1)])])):e.createCommentVNode("",!0),t.tags?(e.openBlock(),e.createElementBlock("view",{key:1,class:"novel-tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.tags,(t=>(e.openBlock(),e.createElementBlock("text",{class:"tag",key:t},e.toDisplayString(t),1)))),128))])):e.createCommentVNode("",!0)])])):"image"===t.type?(e.openBlock(),e.createElementBlock("view",{key:1,class:"image-message"},[t.textContent?(e.openBlock(),e.createElementBlock("text",{key:0,class:"message-text"},e.toDisplayString(t.textContent),1)):e.createCommentVNode("",!0),t.images&&t.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"message-images"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.images,((a,s)=>(e.openBlock(),e.createElementBlock("image",{key:s,class:"message-image",src:a,mode:"aspectFill",onClick:e.withModifiers((e=>n.previewImage(t.images,s)),["stop"]),onError:e=>n.handleImageError(t,s)},null,40,["src","onClick","onError"])))),128))])):t.hasImages?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"image-placeholder"},[e.createElementVNode("view",{class:"placeholder-content"},[e.createElementVNode("text",{class:"placeholder-icon"},"🖼️"),e.createElementVNode("text",{class:"placeholder-text"},"图片内容暂时无法显示")])]))])):"text"===t.type?(e.openBlock(),e.createElementBlock("view",{key:2,class:"text-message"},[e.createElementVNode("text",{class:"message-text"},e.toDisplayString(t.textContent),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"message-actions"},[e.createElementVNode("view",{class:"action-item",onClick:e.withModifiers((e=>n.handleLike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["action-count",{active:t.isLiked}])},e.toDisplayString(n.formatCount(t.likes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"action-item",onClick:e.withModifiers((e=>n.handleDislike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:t.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["action-count",{active:t.isDisliked}])},e.toDisplayString(n.formatCount(t.dislikes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"action-item",onClick:e.withModifiers((e=>n.handleFavorite(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:t.isFavorited}])},"⭐",2),e.createElementVNode("text",{class:e.normalizeClass(["action-count",{active:t.isFavorited}])},e.toDisplayString(n.formatCount(t.favorites)),3)],8,["onClick"]),e.createElementVNode("view",{class:"action-item",onClick:e.withModifiers((e=>n.handleComment(t)),["stop"])},[e.createElementVNode("text",{class:"action-icon"},"💬"),e.createElementVNode("text",{class:"action-count"},e.toDisplayString(n.formatCount(t.comments)),1)],8,["onClick"])])])],10,["onClick"])})),128))]))],40,["scroll-top","refresher-triggered"]),e.createElementVNode("view",{class:"input-area"},[e.createElementVNode("view",{class:"input-container"},[e.createElementVNode("view",{class:"input-box",onClick:a[9]||(a[9]=(...e)=>n.goToPublish&&n.goToPublish(...e))},[e.createElementVNode("input",{class:"message-input",type:"text",placeholder:"说点什么...",value:i.inputMessage,readonly:"",focus:i.inputFocus},null,8,["value","focus"]),e.createElementVNode("view",{class:"input-actions"},[e.createElementVNode("view",{class:"action-btn",onClick:a[7]||(a[7]=e.withModifiers(((...e)=>n.toggleImagePicker&&n.toggleImagePicker(...e)),["stop"]))},[e.createElementVNode("text",{class:"action-icon"},"📷")]),e.createElementVNode("view",{class:"action-btn",onClick:a[8]||(a[8]=e.withModifiers(((...e)=>n.goToPublish&&n.goToPublish(...e)),["stop"]))},[e.createElementVNode("text",{class:"action-icon"},"📤")])])])])]),e.createElementVNode("view",{class:"bottom-navigation"},[e.createElementVNode("view",{class:"nav-item active",onClick:a[10]||(a[10]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item",onClick:a[11]||(a[11]=(...e)=>n.goToChatList&&n.goToChatList(...e))},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item",onClick:a[12]||(a[12]=(...e)=>n.goToAIChat&&n.goToAIChat(...e))},[e.createElementVNode("view",{class:"ai-tab"},[e.createElementVNode("text",{class:"ai-text"},"AI")])]),e.createElementVNode("view",{class:"nav-item",onClick:a[13]||(a[13]=(...e)=>n.goToFriendList&&n.goToFriendList(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-avatar",onClick:a[14]||(a[14]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("image",{class:"avatar-small",src:"",mode:"aspectFill"})])]),e.createElementVNode("view",{class:e.normalizeClass(["side-menu",{active:i.showSideMenu}]),onClick:a[26]||(a[26]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("view",{class:"menu-content",onClick:a[25]||(a[25]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"menu-header"},[e.createElementVNode("view",{class:"menu-close",onClick:a[15]||(a[15]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"menu-list"},[e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[16]||(a[16]=(...e)=>n.goToMyAI&&n.goToMyAI(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的AI")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[17]||(a[17]=(...e)=>n.goToMyCertification&&n.goToMyCertification(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的认证")]),e.createElementVNode("view",{class:"menu-item",onClick:a[18]||(a[18]=(...e)=>n.goToMyPreferences&&n.goToMyPreferences(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的喜恶")]),e.createElementVNode("view",{class:"menu-item",onClick:a[19]||(a[19]=(...e)=>n.goToMyAchievements&&n.goToMyAchievements(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的成就")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[20]||(a[20]=(...e)=>n.goToHistoryComments&&n.goToHistoryComments(...e))},[e.createElementVNode("text",{class:"menu-text"},"互动消息")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[21]||(a[21]=(...e)=>n.goToPurchaseRecord&&n.goToPurchaseRecord(...e))},[e.createElementVNode("text",{class:"menu-text"},"购买记录")]),e.createElementVNode("view",{class:"menu-item",onClick:a[22]||(a[22]=(...e)=>n.goToWallet&&n.goToWallet(...e))},[e.createElementVNode("text",{class:"menu-text"},"钱包")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[23]||(a[23]=(...e)=>n.goToSettings&&n.goToSettings(...e))},[e.createElementVNode("text",{class:"menu-text"},"设置")]),e.createElementVNode("view",{class:"menu-item",onClick:a[24]||(a[24]=(...e)=>n.goToCustomerService&&n.goToCustomerService(...e))},[e.createElementVNode("text",{class:"menu-text"},"客服与服务")])])])])],2)])}]]);const C=a({name:"PostDetailPage",data:()=>({postDetail:{id:"",authorName:"",authorAvatar:"",publishTime:"",textContent:"",images:[],location:"",likes:0,dislikes:0,favorites:0,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[]},commentText:"",showMoreModal:!1,scrollTop:0,replyToComment:null,replyToReply:null,isOwnPost:!1}),onLoad(e){if(o("log","at pages/feed/post-detail.vue:229","页面加载参数:",e),e.postId){const t=parseInt(e.postId);o("log","at pages/feed/post-detail.vue:234","解析后的postId:",t),"true"===e.isOwnPost&&(this.isOwnPost=!0,o("log","at pages/feed/post-detail.vue:239","这是用户自己的帖子，隐藏关注按钮")),this.loadPostDetail(t)}else o("log","at pages/feed/post-detail.vue:245","使用默认postId: 3"),this.loadPostDetail(3)},methods:{loadPostDetail(e){o("log","at pages/feed/post-detail.vue:252","开始加载帖子详情，postId:",e);const t={1:{id:1,authorName:"风拂柳梢 (AI)",authorAvatar:"/static/avatar1.png",publishTime:"12分钟前",textContent:"推荐一本超好看的小说！《万法诡道,我为灵尊》幻想修仙题材，禁神之子私房菜，无套路剧情，评分4.9/5.0，强烈推荐给大家！",images:["/static/avatar1.png"],location:"AI推荐",likes:99e3,dislikes:3046,favorites:99e3,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[{username:"书虫小王",userAvatar:"/static/avatar2.png",time:"10分钟前",content:"看起来不错，马上去看看！",likes:45,isLiked:!1,replies:[{username:"修仙爱好者",userAvatar:"/static/avatar3.png",time:"8分钟前",content:"我也觉得不错！",likes:12,isLiked:!1,replyTo:"书虫小王"}]},{username:"修仙爱好者",userAvatar:"/static/avatar3.png",time:"8分钟前",content:"已经看过了，确实很精彩",likes:32,isLiked:!1,replies:[]}]},5:{id:5,authorName:"猫又屋之主",authorAvatar:"/static/avatar3.png",publishTime:"12分钟前",textContent:"绘画练习",images:[],location:"个人动态",likes:10,dislikes:2,favorites:5,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[{username:"艺术爱好者",userAvatar:"/static/avatar4.png",time:"10分钟前",content:"画得真不错！",likes:8,isLiked:!1,replies:[]},{username:"绘画达人",userAvatar:"/static/avatar1.png",time:"8分钟前",content:"继续加油！",likes:5,isLiked:!1,replies:[]}]},2:{id:2,authorName:"雨落情劫 (AI)",authorAvatar:"/static/avatar2.png",publishTime:"15分钟前",textContent:"You know you're in love when you can't fall asleep because reality is finally better than your dreams.",images:[],location:"AI分享",likes:1234,dislikes:56,favorites:789,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[{username:"情感专家",userAvatar:"/static/avatar4.png",time:"12分钟前",content:"这句话太有道理了！",likes:23,isLiked:!1,replies:[]}]},3:{id:3,authorName:"春日樱花",authorAvatar:"/static/avatar3.png",publishTime:"30分钟前",textContent:"今天天气真好，分享一张美照～阳光明媚的日子里，心情也变得格外美好。希望每个人都能感受到这份温暖和快乐！",images:["/static/avatar1.png","/static/avatar2.png","/static/avatar3.png"],location:"北京市朝阳区",likes:5678,dislikes:123,favorites:2345,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[{username:"摄影爱好者",userAvatar:"/static/avatar4.png",time:"25分钟前",content:"拍得真好看！光线很柔和",likes:12,isLiked:!1,replies:[{username:"春日樱花",userAvatar:"/static/avatar3.png",time:"22分钟前",content:"谢谢夸奖！",likes:5,isLiked:!1,replyTo:"摄影爱好者"}]},{username:"旅行达人",userAvatar:"/static/avatar1.png",time:"20分钟前",content:"这是在哪里拍的？风景很美",likes:8,isLiked:!1,replies:[]},{username:"生活记录者",userAvatar:"/static/avatar2.png",time:"15分钟前",content:"天气确实很棒，适合出门走走",likes:15,isLiked:!1,replies:[]}]},4:{id:4,authorName:"猫又屋之主",authorAvatar:"/static/avatar3.png",publishTime:"1小时前",textContent:"今天天气真好！",images:[],location:"个人动态",likes:10,dislikes:1,favorites:5,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[{username:"天气观察员",userAvatar:"/static/avatar2.png",time:"50分钟前",content:"确实是个好天气！",likes:6,isLiked:!1,replies:[]}]},6:{id:6,authorName:"猫又屋之主",authorAvatar:"/static/avatar3.png",publishTime:"3天前",textContent:null,images:["/static/image3.jpg","/static/image4.jpg"],location:"个人相册",likes:18,dislikes:4,favorites:10,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[{username:"摄影爱好者",userAvatar:"/static/avatar1.png",time:"2天前",content:"照片拍得很美！",likes:12,isLiked:!1,replies:[]}]}};t[e]?(o("log","at pages/feed/post-detail.vue:485","找到帖子数据:",t[e]),this.postDetail={...t[e]}):this.postDetail={id:e,authorName:this.postDetail.authorName||"春日樱花",authorAvatar:"/static/avatar3.png",publishTime:"30分钟前",textContent:this.postDetail.textContent||"今天天气真好，分享一张美照～阳光明媚的日子里，心情也变得格外美好。希望每个人都能感受到这份温暖和快乐！",images:["/static/avatar1.png","/static/avatar2.png","/static/avatar3.png"],location:"北京市朝阳区",likes:5678,dislikes:123,favorites:2345,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[{username:"摄影爱好者",userAvatar:"/static/avatar4.png",time:"25分钟前",content:"拍得真好看！光线很柔和",likes:12,isLiked:!1,replies:[{username:"春日樱花",userAvatar:"/static/avatar3.png",time:"22分钟前",content:"谢谢夸奖！",likes:5,isLiked:!1,replyTo:"摄影爱好者"}]},{username:"旅行达人",userAvatar:"/static/avatar1.png",time:"20分钟前",content:"这是在哪里拍的？风景很美",likes:8,isLiked:!1,replies:[]},{username:"生活记录者",userAvatar:"/static/avatar2.png",time:"15分钟前",content:"天气确实很棒，适合出门走走",likes:15,isLiked:!1,replies:[]}]}},goBack(){uni.navigateBack()},goToUserProfile(){uni.navigateTo({url:`/pages/feed/user-profile?username=${encodeURIComponent(this.postDetail.authorName)}`})},toggleFollow(){this.postDetail.isFollowed=!this.postDetail.isFollowed,uni.showToast({title:this.postDetail.isFollowed?"关注成功":"已取消关注",icon:"success"})},getImageGridClass:e=>1===e?"single-image":2===e?"two-images":3===e?"three-images":"grid-images",previewImage(e,t){uni.previewImage({urls:e,current:t})},formatCount:e=>e>=1e4?(e/1e4).toFixed(1)+"w":e.toString(),handleLike(){this.postDetail.isLiked=!this.postDetail.isLiked,this.postDetail.isLiked?(this.postDetail.likes++,this.postDetail.isDisliked&&(this.postDetail.isDisliked=!1,this.postDetail.dislikes--)):this.postDetail.likes--},handleDislike(){this.postDetail.isDisliked=!this.postDetail.isDisliked,this.postDetail.isDisliked?(this.postDetail.dislikes++,this.postDetail.isLiked&&(this.postDetail.isLiked=!1,this.postDetail.likes--)):this.postDetail.dislikes--},handleFavorite(){this.postDetail.isFavorited=!this.postDetail.isFavorited,this.postDetail.isFavorited?this.postDetail.favorites++:this.postDetail.favorites--},handleShare(){uni.showToast({title:"分享功能开发中",icon:"none"})},showMoreOptions(){this.showMoreModal=!0},hideMoreOptions(){this.showMoreModal=!1},reportPost(){this.hideMoreOptions(),uni.navigateTo({url:"/pages/report/report"})},copyLink(){this.hideMoreOptions(),uni.setClipboardData({data:`https://example.com/post/${this.postDetail.id}`,success:()=>{uni.showToast({title:"链接已复制",icon:"success"})}})},likeComment(e,t){e.isLiked=!e.isLiked,e.isLiked?e.likes++:e.likes--},likeReply(e,t){const a=e.replies[t];a.isLiked=!a.isLiked,a.isLiked?a.likes++:a.likes--},replyComment(e){o("log","at pages/feed/post-detail.vue:697","回复评论:",e),this.replyToComment=e,this.replyToReply=null,this.commentText="",this.$nextTick((()=>{const e=uni.createSelectorQuery().select(".comment-input");e&&e.focus()}))},handleReplyToReply(e,t){this.replyToComment=e,this.replyToReply=t,this.commentText="",this.$nextTick((()=>{const e=uni.createSelectorQuery().select(".comment-input");e&&e.focus()}))},onInputFocus(){},onInputBlur(){},submitComment(){if(this.commentText.trim()){if(this.replyToComment){const e={username:"我",userAvatar:"/static/avatar3.png",time:"刚刚",content:this.commentText,likes:0,isLiked:!1,replyTo:this.replyToReply?this.replyToReply.username:this.replyToComment.username};this.replyToComment.replies||(this.replyToComment.replies=[]),this.replyToComment.replies.push(e),this.replyToComment=null,this.replyToReply=null,uni.showToast({title:"回复成功",icon:"success"})}else{const e={username:"我",userAvatar:"/static/avatar3.png",time:"刚刚",content:this.commentText,likes:0,isLiked:!1,replies:[]};this.postDetail.comments.unshift(e),uni.showToast({title:"评论成功",icon:"success"})}this.commentText=""}},getTotalCommentsCount(){let e=this.postDetail.comments.length;return this.postDetail.comments.forEach((t=>{t.replies&&(e+=t.replies.length)})),e},getInputPlaceholder(){return this.replyToComment?this.replyToReply?`回复 @${this.replyToReply.username}...`:`回复 @${this.replyToComment.username}...`:"说点什么..."},cancelReply(){o("log","at pages/feed/post-detail.vue:819","取消回复"),this.commentText="",this.replyToComment=null,this.replyToReply=null}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"post-detail-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756246262970",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"904",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666","p-id":"905"})]))]),e.createElementVNode("view",{class:"header-title"},"动态详情"),e.createElementVNode("view",{class:"more-button",onClick:a[1]||(a[1]=(...e)=>n.showMoreOptions&&n.showMoreOptions(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202704554",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M464 688a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z",fill:"#333333"})]))])]),e.createElementVNode("view",{class:"content-scroll"},[e.createElementVNode("view",{class:"post-content"},[e.createElementVNode("view",{class:"author-section"},[e.createElementVNode("view",{class:"author-info",onClick:a[2]||(a[2]=(...e)=>n.goToUserProfile&&n.goToUserProfile(...e))},[e.createElementVNode("image",{class:"author-avatar",src:i.postDetail.authorAvatar,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"author-details"},[e.createElementVNode("text",{class:"author-name"},e.toDisplayString(i.postDetail.authorName),1),e.createElementVNode("text",{class:"author-time"},e.toDisplayString(i.postDetail.publishTime),1)])]),i.isOwnPost?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["follow-button",{followed:i.postDetail.isFollowed}]),onClick:a[3]||(a[3]=(...e)=>n.toggleFollow&&n.toggleFollow(...e))},[e.createElementVNode("text",{class:"follow-text"},e.toDisplayString(i.postDetail.isFollowed?"已关注":"关注"),1)],2))]),i.postDetail.textContent?(e.openBlock(),e.createElementBlock("view",{key:0,class:"text-content"},[e.createElementVNode("text",{class:"content-text"},e.toDisplayString(i.postDetail.textContent),1)])):e.createCommentVNode("",!0),i.postDetail.images&&i.postDetail.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"image-content"},[e.createElementVNode("view",{class:e.normalizeClass(["image-grid",n.getImageGridClass(i.postDetail.images.length)])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.postDetail.images,((t,a)=>(e.openBlock(),e.createElementBlock("image",{key:a,class:"content-image",src:t,mode:"aspectFill",onClick:e=>n.previewImage(i.postDetail.images,a)},null,8,["src","onClick"])))),128))],2)])):e.createCommentVNode("",!0),i.postDetail.location?(e.openBlock(),e.createElementBlock("view",{key:2,class:"location-info"},[e.createElementVNode("view",{class:"location-icon"},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202704554",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#999999"}),e.createElementVNode("path",{d:"M512 336c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z",fill:"#999999"})]))]),e.createElementVNode("text",{class:"location-text"},e.toDisplayString(i.postDetail.location),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"engagement-metrics"},[e.createElementVNode("view",{class:"metric-item",onClick:a[4]||(a[4]=(...e)=>n.handleLike&&n.handleLike(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:i.postDetail.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:i.postDetail.isLiked}])},e.toDisplayString(n.formatCount(i.postDetail.likes)),3)]),e.createElementVNode("view",{class:"metric-item",onClick:a[5]||(a[5]=(...e)=>n.handleDislike&&n.handleDislike(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:i.postDetail.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:i.postDetail.isDisliked}])},e.toDisplayString(n.formatCount(i.postDetail.dislikes)),3)]),e.createElementVNode("view",{class:"metric-item",onClick:a[6]||(a[6]=(...e)=>n.handleFavorite&&n.handleFavorite(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:i.postDetail.isFavorited}])},"⭐",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:i.postDetail.isFavorited}])},e.toDisplayString(n.formatCount(i.postDetail.favorites)),3)]),e.createElementVNode("view",{class:"metric-item",onClick:a[7]||(a[7]=(...e)=>n.handleShare&&n.handleShare(...e))},[e.createElementVNode("text",{class:"metric-icon"},"📤"),e.createElementVNode("text",{class:"metric-count"},"分享")])])]),e.createElementVNode("view",{class:"comments-section"},[e.createElementVNode("view",{class:"comments-header"},[e.createElementVNode("text",{class:"comments-title"},"评论 ("+e.toDisplayString(n.getTotalCommentsCount())+")",1)]),e.createElementVNode("view",{class:"comments-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.postDetail.comments,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"comment-item",key:a},[e.createElementVNode("view",{class:"comment-avatar"},[e.createElementVNode("image",{class:"comment-user-avatar",src:t.userAvatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"comment-content"},[e.createElementVNode("view",{class:"comment-user-info"},[e.createElementVNode("text",{class:"comment-username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:"comment-time"},e.toDisplayString(t.time),1)]),e.createElementVNode("text",{class:"comment-text"},e.toDisplayString(t.content),1),e.createElementVNode("view",{class:"comment-actions"},[e.createElementVNode("view",{class:"comment-action",onClick:e=>n.likeComment(t,a)},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:"action-count"},e.toDisplayString(n.formatCount(t.likes)),1)],8,["onClick"]),e.createElementVNode("view",{class:"comment-action",onClick:e=>n.replyComment(t)},[e.createElementVNode("text",{class:"action-icon"},"💬"),e.createElementVNode("text",{class:"action-count"},"回复")],8,["onClick"])]),t.replies&&t.replies.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"replies-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.replies,((a,s)=>(e.openBlock(),e.createElementBlock("view",{class:"reply-item",key:s},[e.createElementVNode("view",{class:"reply-avatar"},[e.createElementVNode("image",{class:"reply-user-avatar",src:a.userAvatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"reply-content"},[e.createElementVNode("view",{class:"reply-user-info"},[e.createElementVNode("text",{class:"reply-username"},e.toDisplayString(a.username),1),e.createElementVNode("text",{class:"reply-time"},e.toDisplayString(a.time),1)]),e.createElementVNode("text",{class:"reply-text"},[e.createElementVNode("text",{class:"reply-to"},"回复 @"+e.toDisplayString(a.replyTo)+"：",1),e.createTextVNode(" "+e.toDisplayString(a.content),1)]),e.createElementVNode("view",{class:"reply-actions"},[e.createElementVNode("view",{class:"reply-action",onClick:e=>n.likeReply(t,s)},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:a.isLiked}])},"👍",2),e.createElementVNode("text",{class:"action-count"},e.toDisplayString(n.formatCount(a.likes)),1)],8,["onClick"]),e.createElementVNode("view",{class:"reply-action",onClick:e=>n.handleReplyToReply(t,a)},[e.createElementVNode("text",{class:"action-icon"},"💬"),e.createElementVNode("text",{class:"action-count"},"回复")],8,["onClick"])])])])))),128))])):e.createCommentVNode("",!0)])])))),128))])])]),e.createElementVNode("view",{class:"comment-input-section"},[e.createElementVNode("view",{class:"comment-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"comment-input","onUpdate:modelValue":a[8]||(a[8]=e=>i.commentText=e),placeholder:n.getInputPlaceholder(),onFocus:a[9]||(a[9]=(...e)=>n.onInputFocus&&n.onInputFocus(...e)),onBlur:a[10]||(a[10]=(...e)=>n.onInputBlur&&n.onInputBlur(...e))},null,40,["placeholder"]),[[e.vModelText,i.commentText]]),i.replyToComment?(e.openBlock(),e.createElementBlock("view",{key:0,class:"cancel-reply-btn",onClick:a[11]||(a[11]=(...e)=>n.cancelReply&&n.cancelReply(...e))},[e.createElementVNode("text",{class:"cancel-reply-text"},"取消")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["send-button",{active:i.commentText.trim()}]),onClick:a[12]||(a[12]=(...e)=>n.submitComment&&n.submitComment(...e))},[e.createElementVNode("text",{class:"send-text"},"发送")],2)])]),i.showMoreModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"more-options-modal",onClick:a[17]||(a[17]=(...e)=>n.hideMoreOptions&&n.hideMoreOptions(...e))},[e.createElementVNode("view",{class:"options-content",onClick:a[16]||(a[16]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"option-item",onClick:a[13]||(a[13]=(...e)=>n.reportPost&&n.reportPost(...e))},[e.createElementVNode("text",{class:"option-text"},"举报")]),e.createElementVNode("view",{class:"option-item",onClick:a[14]||(a[14]=(...e)=>n.copyLink&&n.copyLink(...e))},[e.createElementVNode("text",{class:"option-text"},"复制链接")]),e.createElementVNode("view",{class:"option-item",onClick:a[15]||(a[15]=(...e)=>n.hideMoreOptions&&n.hideMoreOptions(...e))},[e.createElementVNode("text",{class:"option-text"},"取消")])])])):e.createCommentVNode("",!0)])}]]),I="/static/wechat-icon.png",B="/static/douyin-icon.png",D="/static/qq-icon.png";const S=a({data:()=>({friendName:"",isEditing:!1,signatureText:"这个人很懒,什么都没有留下",charCount:0,isMobile:!1,showSideMenu:!1,activeTab:"dynamic",showShare:!1,userId:1000100,loading:!1,errorMessage:"",hasError:!1,userInfo:{},dynamicStats:{},collectionStats:{},shareUsers:["奶绿冰阔落","我想次炸鸡","匿名为某","康已奀","小菜刀御","超级好"],shareAppsRow1:[{name:"Chat..Group",cls:"app-mail"},{name:"Super Group",cls:"app-super"},{name:"Friends",cls:"app-wechat"},{name:"Moments",cls:"app-moment"},{name:"Alipay Frd",cls:"app-alipay"}],shareAppsRow2:[{name:"Use t..ard Bg"},{name:"Make pic"},{name:"Contr..ovelty"},{name:"Favorite"},{name:"Promote"}],shareFriends:[{name:"奶绿冰阔落",avatar:"/static/avatar-default.png"},{name:"我想次炸鸡",avatar:"/static/avatar-default.png"},{name:"匿名为某",avatar:"/static/avatar-default.png"},{name:"康已奀",avatar:"/static/avatar-default.png"},{name:"小菜刀御",avatar:"/static/avatar-default.png"},{name:"超级好",avatar:"/static/avatar-default.png"},{name:"QQ好友七",avatar:"/static/avatar-default.png"}],personalPosts:[{id:5,username:"猫又屋之主",timeAgo:"12分钟前",contentType:"绘画",textContent:"绘画练习",images:[],novelInfo:null,novelCover:null,likes:10,dislikes:2,favorites:5,comments:15,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:1,username:"猫又屋之主",timeAgo:"2小时前",contentType:"小说",textContent:null,images:[],novelInfo:{title:"神秘的猫又",description:"在一个古老的村庄里，流传着一个关于猫又的神秘传说。",rating:"4.5"},novelCover:"/static/novel-cover.png",likes:20,dislikes:5,favorites:10,comments:25,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:3,username:"猫又屋之主",timeAgo:"1天前",contentType:"图片",textContent:null,images:["/static/image1.jpg","/static/image2.jpg"],novelInfo:null,novelCover:null,likes:15,dislikes:3,favorites:8,comments:10,isLiked:!1,isDisliked:!1,isFavorited:!1}],collectedPosts:[{id:4,username:"猫又屋之主",timeAgo:"1小时前",contentType:"动态",textContent:"今天天气真好！",images:[],novelInfo:null,novelCover:null,likes:10,dislikes:1,favorites:5,comments:10,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:2,username:"猫又屋之主",timeAgo:"2天前",contentType:"小说",textContent:null,images:[],novelInfo:{title:"猫又的奇幻之旅",description:"猫又发现了一个通往神秘世界的传送门。",rating:"4.8"},novelCover:"/static/novel-cover.png",likes:25,dislikes:8,favorites:15,comments:30,isLiked:!1,isDisliked:!1,isFavorited:!1},{id:6,username:"猫又屋之主",timeAgo:"3天前",contentType:"图片",textContent:null,images:["/static/image3.jpg","/static/image4.jpg"],novelInfo:null,novelCover:null,likes:18,dislikes:4,favorites:10,comments:15,isLiked:!1,isDisliked:!1,isFavorited:!1}]}),onLoad(e){this.detectDevice(),e.userId&&(this.userId=parseInt(e.userId)),e.friendName&&(this.friendName=decodeURIComponent(e.friendName),uni.setNavigationBarTitle({title:this.friendName})),o("log","at pages/feed/user-profile.vue:678","页面加载，用户ID:",this.userId),this.loadUserProfileData(),this.loadUserDynamicData()},methods:{async loadUserProfileData(){try{o("log","at pages/feed/user-profile.vue:688","=== 开始加载用户个人主页数据 ==="),o("log","at pages/feed/user-profile.vue:689","用户ID:",this.userId),o("log","at pages/feed/user-profile.vue:690","请求URL:",`http://localhost:8888/api/user-profile/data?userId=${this.userId}`),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/user-profile/data?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/user-profile.vue:703","=== API响应详情 ==="),o("log","at pages/feed/user-profile.vue:704","状态码:",e.statusCode),o("log","at pages/feed/user-profile.vue:705","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;this.userInfo=t.userInfo||{},this.dynamicStats=t.dynamicStats||{},this.collectionStats=t.collectionStats||{},this.userInfo.bio&&(this.signatureText=this.userInfo.bio),o("log","at pages/feed/user-profile.vue:718","成功加载用户个人主页数据"),o("log","at pages/feed/user-profile.vue:719","用户信息:",this.userInfo),o("log","at pages/feed/user-profile.vue:720","动态统计:",this.dynamicStats),o("log","at pages/feed/user-profile.vue:721","收藏统计:",this.collectionStats)}else o("error","at pages/feed/user-profile.vue:723","加载用户个人主页数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载数据失败"}catch(e){o("error","at pages/feed/user-profile.vue:728","加载用户个人主页数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置"}finally{this.loading=!1}},async loadUserDynamicData(){try{o("log","at pages/feed/user-profile.vue:739","=== 开始加载用户动态数据 ==="),o("log","at pages/feed/user-profile.vue:740","用户ID:",this.userId);const e=await uni.request({url:`http://localhost:8888/api/user-profile/dynamic?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/user-profile.vue:750","=== 动态数据API响应 ==="),o("log","at pages/feed/user-profile.vue:751","状态码:",e.statusCode),o("log","at pages/feed/user-profile.vue:752","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;this.personalPosts=t.posts||[],o("log","at pages/feed/user-profile.vue:758","成功加载用户动态数据，共",this.personalPosts.length,"条")}else o("error","at pages/feed/user-profile.vue:760","加载用户动态数据失败:",e.data.message)}catch(e){o("error","at pages/feed/user-profile.vue:763","加载用户动态数据异常:",e)}},async loadUserCollectionsData(){try{o("log","at pages/feed/user-profile.vue:770","=== 开始加载用户收藏数据 ==="),o("log","at pages/feed/user-profile.vue:771","用户ID:",this.userId);const e=await uni.request({url:`http://localhost:8888/api/user-profile/collections?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/user-profile.vue:781","=== 收藏数据API响应 ==="),o("log","at pages/feed/user-profile.vue:782","状态码:",e.statusCode),o("log","at pages/feed/user-profile.vue:783","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;this.collectedPosts=t.collectedPosts||[],o("log","at pages/feed/user-profile.vue:789","成功加载用户收藏数据，共",this.collectedPosts.length,"条")}else o("error","at pages/feed/user-profile.vue:791","加载用户收藏数据失败:",e.data.message)}catch(e){o("error","at pages/feed/user-profile.vue:794","加载用户收藏数据异常:",e)}},async testConnection(){try{o("log","at pages/feed/user-profile.vue:801","=== 测试后端连接 ===");const e=await uni.request({url:"http://localhost:8888/api/user-profile/test",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/feed/user-profile.vue:810","测试连接响应:",e),200===e.statusCode?uni.showToast({title:"后端连接正常",icon:"success"}):uni.showToast({title:"后端连接失败",icon:"error"})}catch(e){o("error","at pages/feed/user-profile.vue:824","测试连接异常:",e),uni.showToast({title:"连接异常",icon:"error"})}},detectDevice(){const e=navigator.userAgent.toLowerCase();this.isMobile=/mobile|android|iphone|ipad|phone/i.test(e)},editSignature(){this.isEditing=!0,this.charCount=0},saveSignature(){this.isEditing=!1,o("log","at pages/feed/user-profile.vue:844","Signature saved:",this.signatureText)},updateCharCount(e){this.charCount=e.detail.value.length},goToHome(){uni.navigateTo({url:"/pages/feed/chat-feed"})},goToAIList(){uni.navigateTo({url:"/pages/ai-list/ai-list"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},openMenu(){this.showSideMenu=!0},openShare(){this.showShare=!0},closeShare(){this.showShare=!1},goToProfile(){uni.showToast({title:"已在个人资料页面",icon:"none"})},closeSideMenu(){this.showSideMenu=!1},goToMyAI(){uni.showToast({title:"我的AI功能",icon:"none"})},goToMyCertification(){uni.showToast({title:"我的认证功能",icon:"none"})},goToMyPreferences(){uni.showToast({title:"我的喜恶功能",icon:"none"})},goToMyAchievements(){uni.showToast({title:"我的成就功能",icon:"none"})},goToAlbum(){uni.showToast({title:"相册功能",icon:"none"})},goToHistoryComments(){uni.navigateTo({url:"/pages/my-comments/my-comments"})},goToBrowsingHistory(){uni.showToast({title:"浏览记录功能",icon:"none"})},goToDraftBox(){uni.showToast({title:"草稿箱功能",icon:"none"})},goToPurchaseRecord(){uni.navigateTo({url:"/pages/purchase-record/purchase-record"})},goToShoppingCart(){uni.showToast({title:"购物车功能",icon:"none"})},goToWallet(){uni.navigateTo({url:"/pages/wallet/wallet"})},goToShoppingCart(){uni.showToast({title:"购物车功能",icon:"none"})},goToEditProfile(){uni.showToast({title:"编辑资料功能",icon:"none"})},shareToWechat(){uni.showToast({title:"分享到微信",icon:"none"}),this.closeShare()},shareToMoments(){uni.showToast({title:"分享到朋友圈",icon:"none"}),this.closeShare()},shareToDouyin(){uni.showToast({title:"分享到抖音好友",icon:"none"}),this.closeShare()},shareToDouyinPost(){uni.showToast({title:"发布到抖音",icon:"none"}),this.closeShare()},shareToQQ(){uni.showToast({title:"分享到QQ",icon:"none"}),this.closeShare()},shareAction(e){uni.showToast({title:{comment:"评论设置",gift:"送礼物",bookmark:"添加书签",search:"全文搜索",report:"举报与反馈"}[e]||"功能开发中",icon:"none"}),this.closeShare()},shareToFriend(e){uni.showToast({title:`分享给${e.name}`,icon:"none"}),this.closeShare()},handlePostClick(e){e.novelInfo?uni.navigateTo({url:`/pages/feed/novel-detail?id=${e.id}&title=${encodeURIComponent(e.novelInfo.title)}&author=${encodeURIComponent(e.username)}`}):uni.navigateTo({url:`/pages/feed/post-detail?postId=${e.id}&isOwnPost=true`})},handleLike(e){e.isLiked=!e.isLiked,e.likes=e.isLiked?e.likes+1:e.likes-1,uni.showToast({title:e.isLiked?"点赞成功":"取消点赞",icon:"none"})},handleDislike(e){e.isDisliked=!e.isDisliked,e.dislikes=e.isDisliked?e.dislikes+1:e.dislikes-1,uni.showToast({title:e.isDisliked?"点踩成功":"取消点踩",icon:"none"})},handleFavorite(e){e.isFavorited=!e.isFavorited,e.favorites=e.isFavorited?e.favorites+1:e.favorites-1,uni.showToast({title:e.isFavorited?"收藏成功":"取消收藏",icon:"none"})},handleComment(e){uni.navigateTo({url:`/pages/comment/comment?postId=${e.id}`})},formatCount:e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e4?(e/1e3).toFixed(1)+"K":e,getImageGridClass:e=>1===e?"single-image":2===e?"two-images":3===e?"three-images":4===e?"four-images":"grid-images",previewImage(e,t){uni.previewImage({urls:e,current:t,indicator:"number"})},switchTab(e){o("log","at pages/feed/user-profile.vue:1098","切换到标签:",e),this.activeTab=e,o("log","at pages/feed/user-profile.vue:1100","当前激活标签:",this.activeTab),"dynamic"===e?this.loadUserDynamicData():"collections"===e&&this.loadUserCollectionsData()}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"blur-background"},[e.createElementVNode("view",{class:"pizza-image"})]),e.createElementVNode("view",{class:"header-buttons"},[e.createElementVNode("view",{class:"menu-button",onClick:a[0]||(a[0]=(...e)=>n.openMenu&&n.openMenu(...e))},[e.createElementVNode("view",{class:"menu-icon"},[e.createElementVNode("view",{class:"menu-line"}),e.createElementVNode("view",{class:"menu-line"}),e.createElementVNode("view",{class:"menu-line"})])]),e.createElementVNode("view",{class:"share-button",onClick:a[1]||(a[1]=(...e)=>n.openShare&&n.openShare(...e))},[e.createElementVNode("text",{class:"share-icon"},"📤")])])]),e.createElementVNode("view",{class:"user-card"},[e.createElementVNode("view",{class:"avatar"},[e.createElementVNode("view",{class:"cat-avatar"},[e.createElementVNode("view",{class:"cat-body"}),e.createElementVNode("view",{class:"cat-ears"},[e.createElementVNode("view",{class:"ear ear-left"}),e.createElementVNode("view",{class:"ear ear-right"})]),e.createElementVNode("view",{class:"cat-face"},[e.createElementVNode("view",{class:"cat-eyes"},[e.createElementVNode("view",{class:"cat-eye eye-left"}),e.createElementVNode("view",{class:"cat-eye eye-right"})]),e.createElementVNode("view",{class:"cat-nose"}),e.createElementVNode("view",{class:"cat-mouth"})])])]),e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("text",{class:"username"},e.toDisplayString(i.userInfo.username||"猫又屋之主"),1),e.createElementVNode("text",{class:"location"},e.toDisplayString(i.userInfo.location||"中国-南京"),1),e.createElementVNode("view",{class:"vip-info"},[e.createElementVNode("text",{class:"vip-text"},"VIP lv"+e.toDisplayString(i.userInfo.level||10),1),e.createElementVNode("text",{class:"exp-text"},"经验"+e.toDisplayString(i.userInfo.gold||0)+"/"+e.toDisplayString(400*(i.userInfo.level||10)),1)])])]),e.createElementVNode("view",{class:"signature-area",onClick:a[5]||(a[5]=(...e)=>n.editSignature&&n.editSignature(...e))},[i.isEditing?(e.openBlock(),e.createElementBlock("view",{key:1,class:"signature-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"signature-input","onUpdate:modelValue":a[2]||(a[2]=e=>i.signatureText=e),maxlength:100,placeholder:"请输入个性签名",onBlur:a[3]||(a[3]=(...e)=>n.saveSignature&&n.saveSignature(...e)),onInput:a[4]||(a[4]=(...e)=>n.updateCharCount&&n.updateCharCount(...e)),focus:""},null,544),[[e.vModelText,i.signatureText]]),e.createElementVNode("view",{class:"char-count"},e.toDisplayString(i.charCount)+"/100",1)])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"signature-input-container"},[e.createElementVNode("text",{class:"signature-text"},e.toDisplayString(i.signatureText),1)]))]),i.isEditing&&i.isMobile?(e.openBlock(),e.createElementBlock("view",{key:0,class:"virtual-keyboard"},[e.createElementVNode("view",{class:"keyboard-row"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["1","2","3","4","5","6","7","8","9","0"],(t=>e.createElementVNode("view",{class:"key",key:t},[e.createElementVNode("text",{class:"key-text"},e.toDisplayString(t),1)]))),64))]),e.createElementVNode("view",{class:"keyboard-row"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["q","w","e","r","t","y","u","i","o","p"],(t=>e.createElementVNode("view",{class:"key",key:t},[e.createElementVNode("text",{class:"key-text"},e.toDisplayString(t),1)]))),64))]),e.createElementVNode("view",{class:"keyboard-row"},[e.createElementVNode("view",{class:"key shift-key"},[e.createElementVNode("text",{class:"key-text"},"⇧")]),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["a","s","d","f","g","h","j","k","l"],(t=>e.createElementVNode("view",{class:"key",key:t},[e.createElementVNode("text",{class:"key-text"},e.toDisplayString(t),1)]))),64)),e.createElementVNode("view",{class:"key backspace-key"},[e.createElementVNode("text",{class:"key-text"},"⌫")])]),e.createElementVNode("view",{class:"keyboard-row"},[e.createElementVNode("view",{class:"key symbol-key"},[e.createElementVNode("text",{class:"key-text"},"?123")]),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(["z","x","c","v","b","n","m"],(t=>e.createElementVNode("view",{class:"key",key:t},[e.createElementVNode("text",{class:"key-text"},e.toDisplayString(t),1)]))),64)),e.createElementVNode("view",{class:"key comma-key"},[e.createElementVNode("text",{class:"key-text"},",")])]),e.createElementVNode("view",{class:"keyboard-row bottom-row"},[e.createElementVNode("view",{class:"key emoji-key"},[e.createElementVNode("text",{class:"key-text"},"😊")]),e.createElementVNode("view",{class:"key space-key"},[e.createElementVNode("text",{class:"key-text"},"空格")]),e.createElementVNode("view",{class:"key period-key"},[e.createElementVNode("text",{class:"key-text"},".")]),e.createElementVNode("view",{class:"key enter-key"},[e.createElementVNode("text",{class:"key-text"},"完成")])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"nav-tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"dynamic"===i.activeTab}]),onClick:a[6]||(a[6]=e=>n.switchTab("dynamic"))},[e.createElementVNode("text",{class:"tab-text"},"动态"),"dynamic"===i.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tab-underline"})):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"collections"===i.activeTab}]),onClick:a[7]||(a[7]=e=>n.switchTab("collections"))},[e.createElementVNode("text",{class:"tab-text"},"收藏"),"collections"===i.activeTab?(e.openBlock(),e.createElementBlock("view",{key:0,class:"tab-underline"})):e.createCommentVNode("",!0)],2),e.createElementVNode("view",{class:"search-icon"},"🔍")]),e.createElementVNode("view",{class:"content-area"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"加载中...")])):e.createCommentVNode("",!0),i.hasError?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("text",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[8]||(a[8]=(...e)=>n.loadUserProfileData&&n.loadUserProfileData(...e))},"重试"),e.createElementVNode("button",{class:"retry-button",onClick:a[9]||(a[9]=(...e)=>n.testConnection&&n.testConnection(...e))},"测试连接")])])):e.createCommentVNode("",!0),"dynamic"!==i.activeTab||i.loading||i.hasError?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"tab-panel"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.personalPosts,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"post-item",key:a,onClick:e=>n.handlePostClick(t)},[e.createElementVNode("view",{class:"post-header"},[e.createElementVNode("view",{class:"post-avatar"},[e.createElementVNode("view",{class:"small-cat-avatar"},[e.createElementVNode("view",{class:"small-cat-body"}),e.createElementVNode("view",{class:"small-cat-face"},[e.createElementVNode("view",{class:"small-cat-eyes"},[e.createElementVNode("view",{class:"small-cat-eye"}),e.createElementVNode("view",{class:"small-cat-eye"})])])])]),e.createElementVNode("view",{class:"post-info"},[e.createElementVNode("text",{class:"post-username"},"猫又屋之主"),e.createElementVNode("text",{class:"post-time"},e.toDisplayString(t.timeAgo),1)])]),e.createElementVNode("view",{class:"post-content"},[t.contentType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content-type"},[e.createElementVNode("text",{class:"type-label"},e.toDisplayString(t.contentType)+":",1)])):e.createCommentVNode("",!0),t.textContent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"text-content"},[e.createElementVNode("text",{class:"post-title"},e.toDisplayString(t.textContent),1)])):e.createCommentVNode("",!0),t.novelInfo?(e.openBlock(),e.createElementBlock("view",{key:2,class:"novel-info"},[e.createElementVNode("text",{class:"post-title"},e.toDisplayString(t.novelInfo.title),1),e.createElementVNode("text",{class:"novel-desc"},e.toDisplayString(t.novelInfo.description),1),e.createElementVNode("text",{class:"novel-rating"},"评分: "+e.toDisplayString(t.novelInfo.rating),1)])):e.createCommentVNode("",!0),t.images&&t.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"image-content"},[e.createElementVNode("view",{class:e.normalizeClass(["image-grid",n.getImageGridClass(t.images.length)])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.images,((a,s)=>(e.openBlock(),e.createElementBlock("image",{key:s,class:"content-image",src:a,mode:"aspectFill",onClick:e.withModifiers((e=>n.previewImage(t.images,s)),["stop"])},null,8,["src","onClick"])))),128))],2)])):e.createCommentVNode("",!0),t.novelCover?(e.openBlock(),e.createElementBlock("view",{key:4,class:"main-image"},[e.createElementVNode("image",{class:"novel-cover",src:t.novelCover,mode:"aspectFill"},null,8,["src"]),t.novelInfo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"image-overlay"},[e.createElementVNode("text",{class:"overlay-title"},e.toDisplayString(t.novelInfo.title),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"engagement-metrics"},[e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleLike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isLiked}])},e.toDisplayString(n.formatCount(t.likes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleDislike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isDisliked}])},e.toDisplayString(n.formatCount(t.dislikes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleFavorite(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isFavorited}])},"⭐",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isFavorited}])},e.toDisplayString(n.formatCount(t.favorites)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleComment(t)),["stop"])},[e.createElementVNode("text",{class:"metric-icon"},"💬"),e.createElementVNode("text",{class:"metric-count"},e.toDisplayString(n.formatCount(t.comments)),1)],8,["onClick"])])],8,["onClick"])))),128))])),"collections"!==i.activeTab||i.loading||i.hasError?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:3,class:"tab-panel"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.collectedPosts,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"post-item",key:a,onClick:e=>n.handlePostClick(t)},[e.createElementVNode("view",{class:"post-header"},[e.createElementVNode("view",{class:"post-avatar"},[e.createElementVNode("view",{class:"small-cat-avatar"},[e.createElementVNode("view",{class:"small-cat-body"}),e.createElementVNode("view",{class:"small-cat-face"},[e.createElementVNode("view",{class:"small-cat-eyes"},[e.createElementVNode("view",{class:"small-cat-eye"}),e.createElementVNode("view",{class:"small-cat-eye"})])])])]),e.createElementVNode("view",{class:"post-info"},[e.createElementVNode("text",{class:"post-username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:"post-time"},e.toDisplayString(t.timeAgo),1)])]),e.createElementVNode("view",{class:"post-content"},[t.contentType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content-type"},[e.createElementVNode("text",{class:"type-label"},e.toDisplayString(t.contentType)+":",1)])):e.createCommentVNode("",!0),t.textContent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"text-content"},[e.createElementVNode("text",{class:"post-title"},e.toDisplayString(t.textContent),1)])):e.createCommentVNode("",!0),t.novelInfo?(e.openBlock(),e.createElementBlock("view",{key:2,class:"novel-info"},[e.createElementVNode("text",{class:"post-title"},e.toDisplayString(t.novelInfo.title),1),e.createElementVNode("text",{class:"novel-desc"},e.toDisplayString(t.novelInfo.description),1),e.createElementVNode("text",{class:"novel-rating"},"评分: "+e.toDisplayString(t.novelInfo.rating),1)])):e.createCommentVNode("",!0),t.images&&t.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:3,class:"image-content"},[e.createElementVNode("view",{class:e.normalizeClass(["image-grid",n.getImageGridClass(t.images.length)])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.images,((a,s)=>(e.openBlock(),e.createElementBlock("image",{key:s,class:"content-image",src:a,mode:"aspectFill",onClick:e.withModifiers((e=>n.previewImage(t.images,s)),["stop"])},null,8,["src","onClick"])))),128))],2)])):e.createCommentVNode("",!0),t.novelCover?(e.openBlock(),e.createElementBlock("view",{key:4,class:"main-image"},[e.createElementVNode("image",{class:"novel-cover",src:t.novelCover,mode:"aspectFill"},null,8,["src"]),t.novelInfo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"image-overlay"},[e.createElementVNode("text",{class:"overlay-title"},e.toDisplayString(t.novelInfo.title),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"engagement-metrics"},[e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleLike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isLiked}])},e.toDisplayString(n.formatCount(t.likes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleDislike(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isDisliked}])},e.toDisplayString(n.formatCount(t.dislikes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleFavorite(t)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isFavorited}])},"⭐",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isFavorited}])},e.toDisplayString(n.formatCount(t.favorites)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleComment(t)),["stop"])},[e.createElementVNode("text",{class:"metric-icon"},"💬"),e.createElementVNode("text",{class:"metric-count"},e.toDisplayString(n.formatCount(t.comments)),1)],8,["onClick"])])],8,["onClick"])))),128))]))]),i.showShare?(e.openBlock(),e.createElementBlock("view",{key:1,class:"share-overlay",onClick:a[17]||(a[17]=(...e)=>n.closeShare&&n.closeShare(...e))},[e.createElementVNode("view",{class:"share-sheet",onClick:a[16]||(a[16]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"sheet-handle"}),e.createElementVNode("text",{class:"sheet-title"},"分享到"),e.createElementVNode("view",{class:"share-friends"},[e.createElementVNode("scroll-view",{class:"friends-scroll","scroll-x":"true"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.shareFriends,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"friend-item",key:a,onClick:e=>n.shareToFriend(t)},[e.createElementVNode("view",{class:"friend-avatar"},[e.createElementVNode("image",{class:"friend-avatar-img",src:t.avatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("text",{class:"friend-name"},e.toDisplayString(t.name.length>3?t.name.substring(0,3)+"...":t.name),1)],8,["onClick"])))),128))])]),e.createElementVNode("view",{class:"share-options"},[e.createElementVNode("view",{class:"share-option",onClick:a[10]||(a[10]=(...e)=>n.shareToWechat&&n.shareToWechat(...e))},[e.createElementVNode("view",{class:"share-icon-bg wechat"},[e.createElementVNode("image",{class:"share-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"微信")]),e.createElementVNode("view",{class:"share-option",onClick:a[11]||(a[11]=(...e)=>n.shareToMoments&&n.shareToMoments(...e))},[e.createElementVNode("view",{class:"share-icon-bg moments"},[e.createElementVNode("image",{class:"share-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"朋友圈")]),e.createElementVNode("view",{class:"share-option",onClick:a[12]||(a[12]=(...e)=>n.shareToDouyin&&n.shareToDouyin(...e))},[e.createElementVNode("view",{class:"share-icon-bg douyin"},[e.createElementVNode("image",{class:"share-icon-img",src:B,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"抖音好友")]),e.createElementVNode("view",{class:"share-option",onClick:a[13]||(a[13]=(...e)=>n.shareToDouyinPost&&n.shareToDouyinPost(...e))},[e.createElementVNode("view",{class:"share-icon-bg douyin-post"},[e.createElementVNode("image",{class:"share-icon-img",src:B,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"发布到抖音")]),e.createElementVNode("view",{class:"share-option",onClick:a[14]||(a[14]=(...e)=>n.shareToQQ&&n.shareToQQ(...e))},[e.createElementVNode("view",{class:"share-icon-bg qq"},[e.createElementVNode("image",{class:"share-icon-img",src:D,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"QQ")])]),e.createElementVNode("view",{class:"sheet-cancel",onClick:a[15]||(a[15]=(...e)=>n.closeShare&&n.closeShare(...e))},[e.createElementVNode("text",{class:"cancel-text"},"取消")])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"bottom-nav"},[e.createElementVNode("view",{class:"nav-item",onClick:a[18]||(a[18]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item"},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item active",onClick:a[19]||(a[19]=(...e)=>n.goToAIList&&n.goToAIList(...e))},[e.createElementVNode("view",{class:"ai-icon"},"AI")]),e.createElementVNode("view",{class:"nav-item",onClick:a[20]||(a[20]=(...e)=>n.goToFriendList&&n.goToFriendList(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-item",onClick:a[21]||(a[21]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("view",{class:"nav-avatar"},[e.createElementVNode("view",{class:"mini-cat-avatar"},[e.createElementVNode("view",{class:"mini-cat-body"}),e.createElementVNode("view",{class:"mini-cat-face"},[e.createElementVNode("view",{class:"mini-cat-eyes"},[e.createElementVNode("view",{class:"mini-cat-eye"}),e.createElementVNode("view",{class:"mini-cat-eye"})])])])])])]),e.createElementVNode("view",{class:"home-indicator"}),e.createElementVNode("view",{class:e.normalizeClass(["side-menu",{active:i.showSideMenu}]),onClick:a[36]||(a[36]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("view",{class:"menu-content",onClick:a[35]||(a[35]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"menu-header"},[e.createElementVNode("view",{class:"menu-close",onClick:a[22]||(a[22]=(...e)=>n.closeSideMenu&&n.closeSideMenu(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"menu-list"},[e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[23]||(a[23]=(...e)=>n.goToMyAI&&n.goToMyAI(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的AI")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[24]||(a[24]=(...e)=>n.goToMyCertification&&n.goToMyCertification(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的认证")]),e.createElementVNode("view",{class:"menu-item",onClick:a[25]||(a[25]=(...e)=>n.goToMyPreferences&&n.goToMyPreferences(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的喜恶")]),e.createElementVNode("view",{class:"menu-item",onClick:a[26]||(a[26]=(...e)=>n.goToMyAchievements&&n.goToMyAchievements(...e))},[e.createElementVNode("text",{class:"menu-text"},"我的成就")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[27]||(a[27]=(...e)=>n.goToAlbum&&n.goToAlbum(...e))},[e.createElementVNode("text",{class:"menu-text"},"相册")]),e.createElementVNode("view",{class:"menu-item",onClick:a[28]||(a[28]=(...e)=>n.goToHistoryComments&&n.goToHistoryComments(...e))},[e.createElementVNode("text",{class:"menu-text"},"历史评论")]),e.createElementVNode("view",{class:"menu-item",onClick:a[29]||(a[29]=(...e)=>n.goToBrowsingHistory&&n.goToBrowsingHistory(...e))},[e.createElementVNode("text",{class:"menu-text"},"浏览记录")]),e.createElementVNode("view",{class:"menu-item",onClick:a[30]||(a[30]=(...e)=>n.goToDraftBox&&n.goToDraftBox(...e))},[e.createElementVNode("text",{class:"menu-text"},"草稿箱")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[31]||(a[31]=(...e)=>n.goToPurchaseRecord&&n.goToPurchaseRecord(...e))},[e.createElementVNode("text",{class:"menu-text"},"购买记录")]),e.createElementVNode("view",{class:"menu-item",onClick:a[32]||(a[32]=(...e)=>n.goToShoppingCart&&n.goToShoppingCart(...e))},[e.createElementVNode("text",{class:"menu-text"},"购物车")]),e.createElementVNode("view",{class:"menu-item",onClick:a[33]||(a[33]=(...e)=>n.goToWallet&&n.goToWallet(...e))},[e.createElementVNode("text",{class:"menu-text"},"钱包")])]),e.createElementVNode("view",{class:"menu-section"},[e.createElementVNode("view",{class:"menu-item",onClick:a[34]||(a[34]=(...e)=>n.goToEditProfile&&n.goToEditProfile(...e))},[e.createElementVNode("text",{class:"menu-text"},"编辑资料")])])])])],2)])}]]);const b=a({name:"MyComments",data:()=>({}),methods:{goBack(){uni.navigateBack()},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){uni.navigateTo({url:"/pages/chat/chat"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"my-comments-page"},[e.createElementVNode("view",{class:"comments-container"},[e.createElementVNode("view",{class:"comment-item"},[e.createElementVNode("view",{class:"comment-left"},[e.createElementVNode("view",{class:"user-avatar"},[e.createElementVNode("view",{class:"cat-avatar"},[e.createElementVNode("view",{class:"cat-body"}),e.createElementVNode("view",{class:"cat-face"},[e.createElementVNode("view",{class:"cat-eyes"},[e.createElementVNode("view",{class:"cat-eye"}),e.createElementVNode("view",{class:"cat-eye"})])])])]),e.createElementVNode("view",{class:"comment-info"},[e.createElementVNode("text",{class:"username"},"猫又屋之主"),e.createElementVNode("text",{class:"timestamp"},"刚刚"),e.createElementVNode("text",{class:"comment-text"},"有点太雷了,报看"),e.createElementVNode("view",{class:"action-button"},[e.createElementVNode("text",{class:"like-icon"},"👍")])])]),e.createElementVNode("view",{class:"comment-right"},[e.createElementVNode("view",{class:"content-thumbnail"},[e.createElementVNode("view",{class:"thumbnail-placeholder"})])])]),e.createElementVNode("view",{class:"comment-item"},[e.createElementVNode("view",{class:"comment-left"},[e.createElementVNode("view",{class:"user-avatar"},[e.createElementVNode("view",{class:"cat-avatar"},[e.createElementVNode("view",{class:"cat-body"}),e.createElementVNode("view",{class:"cat-face"},[e.createElementVNode("view",{class:"cat-eyes"},[e.createElementVNode("view",{class:"cat-eye"}),e.createElementVNode("view",{class:"cat-eye"})])])])]),e.createElementVNode("view",{class:"comment-info"},[e.createElementVNode("text",{class:"username"},"猫又屋之主"),e.createElementVNode("text",{class:"timestamp"},"2小时前"),e.createElementVNode("text",{class:"comment-text"},"非常好猫猫,爱来自瓷器"),e.createElementVNode("view",{class:"action-button"},[e.createElementVNode("text",{class:"like-icon"},"👍")])])]),e.createElementVNode("view",{class:"comment-right"},[e.createElementVNode("view",{class:"content-thumbnail"},[e.createElementVNode("view",{class:"thumbnail-placeholder cat-thumbnail"})])])])]),e.createElementVNode("view",{class:"bottom-navigation"},[e.createElementVNode("view",{class:"nav-item",onClick:a[0]||(a[0]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"nav-text"},"首页")]),e.createElementVNode("view",{class:"nav-item",onClick:a[1]||(a[1]=(...e)=>n.goToChatList&&n.goToChatList(...e))},[e.createElementVNode("text",{class:"nav-text"},"消息")]),e.createElementVNode("view",{class:"nav-item",onClick:a[2]||(a[2]=(...e)=>n.goToAIChat&&n.goToAIChat(...e))},[e.createElementVNode("view",{class:"ai-tab"},[e.createElementVNode("text",{class:"ai-text"},"AI")])]),e.createElementVNode("view",{class:"nav-item",onClick:a[3]||(a[3]=(...e)=>n.goToFriendList&&n.goToFriendList(...e))},[e.createElementVNode("text",{class:"nav-text"},"好友")]),e.createElementVNode("view",{class:"nav-avatar",onClick:a[4]||(a[4]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("image",{class:"avatar-small",src:"",mode:"aspectFill"})])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const M=a({name:"NovelDetailPage",data:()=>({novelId:"",userId:1000100,novelTitle:"",synopsisExpanded:!1,reviewExpanded:[!1,!1],showNovelContent:!1,isFollowed:!1,scrollTop:0,loading:!1,hasError:!1,errorMessage:"",novelData:{title:"游戏降临: 我要这个这个还有这个 (游戏入侵)",author:"猫不秃",rating:"9.5",reviewCount:"11.9万人点评",readerCount:"157.4万人",wordCount:"214.7万字",updateDays:"连续更新268天",coverImage:"/static/novel-cover.jpg",tags:["#原创小说","#游戏体育","#重生","#无CP"],synopsis:"【游戏入侵+无cp+升级流+独狼+游戏】(又名: 游戏入侵) 这是一个关于游戏入侵现实的故事，主角在游戏中获得了强大的能力，开始了一段惊险刺激的冒险之旅。故事融合了游戏元素和现实世界，充满了悬念和惊喜。主角从一个普通玩家逐渐成长为游戏世界的强者，在这个过程中不仅要面对游戏中的挑战，还要处理现实世界中的各种问题。",reviews:[{reviewer:"书友123456",avatar:"/static/avatar1.png",content:"文笔剧情很好,很难得的女强无cp游戏侵入现实的文,世界观设计都很有画面感,女主也很聪明,抓...",readTime:"阅读不足30分钟后点评"},{reviewer:"书友789012",avatar:"/static/avatar2.png",content:"现在更的全部看完了,技能/道具/天赋设定都好新颖,不会一样望去就猜的大差不差食之无味。而且主角的成长路线很合理，每个阶段都有相应的挑战和收获，让人看得停不下来。",readTime:"阅读3小时后点评"}],chapters:[]}}),onLoad(e){o("log","at pages/feed/novel-detail.vue:228","=== 小说详情页面加载 ==="),o("log","at pages/feed/novel-detail.vue:229","接收到的参数:",e),e.id&&(this.novelId=e.id),e.userId&&(this.userId=parseInt(e.userId)),e.title&&(this.novelTitle=decodeURIComponent(e.title),this.novelData.title=this.novelTitle),e.author&&(this.novelData.author=decodeURIComponent(e.author)),e.rating&&(this.novelData.rating=decodeURIComponent(e.rating)),e.reviewCount&&(this.novelData.reviewCount=decodeURIComponent(e.reviewCount)),e.readerCount&&(this.novelData.readerCount=decodeURIComponent(e.readerCount)),e.wordCount&&(this.novelData.wordCount=decodeURIComponent(e.wordCount)),e.updateDays&&(this.novelData.updateDays=decodeURIComponent(e.updateDays)),e.tags&&(this.novelData.tags=decodeURIComponent(e.tags).split(",")),e.synopsis&&(this.novelData.synopsis=decodeURIComponent(e.synopsis)),this.novelId?this.loadNovelDetailFromAPI():this.loadNovelData(),o("log","at pages/feed/novel-detail.vue:277","更新后的小说数据:",this.novelData)},methods:{async loadNovelDetailFromAPI(){try{o("log","at pages/feed/novel-detail.vue:283","=== 开始从后端加载小说详情数据 ==="),o("log","at pages/feed/novel-detail.vue:284","小说ID:",this.novelId),o("log","at pages/feed/novel-detail.vue:285","用户ID:",this.userId),o("log","at pages/feed/novel-detail.vue:286","请求URL:",`http://localhost:8888/api/novel-detail/data?novelId=${this.novelId}&userId=${this.userId}`),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/novel-detail/data?novelId=${this.novelId}&userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/novel-detail.vue:300","=== 小说详情API响应详情 ==="),o("log","at pages/feed/novel-detail.vue:301","状态码:",e.statusCode),o("log","at pages/feed/novel-detail.vue:302","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;this.novelData={...this.novelData,...t,title:t.title||this.novelData.title,author:t.author||this.novelData.author,rating:t.rating||this.novelData.rating,reviewCount:t.reviewCount||this.novelData.reviewCount,readerCount:t.readerCount||this.novelData.readerCount,wordCount:t.wordCount||this.novelData.wordCount,updateDays:t.updateDays||this.novelData.updateDays,coverImage:t.coverImage||this.novelData.coverImage,tags:t.tags||this.novelData.tags,synopsis:t.synopsis||this.novelData.synopsis,chapters:t.chapters||[],reviews:t.reviews||[]},this.isFollowed=t.isFavorited||!1,o("log","at pages/feed/novel-detail.vue:329","成功加载小说详情数据"),o("log","at pages/feed/novel-detail.vue:330","章节数量:",this.novelData.chapters.length),o("log","at pages/feed/novel-detail.vue:331","书评数量:",this.novelData.reviews.length),o("log","at pages/feed/novel-detail.vue:332","书评数据:",this.novelData.reviews),uni.showToast({title:"加载成功",icon:"success",duration:1500})}else o("error","at pages/feed/novel-detail.vue:342","加载小说详情数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载数据失败",uni.showToast({title:"加载数据失败",icon:"error"})}catch(e){o("error","at pages/feed/novel-detail.vue:351","加载小说详情数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}},loadNovelData(){const e={1:{title:"神秘的猫又",author:"猫又屋之主",rating:"4.5",reviewCount:"2.3万人点评",readerCount:"45.2万人",wordCount:"156.8万字",updateDays:"连续更新156天",coverImage:"/static/novel-cover.png",tags:["#原创小说","#奇幻","#猫又","#冒险"],synopsis:"在一个古老的村庄里，流传着一个关于猫又的神秘传说。主角意外获得了猫又的力量，开始了一段惊险刺激的冒险之旅。故事融合了东方神话和现代元素，充满了悬念和惊喜。",reviews:[{reviewer:"书友猫奴001",avatar:"/static/avatar1.png",content:"猫又题材很新颖，文笔流畅，剧情紧凑。主角的成长路线很合理，每个阶段都有相应的挑战和收获。",readTime:"阅读2小时后点评"},{reviewer:"书友奇幻迷",avatar:"/static/avatar2.png",content:"世界观设定很有创意，猫又的能力系统设计得很完整。作者对细节的把控很到位，让人看得停不下来。",readTime:"阅读5小时后点评"}]},2:{title:"猫又的奇幻之旅",author:"猫又屋之主",rating:"4.8",reviewCount:"3.1万人点评",readerCount:"67.8万人",wordCount:"298.5万字",updateDays:"连续更新298天",coverImage:"/static/novel-cover.png",tags:["#原创小说","#奇幻","#猫又","#成长"],synopsis:"猫又发现了一个通往神秘世界的传送门。在这个充满魔法和危险的世界里，她必须学会运用自己的力量，结交朋友，面对各种挑战。这是一个关于成长、友情和勇气的故事。",reviews:[{reviewer:"书友冒险家",avatar:"/static/avatar3.png",content:"传送门设定很吸引人，每个世界都有独特的规则和文化。主角的成长过程很真实，不是一蹴而就的。",readTime:"阅读8小时后点评"},{reviewer:"书友魔法师",avatar:"/static/avatar4.png",content:"魔法系统设计得很完整，世界观构建得很详细。每个角色都有鲜明的个性，剧情发展很合理。",readTime:"阅读12小时后点评"}]},4:{title:"游戏降临: 我要这个这个还有这个 (游戏入侵)",author:"猫不秃",rating:"9.5",reviewCount:"11.9万人点评",readerCount:"157.4万人",wordCount:"214.7万字",updateDays:"连续更新268天",coverImage:"/static/novel-cover.jpg",tags:["#原创小说","#游戏体育","#重生","#无CP"],synopsis:"【游戏入侵+无cp+升级流+独狼+游戏】(又名: 游戏入侵) 这是一个关于游戏入侵现实的故事，主角在游戏中获得了强大的能力，开始了一段惊险刺激的冒险之旅。故事融合了游戏元素和现实世界，充满了悬念和惊喜。主角从一个普通玩家逐渐成长为游戏世界的强者，在这个过程中不仅要面对游戏中的挑战，还要处理现实世界中的各种问题。",reviews:[{reviewer:"书友123456",avatar:"/static/avatar1.png",content:"文笔剧情很好,很难得的女强无cp游戏侵入现实的文,世界观设计都很有画面感,女主也很聪明,抓...",readTime:"阅读不足30分钟后点评"},{reviewer:"书友789012",avatar:"/static/avatar2.png",content:"现在更的全部看完了,技能/道具/天赋设定都好新颖,不会一样望去就猜的大差不差食之无味。而且主角的成长路线很合理，每个阶段都有相应的挑战和收获，让人看得停不下来。",readTime:"阅读3小时后点评"}]}};if(e[this.novelId]){const t=e[this.novelId];this.novelData={...this.novelData,...t},this.synopsisExpanded=!1,this.reviewExpanded=new Array(t.reviews.length).fill(!1)}},goBack(){uni.navigateBack()},startListening(){uni.showToast({title:"听书功能开发中",icon:"none"})},followAuthor(){this.isFollowed=!this.isFollowed,uni.showToast({title:this.isFollowed?"关注成功":"取消关注",icon:"success"})},toggleSynopsis(){this.synopsisExpanded=!this.synopsisExpanded},toggleReview(e){this.$set(this.reviewExpanded,e,!this.reviewExpanded[e])},goToMoreReviews(){uni.navigateTo({url:`/pages/feed/novel-more-reviews?novelId=${this.novelId}&title=${encodeURIComponent(this.novelData.title)}&author=${encodeURIComponent(this.novelData.author)}`})},async handleReviewLike(e,t){try{o("log","at pages/feed/novel-detail.vue:492","=== 开始处理书评点赞 ==="),o("log","at pages/feed/novel-detail.vue:493","用户ID:",this.userId),o("log","at pages/feed/novel-detail.vue:494","评论ID:",e.commentId);const t=await uni.request({url:`http://localhost:8888/api/novel-detail/comment/like?userId=${this.userId}&commentId=${e.commentId}`,method:"POST",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/novel-detail.vue:504","=== 书评点赞API响应 ==="),o("log","at pages/feed/novel-detail.vue:505","状态码:",t.statusCode),o("log","at pages/feed/novel-detail.vue:506","响应数据:",t.data),200===t.statusCode&&t.data.success){const a=t.data.data;e.isLiked=a.isLiked,e.likes=a.likeCount,e.isLiked&&e.isDisliked&&(e.isDisliked=!1,e.dislikes--),uni.showToast({title:a.message,icon:"success",duration:1e3})}else o("error","at pages/feed/novel-detail.vue:527","书评点赞失败:",t.data.message),uni.showToast({title:t.data.message||"操作失败",icon:"error"})}catch(a){o("error","at pages/feed/novel-detail.vue:534","书评点赞异常:",a),uni.showToast({title:"网络错误",icon:"error"})}},handleReviewDislike(e,t){e.isDisliked=!e.isDisliked,e.isDisliked?(e.dislikes++,e.isLiked&&(e.isLiked=!1,e.likes--)):e.dislikes--,uni.showToast({title:e.isDisliked?"点踩成功":"取消点踩",icon:"success",duration:1e3})},handleReviewComment(e,t){uni.navigateTo({url:`/pages/feed/novel-more-reviews?novelId=${this.novelId}&title=${encodeURIComponent(this.novelData.title)}&author=${encodeURIComponent(this.novelData.author)}&commentId=${e.commentId}`})},formatCount:e=>e>=1e4?(e/1e4).toFixed(1)+"w":e.toString(),startReading(){o("log","at pages/feed/novel-detail.vue:577","开始滚动到小说内容区域"),this.scrollTop=1200,setTimeout((()=>{uni.pageScrollTo({scrollTop:1120,duration:100})}),50)},onScroll(e){}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"novel-detail-page"},[e.createElementVNode("scroll-view",{class:"content-scroll","scroll-y":"true","scroll-top":i.scrollTop,onScroll:a[5]||(a[5]=(...e)=>n.onScroll&&n.onScroll(...e))},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载小说详情...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.loadNovelDetailFromAPI&&n.loadNovelDetailFromAPI(...e))},"重新加载")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2},[e.createElementVNode("view",{class:"novel-cover-section"},[e.createElementVNode("image",{class:"novel-cover",src:i.novelData.coverImage||"",mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"novel-info-section"},[e.createElementVNode("text",{class:"novel-title"},e.toDisplayString(i.novelData.title||"小说名"),1),e.createElementVNode("view",{class:"author-section"},[e.createElementVNode("text",{class:"author-name"},e.toDisplayString(i.novelData.author||"小说作者"),1),e.createElementVNode("view",{class:"follow-button",onClick:a[1]||(a[1]=(...e)=>n.followAuthor&&n.followAuthor(...e))},[e.createElementVNode("text",{class:"follow-text"},e.toDisplayString(i.isFollowed?"已关注":"+关注"),1)])])]),e.createElementVNode("view",{class:"stats-section"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(i.novelData.rating||"9.5")+"分",1),e.createElementVNode("text",{class:"stat-label"},e.toDisplayString(i.novelData.reviewCount||"11.9万人点评"),1)]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(i.novelData.readerCount||"157.4万人"),1),e.createElementVNode("text",{class:"stat-label"},"正在阅读")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(i.novelData.wordCount||"214.7万字"),1),e.createElementVNode("text",{class:"stat-label"},e.toDisplayString(i.novelData.updateDays||"连续更新268天"),1)])]),e.createElementVNode("view",{class:"synopsis-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"简介")]),e.createElementVNode("view",{class:"tags-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.novelData.tags,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"tag",key:a},[e.createElementVNode("text",{class:"tag-text"},e.toDisplayString(t),1)])))),128))]),e.createElementVNode("view",{class:"synopsis-content"},[e.createElementVNode("text",{class:e.normalizeClass(["synopsis-text",{expanded:i.synopsisExpanded}])},e.toDisplayString(i.novelData.synopsis||"【游戏入侵+unp+升级流+独狼+游戏】(又名: 游戏入侵) 这是一个关于游戏入侵现实的故事，主角在游戏中获得了强大的能力，开始了一段惊险刺激的冒险之旅。故事融合了游戏元素和现实世界，充满了悬念和惊喜。主角从一个普通玩家逐渐成长为游戏世界的强者，在这个过程中不仅要面对游戏中的挑战，还要处理现实世界中的各种问题。"),3),i.novelData.synopsis&&i.novelData.synopsis.length>80?(e.openBlock(),e.createElementBlock("view",{key:0,class:"expand-button",onClick:a[2]||(a[2]=(...e)=>n.toggleSynopsis&&n.toggleSynopsis(...e))},[e.createElementVNode("text",{class:"expand-text"},e.toDisplayString(i.synopsisExpanded?"收起":"展开"),1)])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"reviews-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"热门书评"),e.createElementVNode("view",{class:"more-reviews",onClick:a[3]||(a[3]=(...e)=>n.goToMoreReviews&&n.goToMoreReviews(...e))},[e.createElementVNode("text",{class:"more-text"},"更多书评")])]),i.novelData.reviews&&i.novelData.reviews.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"reviews-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.novelData.reviews,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"review-item",key:a},[e.createElementVNode("view",{class:"review-header"},[e.createElementVNode("image",{class:"reviewer-avatar",src:t.avatar||"/static/avatar-default.png",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"review-info"},[e.createElementVNode("text",{class:"reviewer-name"},e.toDisplayString(t.reviewer),1),e.createElementVNode("view",{class:"review-rating"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.rating,(t=>(e.openBlock(),e.createElementBlock("text",{class:"star",key:t},"★")))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(5-t.rating,(t=>(e.openBlock(),e.createElementBlock("text",{class:"star empty",key:t},"☆")))),128))]),e.createElementVNode("text",{class:"review-time"},e.toDisplayString(t.time),1)])]),e.createElementVNode("text",{class:e.normalizeClass(["review-content",{expanded:i.reviewExpanded[a]}])},e.toDisplayString(t.content),3),t.content&&t.content.length>80?(e.openBlock(),e.createElementBlock("view",{key:0,class:"expand-button",onClick:e=>n.toggleReview(a)},[e.createElementVNode("text",{class:"expand-text"},e.toDisplayString(i.reviewExpanded[a]?"收起":"展开"),1)],8,["onClick"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"review-actions"},[e.createElementVNode("view",{class:"action-item",onClick:e.withModifiers((e=>n.handleReviewLike(t,a)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["action-count",{active:t.isLiked}])},e.toDisplayString(n.formatCount(t.likes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"action-item",onClick:e.withModifiers((e=>n.handleReviewDislike(t,a)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:t.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["action-count",{active:t.isDisliked}])},e.toDisplayString(n.formatCount(t.dislikes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"action-item",onClick:e.withModifiers((e=>n.handleReviewComment(t,a)),["stop"])},[e.createElementVNode("text",{class:"action-icon"},"💬"),e.createElementVNode("text",{class:"action-count"},e.toDisplayString(n.formatCount(t.comments)),1)],8,["onClick"])])])))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no-reviews"},[e.createElementVNode("text",{class:"no-reviews-text"},'暂无书评，点击"更多书评"查看全部')]))]),e.createElementVNode("view",{class:"read-button-container"},[e.createElementVNode("view",{class:"read-button",onClick:a[4]||(a[4]=(...e)=>n.startReading&&n.startReading(...e))},[e.createElementVNode("view",{class:"arrow-up"}),e.createElementVNode("text",{class:"read-text"},"上滑开始阅读")])]),e.createElementVNode("view",{class:"novel-content-section"},[e.createElementVNode("view",{class:"chapter-title"},[e.createElementVNode("text",{class:"chapter-text"},"第一章 兰亭序全文（晋）王羲之")]),e.createElementVNode("view",{class:"novel-text"},[e.createElementVNode("text",{class:"novel-paragraph"},"永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。"),e.createElementVNode("text",{class:"novel-paragraph"},"此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。"),e.createElementVNode("text",{class:"novel-paragraph"},"是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。"),e.createElementVNode("text",{class:"novel-paragraph"},"夫人之相与，俯仰一世，或取诸怀抱，晤言一室之内；或因寄所托，放浪形骸之外。虽取舍万殊，静躁不同，当其欣于所遇，暂得于己，快然自足，不知老之将至。"),e.createElementVNode("text",{class:"novel-paragraph"},"及其所之既倦，情随事迁，感慨系之矣。向之所欣，俯仰之间，已为陈迹，犹不能不以之兴怀。况修短随化，终期于尽。"),e.createElementVNode("text",{class:"novel-paragraph"},'古人云："死生亦大矣。"岂不痛哉！每览昔人兴感之由，若合一契，未尝不临文嗟悼，不能喻之于怀。'),e.createElementVNode("text",{class:"novel-paragraph"},"固知一死生为虚诞，齐彭殇为妄作。后之视今，亦犹今之视昔。"),e.createElementVNode("text",{class:"novel-paragraph"},"悲夫！故列叙时人，录其所述，虽世殊事异，所以兴怀，其致一也。后之览者，亦将有感于斯文。")])]),e.createElementVNode("view",{class:"bottom-spacer"})]))],40,["scroll-top"])])}]]);const P=a({name:"NovelMoreReviewsPage",data:()=>({novelId:"",novelTitle:"",novelAuthor:"",userId:1000100,isRefreshing:!1,showRefreshIndicator:!1,refreshText:"下拉刷新",pullDistance:0,commentText:"",replyToComment:null,replyToReply:null,showShare:!1,loading:!1,hasError:!1,errorMessage:"",shareFriends:[{name:"奶绿冰阔落",avatar:"/static/avatar-default.png"},{name:"我想次炸鸡",avatar:"/static/avatar-default.png"},{name:"匿名为某",avatar:"/static/avatar-default.png"},{name:"康已奀",avatar:"/static/avatar-default.png"},{name:"小菜刀御",avatar:"/static/avatar-default.png"},{name:"超级好",avatar:"/static/avatar-default.png"},{name:"QQ好友七",avatar:"/static/avatar-default.png"}],reviews:[]}),onLoad(e){o("log","at pages/feed/novel-more-reviews.vue:245","=== 更多书评页面加载 ==="),o("log","at pages/feed/novel-more-reviews.vue:246","接收到的参数:",e),e.novelId&&(this.novelId=e.novelId),e.title&&(this.novelTitle=decodeURIComponent(e.title)),e.author&&(this.novelAuthor=decodeURIComponent(e.author)),e.userId&&(this.userId=parseInt(e.userId)),this.novelId&&this.loadNovelReviews()},methods:{async loadNovelReviews(){try{o("log","at pages/feed/novel-more-reviews.vue:271","=== 开始从后端加载书评数据 ==="),o("log","at pages/feed/novel-more-reviews.vue:272","小说ID:",this.novelId),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/novel-detail/reviews?novelId=${this.novelId}&userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/feed/novel-more-reviews.vue:286","=== 书评API响应详情 ==="),o("log","at pages/feed/novel-more-reviews.vue:287","状态码:",e.statusCode),o("log","at pages/feed/novel-more-reviews.vue:288","响应数据:",e.data),200===e.statusCode&&e.data.success?(this.reviews=e.data.data||[],o("log","at pages/feed/novel-more-reviews.vue:292","成功加载书评数据，共",this.reviews.length,"条"),0===this.reviews.length&&(this.hasError=!0,this.errorMessage="暂无书评数据")):(o("error","at pages/feed/novel-more-reviews.vue:299","加载书评数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载书评数据失败")}catch(e){o("error","at pages/feed/novel-more-reviews.vue:304","加载书评数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置"}finally{this.loading=!1}},goBack(){uni.navigateBack()},goToReviewDetail(e,t){uni.navigateTo({url:`/pages/feed/review-detail?id=${t}&reviewer=${encodeURIComponent(e.reviewer)}&content=${encodeURIComponent(e.content)}&rating=${e.rating}&time=${encodeURIComponent(e.time)}&likes=${e.likes}&dislikes=${e.dislikes}&comments=${e.comments}`})},showShare(){this.showShare=!0},hideSharePopup(){this.showShare=!1},shareToWechat(){uni.showToast({title:"分享到微信",icon:"none"}),this.hideSharePopup()},shareToMoments(){uni.showToast({title:"分享到朋友圈",icon:"none"}),this.hideSharePopup()},shareToDouyin(){uni.showToast({title:"分享到抖音好友",icon:"none"}),this.hideSharePopup()},shareToDouyinPost(){uni.showToast({title:"发布到抖音",icon:"none"}),this.hideSharePopup()},shareToQQ(){uni.showToast({title:"分享到QQ",icon:"none"}),this.hideSharePopup()},shareAction(e){uni.showToast({title:{comment:"评论设置",gift:"送礼物",bookmark:"添加书签",search:"全文搜索",report:"举报与反馈"}[e]||"功能开发中",icon:"none"}),this.hideSharePopup()},shareToFriend(e){uni.showToast({title:`分享给${e.name}`,icon:"none"}),this.hideSharePopup()},async handleLike(e){const t=this.reviews[e];if(t&&t.commentId)try{o("log","at pages/feed/novel-more-reviews.vue:410","=== 开始处理书评点赞 ==="),o("log","at pages/feed/novel-more-reviews.vue:411","用户ID:",this.userId),o("log","at pages/feed/novel-more-reviews.vue:412","评论ID:",t.commentId);const e=await uni.request({url:`http://localhost:8888/api/novel-detail/comment/like?userId=${this.userId}&commentId=${t.commentId}`,method:"POST",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/novel-more-reviews.vue:422","=== 书评点赞API响应 ==="),o("log","at pages/feed/novel-more-reviews.vue:423","状态码:",e.statusCode),o("log","at pages/feed/novel-more-reviews.vue:424","响应数据:",e.data),200===e.statusCode&&e.data.success){const a=e.data.data;t.isLiked=a.isLiked,t.likes=a.likeCount,t.isLiked&&t.isDisliked&&(t.isDisliked=!1,t.dislikes--),uni.showToast({title:a.message,icon:"success",duration:1e3})}else o("error","at pages/feed/novel-more-reviews.vue:445","书评点赞失败:",e.data.message),uni.showToast({title:e.data.message||"操作失败",icon:"error"})}catch(a){o("error","at pages/feed/novel-more-reviews.vue:452","书评点赞异常:",a),uni.showToast({title:"网络错误",icon:"error"})}else uni.showToast({title:"评论ID不存在",icon:"error"})},handleDislike(e){const t=this.reviews[e];t&&"object"==typeof t&&(t.isDisliked=!t.isDisliked,t.isDisliked?(t.dislikes++,t.isLiked&&(t.isLiked=!1,t.likes--)):t.dislikes--)},handleComment(e){const t=this.reviews[e];t&&(this.replyToComment=t,this.replyToReply=null,this.commentText="",this.$nextTick((()=>{const e=uni.createSelectorQuery().select(".comment-input");e&&e.focus()})))},previewImage(e,t){uni.previewImage({urls:e,current:t})},getImageGridClass:e=>1===e?"single-image":2===e?"two-images":3===e?"three-images":"grid-images",formatCount:e=>e>=1e4?(e/1e4).toFixed(1)+"w":e.toString(),handleFavorite(e){e.isFavorited=!e.isFavorited,e.isFavorited?e.favorites++:e.favorites--},onInputFocus(){this.inputFocus=!0},onInputBlur(){this.inputFocus=!1},submitComment(){if(this.commentText.trim()){if(this.replyToComment){const e={username:"我",userAvatar:"/static/avatar3.png",time:"刚刚",content:this.commentText,likes:0,isLiked:!1,replyTo:this.replyToReply?this.replyToReply.username:this.replyToComment.reviewer};this.replyToComment.replies||(this.replyToComment.replies=[]),this.replyToComment.replies.push(e),this.replyToComment=null,this.replyToReply=null,uni.showToast({title:"回复成功",icon:"success"})}else{const e={reviewer:"我",avatar:"/static/avatar3.png",rating:5,content:this.commentText,time:"刚刚",likes:0,dislikes:0,comments:0,isLiked:!1,isDisliked:!1,replies:[]};this.reviews.unshift(e),uni.showToast({title:"评论成功",icon:"success"})}this.commentText=""}else uni.showToast({title:"请输入评论内容",icon:"none"})},cancelReply(){o("log","at pages/feed/novel-more-reviews.vue:610","取消回复"),this.commentText="",this.replyToComment=null,this.replyToReply=null},getInputPlaceholder(){return this.replyToComment?this.replyToReply?`回复 @${this.replyToReply.username}...`:`回复 @${this.replyToComment.reviewer}...`:"说点什么..."},async onRefresh(){o("log","at pages/feed/novel-more-reviews.vue:630","开始刷新书评数据"),this.isRefreshing=!0,this.refreshText="正在刷新...";try{await this.loadNovelReviews(),this.isRefreshing=!1,this.refreshText="刷新完成",uni.showToast({title:"刷新成功",icon:"success"}),setTimeout((()=>{this.showRefreshIndicator=!1}),1e3)}catch(e){o("error","at pages/feed/novel-more-reviews.vue:652","刷新书评数据失败:",e),this.isRefreshing=!1,this.refreshText="刷新失败",uni.showToast({title:"刷新失败",icon:"error"}),setTimeout((()=>{this.showRefreshIndicator=!1}),1e3)}},onPulling(e){this.pullDistance=e.detail.dy,e.detail.dy>50?(this.showRefreshIndicator=!0,this.refreshText="释放刷新"):this.refreshText="下拉刷新"},onRestore(){o("log","at pages/feed/novel-more-reviews.vue:680","刷新器复位"),this.showRefreshIndicator=!1},onAbort(){o("log","at pages/feed/novel-more-reviews.vue:686","刷新器中止"),this.showRefreshIndicator=!1}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"more-reviews-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("view",{class:"back-arrow"})]),e.createElementVNode("view",{class:"header-title"},[e.createElementVNode("text",{class:"title-text"},"热门书评")]),e.createElementVNode("view",{class:"share-button",onClick:a[1]||(a[1]=(...e)=>n.showShare&&n.showShare(...e))},[e.createElementVNode("text",{class:"share-icon"},"📤")])]),e.createElementVNode("view",{class:"novel-card"},[e.createElementVNode("view",{class:"novel-info"},[e.createElementVNode("image",{class:"novel-cover",src:t.novelCover||"/static/novel-cover.jpg",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"novel-details"},[e.createElementVNode("text",{class:"novel-title"},e.toDisplayString(i.novelTitle||"小说标题"),1),e.createElementVNode("text",{class:"novel-author"},e.toDisplayString(i.novelAuthor||"作者"),1),e.createElementVNode("view",{class:"novel-stats"},[e.createElementVNode("text",{class:"rating"},e.toDisplayString(t.novelRating||"9.5")+"分",1),e.createElementVNode("text",{class:"reader-count"},e.toDisplayString(t.readerCount||"157.4万人在读"),1)])])])]),e.createElementVNode("scroll-view",{class:"reviews-scroll","scroll-y":"true","refresher-enabled":"true","refresher-triggered":i.isRefreshing,onRefresherrefresh:a[3]||(a[3]=(...e)=>n.onRefresh&&n.onRefresh(...e))},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载书评数据...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[2]||(a[2]=(...e)=>n.loadNovelReviews&&n.loadNovelReviews(...e))},"重新加载")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2},[i.showRefreshIndicator?(e.openBlock(),e.createElementBlock("view",{key:0,class:"refresh-indicator"},[e.createElementVNode("view",{class:e.normalizeClass(["refresh-circle",{refreshing:i.isRefreshing}])},[i.isRefreshing?(e.openBlock(),e.createElementBlock("view",{key:1,class:"refresh-spinner"})):(e.openBlock(),e.createElementBlock("view",{key:0,class:"refresh-arrow"}))],2),e.createElementVNode("text",{class:"refresh-text"},e.toDisplayString(i.refreshText),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"reviews-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.reviews,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"review-item",key:a},[e.createElementVNode("view",{class:"review-header"},[e.createElementVNode("image",{class:"reviewer-avatar",src:t.avatar,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"reviewer-info"},[e.createElementVNode("text",{class:"reviewer-name"},e.toDisplayString(t.reviewer),1),e.createElementVNode("view",{class:"review-meta"},[e.createElementVNode("view",{class:"rating-stars"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.rating,(t=>(e.openBlock(),e.createElementBlock("text",{class:"star",key:t},"★")))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(5-t.rating,(t=>(e.openBlock(),e.createElementBlock("text",{class:"star empty",key:t},"☆")))),128))]),e.createElementVNode("text",{class:"review-time"},e.toDisplayString(t.time),1)])])]),e.createElementVNode("view",{class:"review-content"},[e.createElementVNode("text",{class:"review-text"},e.toDisplayString(t.content),1)]),e.createElementVNode("view",{class:"engagement-metrics"},[e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleLike(a)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isLiked}])},e.toDisplayString(n.formatCount(t.likes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleDislike(a)),["stop"])},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:t.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:t.isDisliked}])},e.toDisplayString(n.formatCount(t.dislikes)),3)],8,["onClick"]),e.createElementVNode("view",{class:"metric-item",onClick:e.withModifiers((e=>n.handleComment(a)),["stop"])},[e.createElementVNode("text",{class:"metric-icon"},"💬"),e.createElementVNode("text",{class:"metric-count"},e.toDisplayString(n.formatCount(t.comments)),1)],8,["onClick"])]),t.replies&&t.replies.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"replies-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.replies,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"reply-item",key:a},[e.createElementVNode("view",{class:"reply-avatar"},[e.createElementVNode("image",{class:"reply-user-avatar",src:t.userAvatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"reply-content"},[e.createElementVNode("view",{class:"reply-user-info"},[e.createElementVNode("text",{class:"reply-username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:"reply-time"},e.toDisplayString(t.time),1)]),e.createElementVNode("text",{class:"reply-text"},[e.createElementVNode("text",{class:"reply-to"},"回复 @"+e.toDisplayString(t.replyTo)+"：",1),e.createTextVNode(" "+e.toDisplayString(t.content),1)])])])))),128))])):e.createCommentVNode("",!0)])))),128))])]))],40,["refresher-triggered"]),e.createElementVNode("view",{class:"comment-input-section"},[e.createElementVNode("view",{class:"comment-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"comment-input","onUpdate:modelValue":a[4]||(a[4]=e=>i.commentText=e),placeholder:n.getInputPlaceholder(),onFocus:a[5]||(a[5]=(...e)=>n.onInputFocus&&n.onInputFocus(...e)),onBlur:a[6]||(a[6]=(...e)=>n.onInputBlur&&n.onInputBlur(...e))},null,40,["placeholder"]),[[e.vModelText,i.commentText]]),i.replyToComment?(e.openBlock(),e.createElementBlock("view",{key:0,class:"cancel-reply-btn",onClick:a[7]||(a[7]=(...e)=>n.cancelReply&&n.cancelReply(...e))},[e.createElementVNode("text",{class:"cancel-reply-text"},"取消")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["send-button",{active:i.commentText.trim()}]),onClick:a[8]||(a[8]=(...e)=>n.submitComment&&n.submitComment(...e))},[e.createElementVNode("text",{class:"send-text"},"发送")],2)])]),n.showShare?(e.openBlock(),e.createElementBlock("view",{key:0,class:"share-popup",onClick:a[16]||(a[16]=(...e)=>n.hideSharePopup&&n.hideSharePopup(...e))},[e.createElementVNode("view",{class:"share-content",onClick:a[15]||(a[15]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"share-header"},[e.createElementVNode("text",{class:"share-title"},"分享到"),e.createElementVNode("view",{class:"share-close",onClick:a[9]||(a[9]=(...e)=>n.hideSharePopup&&n.hideSharePopup(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"share-friends"},[e.createElementVNode("scroll-view",{class:"friends-scroll","scroll-x":"true"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.shareFriends,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"friend-item",key:a,onClick:e=>n.shareToFriend(t)},[e.createElementVNode("view",{class:"friend-avatar"},[e.createElementVNode("image",{class:"friend-avatar-img",src:t.avatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("text",{class:"friend-name"},e.toDisplayString(t.name.length>3?t.name.substring(0,3)+"...":t.name),1)],8,["onClick"])))),128))])]),e.createElementVNode("view",{class:"share-options"},[e.createElementVNode("view",{class:"share-option",onClick:a[10]||(a[10]=(...e)=>n.shareToWechat&&n.shareToWechat(...e))},[e.createElementVNode("view",{class:"share-icon-bg wechat"},[e.createElementVNode("image",{class:"share-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"微信")]),e.createElementVNode("view",{class:"share-option",onClick:a[11]||(a[11]=(...e)=>n.shareToMoments&&n.shareToMoments(...e))},[e.createElementVNode("view",{class:"share-icon-bg moments"},[e.createElementVNode("image",{class:"share-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"朋友圈")]),e.createElementVNode("view",{class:"share-option",onClick:a[12]||(a[12]=(...e)=>n.shareToDouyin&&n.shareToDouyin(...e))},[e.createElementVNode("view",{class:"share-icon-bg douyin"},[e.createElementVNode("image",{class:"share-icon-img",src:B,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"抖音好友")]),e.createElementVNode("view",{class:"share-option",onClick:a[13]||(a[13]=(...e)=>n.shareToDouyinPost&&n.shareToDouyinPost(...e))},[e.createElementVNode("view",{class:"share-icon-bg douyin-post"},[e.createElementVNode("image",{class:"share-icon-img",src:B,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"发布到抖音")]),e.createElementVNode("view",{class:"share-option",onClick:a[14]||(a[14]=(...e)=>n.shareToQQ&&n.shareToQQ(...e))},[e.createElementVNode("view",{class:"share-icon-bg qq"},[e.createElementVNode("image",{class:"share-icon-img",src:D,mode:"aspectFit"})]),e.createElementVNode("text",{class:"share-option-text"},"QQ")])])])])):e.createCommentVNode("",!0)])}]]);const A=a({name:"ReviewDetailPage",data:()=>({reviewDetail:{id:"",reviewer:"",avatar:"",rating:5,content:"",time:"",likes:0,dislikes:0,favorites:0,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:[],images:[]},commentText:"",showMoreModal:!1,scrollTop:0,replyToComment:null,replyToReply:null,postId:null,postType:"text",userId:1000100,loading:!1,hasError:!1,errorMessage:""}),onLoad(e){if(o("log","at pages/feed/review-detail.vue:241","页面加载参数:",e),void 0!==e.postId)this.postId=parseInt(e.postId),this.postType=e.postType||"text",this.userId=parseInt(e.userId)||1000100,o("log","at pages/feed/review-detail.vue:247","解析后的参数 - postId:",this.postId,"postType:",this.postType,"userId:",this.userId),this.loadPostDetail();else if(void 0!==e.id){o("log","at pages/feed/review-detail.vue:252","解析后的reviewId:",parseInt(e.id)),this.loadReviewDetail(e)}else o("log","at pages/feed/review-detail.vue:255","使用默认数据"),this.loadDefaultReviewDetail()},methods:{async loadPostDetail(){try{o("log","at pages/feed/review-detail.vue:263","=== 开始加载帖子详情数据 ==="),o("log","at pages/feed/review-detail.vue:264","帖子ID:",this.postId),o("log","at pages/feed/review-detail.vue:265","帖子类型:",this.postType),o("log","at pages/feed/review-detail.vue:266","用户ID:",this.userId),o("log","at pages/feed/review-detail.vue:267","请求URL:",`http://localhost:8888/api/post-detail/data?postId=${this.postId}&postType=${this.postType}&userId=${this.userId}`),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/post-detail/data?postId=${this.postId}&postType=${this.postType}&userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/review-detail.vue:281","=== API响应详情 ==="),o("log","at pages/feed/review-detail.vue:282","状态码:",e.statusCode),o("log","at pages/feed/review-detail.vue:283","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;o("log","at pages/feed/review-detail.vue:287","获取到的帖子数据:",t),this.reviewDetail={id:t.id,reviewer:t.reviewer,avatar:t.avatar,rating:t.rating,content:t.content,time:t.time,likes:t.likes,dislikes:t.dislikes,favorites:t.favorites,isLiked:t.isLiked,isDisliked:t.isDisliked,isFavorited:t.isFavorited,isFollowed:t.isFollowed,comments:t.comments||[],images:t.images||[]},o("log","at pages/feed/review-detail.vue:308","帖子详情数据加载成功"),uni.showToast({title:"数据加载成功",icon:"success",duration:1500})}else o("error","at pages/feed/review-detail.vue:316","加载帖子详情数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载数据失败",uni.showToast({title:"加载数据失败",icon:"error"})}catch(e){o("error","at pages/feed/review-detail.vue:325","加载帖子详情数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}},loadReviewDetail(e){o("log","at pages/feed/review-detail.vue:339","开始加载书评详情，参数:",e),this.reviewDetail={id:e.id||0,reviewer:decodeURIComponent(e.reviewer||""),avatar:"/static/avatar1.png",rating:parseInt(e.rating)||5,content:decodeURIComponent(e.content||""),time:decodeURIComponent(e.time||""),likes:parseInt(e.likes)||0,dislikes:parseInt(e.dislikes)||0,favorites:0,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:this.generateMockComments()},o("log","at pages/feed/review-detail.vue:359","加载的书评数据:",this.reviewDetail)},generateMockComments:()=>[{username:"书虫小王",userAvatar:"/static/avatar2.png",time:"10分钟前",content:"这个书评写得很中肯！",likes:45,isLiked:!1,replies:[{username:"修仙爱好者",userAvatar:"/static/avatar3.png",time:"8分钟前",content:"我也觉得分析得很到位！",likes:12,isLiked:!1,replyTo:"书虫小王"}]},{username:"修仙爱好者",userAvatar:"/static/avatar3.png",time:"8分钟前",content:"完全同意楼主的观点，这本书确实很棒",likes:32,isLiked:!1,replies:[]},{username:"文学评论家",userAvatar:"/static/avatar4.png",time:"5分钟前",content:"文笔流畅，分析透彻，值得推荐",likes:28,isLiked:!1,replies:[]}],loadDefaultReviewDetail(){this.reviewDetail={id:0,reviewer:"书友123456",avatar:"/static/avatar1.png",rating:5,content:"文笔剧情很好,很难得的女强无cp游戏侵入现实的文,世界观设计都很有画面感,女主也很聪明,抓...",time:"阅读不足30分钟后点评",likes:234,dislikes:12,favorites:0,isLiked:!1,isDisliked:!1,isFavorited:!1,isFollowed:!1,comments:this.generateMockComments()}},goBack(){o("log","at pages/feed/review-detail.vue:427","返回按钮被点击");try{uni.navigateBack({success:()=>{o("log","at pages/feed/review-detail.vue:432","返回成功")},fail:e=>{o("log","at pages/feed/review-detail.vue:435","返回失败:",e),uni.navigateTo({url:"/pages/feed/novel-more-reviews"})}})}catch(e){o("error","at pages/feed/review-detail.vue:443","返回操作出错:",e),uni.navigateTo({url:"/pages/feed/novel-more-reviews"})}},goToUserProfile(){uni.navigateTo({url:`/pages/feed/user-profile?username=${encodeURIComponent(this.reviewDetail.reviewer)}`})},toggleFollow(){this.reviewDetail.isFollowed=!this.reviewDetail.isFollowed,uni.showToast({title:this.reviewDetail.isFollowed?"关注成功":"已取消关注",icon:"success"})},formatCount:e=>e>=1e4?(e/1e4).toFixed(1)+"w":e.toString(),async handleLike(){try{o("log","at pages/feed/review-detail.vue:478","处理点赞操作:",this.postId,this.postType,this.userId);const e=await uni.request({url:"http://localhost:8888/api/post-detail/like",method:"POST",data:{postId:this.postId,postType:this.postType,userId:this.userId},header:{"Content-Type":"application/json"}});o("log","at pages/feed/review-detail.vue:493","点赞API响应:",e),200===e.statusCode&&e.data.success?(this.reviewDetail.isLiked=e.data.isLiked,this.reviewDetail.isLiked?(this.reviewDetail.likes++,this.reviewDetail.isDisliked&&(this.reviewDetail.isDisliked=!1,this.reviewDetail.dislikes--)):this.reviewDetail.likes--,uni.showToast({title:e.data.message,icon:"success",duration:1500})):(o("error","at pages/feed/review-detail.vue:515","点赞操作失败:",e.data.message),uni.showToast({title:e.data.message||"点赞失败",icon:"error"}))}catch(e){o("error","at pages/feed/review-detail.vue:522","点赞操作异常:",e),uni.showToast({title:"网络错误",icon:"error"})}},async handleDislike(){try{o("log","at pages/feed/review-detail.vue:533","处理点踩操作:",this.postId,this.postType,this.userId);const e=await uni.request({url:"http://localhost:8888/api/post-detail/dislike",method:"POST",data:{postId:this.postId,postType:this.postType,userId:this.userId},header:{"Content-Type":"application/json"}});o("log","at pages/feed/review-detail.vue:548","点踩API响应:",e),200===e.statusCode&&e.data.success?(this.reviewDetail.isDisliked=e.data.isDisliked,this.reviewDetail.isDisliked?(this.reviewDetail.dislikes++,this.reviewDetail.isLiked&&(this.reviewDetail.isLiked=!1,this.reviewDetail.likes--)):this.reviewDetail.dislikes--,uni.showToast({title:e.data.message,icon:"success",duration:1500})):(o("error","at pages/feed/review-detail.vue:570","点踩操作失败:",e.data.message),uni.showToast({title:e.data.message||"点踩失败",icon:"error"}))}catch(e){o("error","at pages/feed/review-detail.vue:577","点踩操作异常:",e),uni.showToast({title:"网络错误",icon:"error"})}},async handleFavorite(){try{o("log","at pages/feed/review-detail.vue:588","处理收藏操作:",this.postId,this.postType,this.userId);const e=await uni.request({url:"http://localhost:8888/api/post-detail/favorite",method:"POST",data:{postId:this.postId,postType:this.postType,userId:this.userId},header:{"Content-Type":"application/json"}});o("log","at pages/feed/review-detail.vue:603","收藏API响应:",e),200===e.statusCode&&e.data.success?(this.reviewDetail.isFavorited=e.data.isFavorited,this.reviewDetail.isFavorited?this.reviewDetail.favorites++:this.reviewDetail.favorites--,uni.showToast({title:e.data.message,icon:"success",duration:1500})):(o("error","at pages/feed/review-detail.vue:620","收藏操作失败:",e.data.message),uni.showToast({title:e.data.message||"收藏失败",icon:"error"}))}catch(e){o("error","at pages/feed/review-detail.vue:627","收藏操作异常:",e),uni.showToast({title:"网络错误",icon:"error"})}},handleShare(){uni.showToast({title:"分享功能开发中",icon:"none"})},previewImage(e,t){uni.previewImage({urls:e,current:t})},showMoreOptions(){this.showMoreModal=!0},hideMoreOptions(){this.showMoreModal=!1},reportReview(){this.hideMoreOptions(),uni.navigateTo({url:"/pages/report/report"})},copyLink(){this.hideMoreOptions(),uni.setClipboardData({data:`https://example.com/review/${this.reviewDetail.id}`,success:()=>{uni.showToast({title:"链接已复制",icon:"success"})}})},likeComment(e,t){e.isLiked=!e.isLiked,e.isLiked?e.likes++:e.likes--},likeReply(e,t){const a=e.replies[t];a.isLiked=!a.isLiked,a.isLiked?a.likes++:a.likes--},replyComment(e){o("log","at pages/feed/review-detail.vue:706","回复评论:",e),this.replyToComment=e,this.replyToReply=null,this.commentText="",this.$nextTick((()=>{const e=uni.createSelectorQuery().select(".comment-input");e&&e.focus()}))},handleReplyToReply(e,t){this.replyToComment=e,this.replyToReply=t,this.commentText="",this.$nextTick((()=>{const e=uni.createSelectorQuery().select(".comment-input");e&&e.focus()}))},onInputFocus(){},onInputBlur(){},async submitComment(){if(this.commentText.trim()){try{o("log","at pages/feed/review-detail.vue:752","提交评论:",this.commentText,"帖子ID:",this.postId,"帖子类型:",this.postType,"用户ID:",this.userId);const e=await uni.request({url:"http://localhost:8888/api/post-detail/comment",method:"POST",data:{postId:this.postId,postType:this.postType,userId:this.userId,commentText:this.commentText,parentCommentId:this.replyToComment?this.replyToComment.id:null},header:{"Content-Type":"application/json"}});o("log","at pages/feed/review-detail.vue:769","评论API响应:",e),200===e.statusCode&&e.data.success?(await this.loadPostDetail(),this.replyToComment=null,this.replyToReply=null,uni.showToast({title:"评论成功",icon:"success"})):(o("error","at pages/feed/review-detail.vue:784","评论操作失败:",e.data.message),uni.showToast({title:e.data.message||"评论失败",icon:"error"}))}catch(e){o("error","at pages/feed/review-detail.vue:791","评论操作异常:",e),uni.showToast({title:"网络错误",icon:"error"})}this.commentText=""}},getTotalCommentsCount(){let e=this.reviewDetail.comments.length;return this.reviewDetail.comments.forEach((t=>{t.replies&&(e+=t.replies.length)})),e},getInputPlaceholder(){return this.replyToComment?this.replyToReply?`回复 @${this.replyToReply.username}...`:`回复 @${this.replyToComment.username}...`:"说点什么..."},cancelReply(){o("log","at pages/feed/review-detail.vue:826","取消回复"),this.commentText="",this.replyToComment=null,this.replyToReply=null},onBackTouchStart(){o("log","at pages/feed/review-detail.vue:834","返回按钮触摸开始")},onBackTouchEnd(){o("log","at pages/feed/review-detail.vue:840","返回按钮触摸结束")}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"review-detail-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e)),onTouchstart:a[1]||(a[1]=(...e)=>n.onBackTouchStart&&n.onBackTouchStart(...e)),onTouchend:a[2]||(a[2]=(...e)=>n.onBackTouchEnd&&n.onBackTouchEnd(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756246262970",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"904",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666","p-id":"905"})]))],32),e.createElementVNode("view",{class:"header-title"},"书评详情"),e.createElementVNode("view",{class:"more-button",onClick:a[3]||(a[3]=(...e)=>n.showMoreOptions&&n.showMoreOptions(...e))},[(e.openBlock(),e.createElementBlock("svg",{t:"1756202704554",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:"#333333"}),e.createElementVNode("path",{d:"M464 688a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z",fill:"#333333"})]))])]),e.createElementVNode("view",{class:"content-scroll"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载数据...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[4]||(a[4]=(...e)=>n.loadPostDetail&&n.loadPostDetail(...e))},"重新加载")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"review-content"},[e.createElementVNode("view",{class:"reviewer-section"},[e.createElementVNode("view",{class:"reviewer-info",onClick:a[5]||(a[5]=(...e)=>n.goToUserProfile&&n.goToUserProfile(...e))},[e.createElementVNode("image",{class:"reviewer-avatar",src:i.reviewDetail.avatar,mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"reviewer-details"},[e.createElementVNode("text",{class:"reviewer-name"},e.toDisplayString(i.reviewDetail.reviewer),1),e.createElementVNode("view",{class:"review-meta"},[e.createElementVNode("view",{class:"rating-stars"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.reviewDetail.rating,(t=>(e.openBlock(),e.createElementBlock("text",{class:"star",key:t},"★")))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(5-i.reviewDetail.rating,(t=>(e.openBlock(),e.createElementBlock("text",{class:"star empty",key:t},"☆")))),128))]),e.createElementVNode("text",{class:"review-time"},e.toDisplayString(i.reviewDetail.time),1)])])]),e.createElementVNode("view",{class:e.normalizeClass(["follow-button",{followed:i.reviewDetail.isFollowed}]),onClick:a[6]||(a[6]=(...e)=>n.toggleFollow&&n.toggleFollow(...e))},[e.createElementVNode("text",{class:"follow-text"},e.toDisplayString(i.reviewDetail.isFollowed?"已关注":"关注"),1)],2)]),i.reviewDetail.content?(e.openBlock(),e.createElementBlock("view",{key:0,class:"text-content"},[e.createElementVNode("text",{class:"content-text"},e.toDisplayString(i.reviewDetail.content),1)])):e.createCommentVNode("",!0),i.reviewDetail.images&&i.reviewDetail.images.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"image-content"},[e.createElementVNode("view",{class:"image-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.reviewDetail.images,((t,a)=>(e.openBlock(),e.createElementBlock("image",{key:a,class:"content-image",src:t,mode:"aspectFill",onClick:e=>n.previewImage(i.reviewDetail.images,a)},null,8,["src","onClick"])))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"engagement-metrics"},[e.createElementVNode("view",{class:"metric-item",onClick:a[7]||(a[7]=(...e)=>n.handleLike&&n.handleLike(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:i.reviewDetail.isLiked}])},"👍",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:i.reviewDetail.isLiked}])},e.toDisplayString(n.formatCount(i.reviewDetail.likes)),3)]),e.createElementVNode("view",{class:"metric-item",onClick:a[8]||(a[8]=(...e)=>n.handleDislike&&n.handleDislike(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:i.reviewDetail.isDisliked}])},"👎",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:i.reviewDetail.isDisliked}])},e.toDisplayString(n.formatCount(i.reviewDetail.dislikes)),3)]),e.createElementVNode("view",{class:"metric-item",onClick:a[9]||(a[9]=(...e)=>n.handleFavorite&&n.handleFavorite(...e))},[e.createElementVNode("text",{class:e.normalizeClass(["metric-icon",{active:i.reviewDetail.isFavorited}])},"⭐",2),e.createElementVNode("text",{class:e.normalizeClass(["metric-count",{active:i.reviewDetail.isFavorited}])},e.toDisplayString(n.formatCount(i.reviewDetail.favorites)),3)]),e.createElementVNode("view",{class:"metric-item",onClick:a[10]||(a[10]=(...e)=>n.handleShare&&n.handleShare(...e))},[e.createElementVNode("text",{class:"metric-icon"},"📤"),e.createElementVNode("text",{class:"metric-count"},"分享")])])])),e.createElementVNode("view",{class:"comments-section"},[e.createElementVNode("view",{class:"comments-header"},[e.createElementVNode("text",{class:"comments-title"},"评论 ("+e.toDisplayString(n.getTotalCommentsCount())+")",1)]),e.createElementVNode("view",{class:"comments-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.reviewDetail.comments,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"comment-item",key:a},[e.createElementVNode("view",{class:"comment-avatar"},[e.createElementVNode("image",{class:"comment-user-avatar",src:t.userAvatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"comment-content"},[e.createElementVNode("view",{class:"comment-user-info"},[e.createElementVNode("text",{class:"comment-username"},e.toDisplayString(t.username),1),e.createElementVNode("text",{class:"comment-time"},e.toDisplayString(t.time),1)]),e.createElementVNode("text",{class:"comment-text"},e.toDisplayString(t.content),1),e.createElementVNode("view",{class:"comment-actions"},[e.createElementVNode("view",{class:"comment-action",onClick:e=>n.likeComment(t,a)},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:t.isLiked}])},"👍",2),e.createElementVNode("text",{class:"action-count"},e.toDisplayString(n.formatCount(t.likes)),1)],8,["onClick"]),e.createElementVNode("view",{class:"comment-action",onClick:e=>n.replyComment(t)},[e.createElementVNode("text",{class:"action-icon"},"💬"),e.createElementVNode("text",{class:"action-count"},"回复")],8,["onClick"])]),t.replies&&t.replies.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"replies-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.replies,((a,s)=>(e.openBlock(),e.createElementBlock("view",{class:"reply-item",key:s},[e.createElementVNode("view",{class:"reply-avatar"},[e.createElementVNode("image",{class:"reply-user-avatar",src:a.userAvatar,mode:"aspectFill"},null,8,["src"])]),e.createElementVNode("view",{class:"reply-content"},[e.createElementVNode("view",{class:"reply-user-info"},[e.createElementVNode("text",{class:"reply-username"},e.toDisplayString(a.username),1),e.createElementVNode("text",{class:"reply-time"},e.toDisplayString(a.time),1)]),e.createElementVNode("text",{class:"reply-text"},[e.createElementVNode("text",{class:"reply-to"},"回复 @"+e.toDisplayString(a.replyTo)+"：",1),e.createTextVNode(" "+e.toDisplayString(a.content),1)]),e.createElementVNode("view",{class:"reply-actions"},[e.createElementVNode("view",{class:"reply-action",onClick:e=>n.likeReply(t,s)},[e.createElementVNode("text",{class:e.normalizeClass(["action-icon",{active:a.isLiked}])},"👍",2),e.createElementVNode("text",{class:"action-count"},e.toDisplayString(n.formatCount(a.likes)),1)],8,["onClick"]),e.createElementVNode("view",{class:"reply-action",onClick:e=>n.handleReplyToReply(t,a)},[e.createElementVNode("text",{class:"action-icon"},"💬"),e.createElementVNode("text",{class:"action-count"},"回复")],8,["onClick"])])])])))),128))])):e.createCommentVNode("",!0)])])))),128))])])]),e.createElementVNode("view",{class:"comment-input-section"},[e.createElementVNode("view",{class:"comment-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"comment-input","onUpdate:modelValue":a[11]||(a[11]=e=>i.commentText=e),placeholder:n.getInputPlaceholder(),onFocus:a[12]||(a[12]=(...e)=>n.onInputFocus&&n.onInputFocus(...e)),onBlur:a[13]||(a[13]=(...e)=>n.onInputBlur&&n.onInputBlur(...e))},null,40,["placeholder"]),[[e.vModelText,i.commentText]]),i.replyToComment?(e.openBlock(),e.createElementBlock("view",{key:0,class:"cancel-reply-btn",onClick:a[14]||(a[14]=(...e)=>n.cancelReply&&n.cancelReply(...e))},[e.createElementVNode("text",{class:"cancel-reply-text"},"取消")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["send-button",{active:i.commentText.trim()}]),onClick:a[15]||(a[15]=(...e)=>n.submitComment&&n.submitComment(...e))},[e.createElementVNode("text",{class:"send-text"},"发送")],2)])]),i.showMoreModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"more-options-modal",onClick:a[20]||(a[20]=(...e)=>n.hideMoreOptions&&n.hideMoreOptions(...e))},[e.createElementVNode("view",{class:"options-content",onClick:a[19]||(a[19]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"option-item",onClick:a[16]||(a[16]=(...e)=>n.reportReview&&n.reportReview(...e))},[e.createElementVNode("text",{class:"option-text"},"举报")]),e.createElementVNode("view",{class:"option-item",onClick:a[17]||(a[17]=(...e)=>n.copyLink&&n.copyLink(...e))},[e.createElementVNode("text",{class:"option-text"},"复制链接")]),e.createElementVNode("view",{class:"option-item",onClick:a[18]||(a[18]=(...e)=>n.hideMoreOptions&&n.hideMoreOptions(...e))},[e.createElementVNode("text",{class:"option-text"},"取消")])])])):e.createCommentVNode("",!0)])}]]);const L=a({name:"AchievementsPage",data:()=>({userId:1000100,achievements:[],stats:{totalAchievements:0,completedAchievements:0,completionRate:0},loading:!1,hasError:!1,errorMessage:""}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId),o("log","at pages/feed/achievements.vue:122","接收到的用户ID:",this.userId)),this.loadAchievementData()},methods:{async loadAchievementData(){try{o("log","at pages/feed/achievements.vue:131","=== 开始加载成就数据 ==="),o("log","at pages/feed/achievements.vue:132","用户ID:",this.userId),o("log","at pages/feed/achievements.vue:133","请求URL:",`http://localhost:8888/api/achievement/data?userId=${this.userId}`),this.loading=!0,this.hasError=!1,this.errorMessage="";const[e,t]=await Promise.all([uni.request({url:`http://localhost:8888/api/achievement/data?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}}),uni.request({url:`http://localhost:8888/api/achievement/stats?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}})]);o("log","at pages/feed/achievements.vue:156","=== 成就数据API响应详情 ==="),o("log","at pages/feed/achievements.vue:157","成就数据状态码:",e.statusCode),o("log","at pages/feed/achievements.vue:158","成就数据响应:",e.data),o("log","at pages/feed/achievements.vue:160","=== 统计信息API响应详情 ==="),o("log","at pages/feed/achievements.vue:161","统计信息状态码:",t.statusCode),o("log","at pages/feed/achievements.vue:162","统计信息响应:",t.data),200===e.statusCode&&e.data.success?(this.achievements=e.data.data||[],o("log","at pages/feed/achievements.vue:167","成功加载成就数据，共",this.achievements.length,"条"),uni.showToast({title:`加载了${this.achievements.length}个成就`,icon:"success",duration:2e3})):(o("error","at pages/feed/achievements.vue:176","加载成就数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载成就数据失败"),200===t.statusCode&&t.data.success?(this.stats=t.data.data||this.stats,o("log","at pages/feed/achievements.vue:184","成功加载统计信息:",this.stats)):o("error","at pages/feed/achievements.vue:186","加载统计信息失败:",t.data.message)}catch(e){o("error","at pages/feed/achievements.vue:190","加载成就数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}},async refreshData(){o("log","at pages/feed/achievements.vue:204","开始刷新成就数据"),this.hasError=!1,this.errorMessage="";try{await this.loadAchievementData(),uni.showToast({title:"刷新成功",icon:"success"})}catch(e){o("error","at pages/feed/achievements.vue:215","刷新数据失败:",e),this.hasError=!0,this.errorMessage="刷新数据失败，请重试"}},async testConnection(){try{o("log","at pages/feed/achievements.vue:224","=== 测试成就后端连接 ===");const e=await uni.request({url:"http://localhost:8888/api/achievement/test",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/feed/achievements.vue:233","测试连接响应:",e),200===e.statusCode?uni.showToast({title:"后端连接正常",icon:"success"}):uni.showToast({title:"后端连接失败",icon:"error"})}catch(e){o("error","at pages/feed/achievements.vue:247","测试连接异常:",e),uni.showToast({title:"连接异常",icon:"error"})}},formatTimeAgo(e){if(!e)return"刚刚";const t=new Date-new Date(e),a=Math.floor(t/6e4),s=Math.floor(t/36e5),o=Math.floor(t/864e5);return a<1?"刚刚":a<60?a+"分钟前":s<24?s+"小时前":o<7?o+"天前":"一周前"},getAchievementIcon(e){if(e.iconUrl)return e.iconUrl;if(void 0!==e.status)switch(e.status){case 0:default:return"🔒";case 1:return"⏳";case 2:return"🏆"}return e.isCompleted?"🏆":"🔒"},getAchievementStatusText:e=>e.statusText?e.statusText:e.isCompleted?"已完成":"未完成",getAchievementStatusClass(e){if(void 0!==e.status)switch(e.status){case 0:default:return"locked";case 1:return"in-progress";case 2:return"completed"}return e.isCompleted?"completed":"locked"},goBack(){uni.navigateBack()},addAchievement(){uni.showToast({title:"添加成就功能",icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"achievements-page"},[e.createElementVNode("view",{class:"header"}),e.createElementVNode("view",{class:"stats-card"},[e.createElementVNode("view",{class:"stats-content"},[e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(i.stats.completedAchievements),1),e.createElementVNode("text",{class:"stats-label"},"已获得")]),e.createElementVNode("view",{class:"stats-divider"}),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(i.stats.totalAchievements),1),e.createElementVNode("text",{class:"stats-label"},"总成就")]),e.createElementVNode("view",{class:"stats-divider"}),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(i.stats.completionRate)+"%",1),e.createElementVNode("text",{class:"stats-label"},"完成度")])])]),i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载成就数据...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.loadAchievementData&&n.loadAchievementData(...e))},"重新加载"),e.createElementVNode("button",{class:"retry-button",onClick:a[1]||(a[1]=(...e)=>n.testConnection&&n.testConnection(...e))},"测试连接")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"achievements-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.achievements,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"achievement-item",key:t.id},[e.createElementVNode("view",{class:"achievement-icon"},[e.createElementVNode("view",{class:e.normalizeClass(["icon-badge",n.getAchievementStatusClass(t)])},[e.createElementVNode("text",{class:"icon-text"},e.toDisplayString(n.getAchievementIcon(t)),1)],2)]),e.createElementVNode("view",{class:"achievement-content"},[e.createElementVNode("text",{class:"achievement-title"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"achievement-desc"},e.toDisplayString(t.description),1),e.createElementVNode("view",{class:"achievement-meta"},[e.createElementVNode("text",{class:"achievement-date"},e.toDisplayString(t.completedAt?n.formatTimeAgo(t.completedAt):"未解锁"),1),e.createElementVNode("view",{class:e.normalizeClass(["achievement-status",n.getAchievementStatusClass(t)])},[e.createElementVNode("text",{class:"status-text"},e.toDisplayString(n.getAchievementStatusText(t)),1)],2)])])])))),128)),0===i.achievements.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"🏆"),e.createElementVNode("text",{class:"empty-text"},"暂无成就数据")])):e.createCommentVNode("",!0)])),e.createElementVNode("view",{class:"home-indicator"})])}]]);const R=a({data:()=>({keyword:""}),methods:{goBack(){uni.navigateBack()},search(){uni.showToast({title:"搜索功能开发中",icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"search-page"},[e.createElementVNode("view",{class:"search-header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("text",null,"返回")]),e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":a[1]||(a[1]=e=>i.keyword=e),placeholder:"搜索内容..."},null,512),[[e.vModelText,i.keyword]]),e.createElementVNode("view",{class:"search-btn",onClick:a[2]||(a[2]=(...e)=>n.search&&n.search(...e))},"搜索")]),e.createElementVNode("view",{class:"search-results"},[e.createElementVNode("text",null,"搜索结果将在这里显示")])])}]]);const F=a({name:"LikesDislikesPage",data:()=>({likesExpanded:!0,dislikesExpanded:!0,likesList:[],dislikesList:[],showModal:!1,modalType:"like",inputValue:"",isEditing:!1,editingIndex:-1,editingId:null,userId:1000100,loading:!1,errorMessage:"",hasError:!1}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId)),o("log","at pages/feed/likes-dislikes.vue:181","页面加载，用户ID:",this.userId),this.loadLikesDislikesData()},computed:{likesCount(){return this.likesList.length},dislikesCount(){return this.dislikesList.length},totalCount(){return this.likesCount+this.dislikesCount}},methods:{async loadLikesDislikesData(){try{o("log","at pages/feed/likes-dislikes.vue:200","=== 开始加载喜欢讨厌数据 ==="),o("log","at pages/feed/likes-dislikes.vue:201","用户ID:",this.userId),o("log","at pages/feed/likes-dislikes.vue:202","请求URL:",`http://localhost:8888/api/likes-dislikes/data?userId=${this.userId}`),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/likes-dislikes/data?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/likes-dislikes.vue:215","=== API响应详情 ==="),o("log","at pages/feed/likes-dislikes.vue:216","状态码:",e.statusCode),o("log","at pages/feed/likes-dislikes.vue:217","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;this.likesList=t.likes||[],this.dislikesList=t.dislikes||[],o("log","at pages/feed/likes-dislikes.vue:224","成功加载喜欢讨厌数据，喜欢",this.likesList.length,"条，讨厌",this.dislikesList.length,"条"),0===this.likesList.length&&0===this.dislikesList.length&&(this.hasError=!0,this.errorMessage="暂无喜欢讨厌数据，请添加一些内容")}else o("error","at pages/feed/likes-dislikes.vue:231","加载喜欢讨厌数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载数据失败"}catch(e){o("error","at pages/feed/likes-dislikes.vue:236","加载喜欢讨厌数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置"}finally{this.loading=!1}},async testConnection(){try{o("log","at pages/feed/likes-dislikes.vue:247","=== 测试后端连接 ===");const e=await uni.request({url:"http://localhost:8888/api/likes-dislikes/test",method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/feed/likes-dislikes.vue:256","测试连接响应:",e),200===e.statusCode?uni.showToast({title:"后端连接正常",icon:"success"}):uni.showToast({title:"后端连接失败",icon:"error"})}catch(e){o("error","at pages/feed/likes-dislikes.vue:270","测试连接异常:",e),uni.showToast({title:"连接异常",icon:"error"})}},goBack(){uni.navigateBack()},toggleLikes(){this.likesExpanded=!this.likesExpanded},toggleDislikes(){this.dislikesExpanded=!this.dislikesExpanded},showAddModal(){this.modalType="like",this.isEditing=!1,this.inputValue="",this.showModal=!0},hideModal(){this.showModal=!1,this.inputValue="",this.isEditing=!1,this.editingIndex=-1,this.editingId=null},addItem(e){this.modalType=e,this.isEditing=!1,this.inputValue="",this.showModal=!0},editItem(e,t){this.modalType=e,this.isEditing=!0,this.editingIndex=t;const a="like"===e?this.likesList[t]:this.dislikesList[t];this.inputValue=a.text||a,this.editingId=a.id||null,this.showModal=!0},async deleteItem(e,t){uni.showModal({title:"确认删除",content:"确定要删除这个项目吗？",success:async a=>{if(a.confirm)try{const a="like"===e?this.likesList[t]:this.dislikesList[t],s=a.id||a,o=await uni.request({url:`http://localhost:8888/api/likes-dislikes/delete-${e}`,method:"POST",data:{userId:this.userId,[e+"Id"]:s},header:{"Content-Type":"application/json"}});200===o.statusCode&&o.data.success?("like"===e?this.likesList.splice(t,1):this.dislikesList.splice(t,1),uni.showToast({title:"删除成功",icon:"success"})):uni.showToast({title:o.data.message||"删除失败",icon:"error"})}catch(s){o("error","at pages/feed/likes-dislikes.vue:355","删除操作异常:",s),uni.showToast({title:"删除失败",icon:"error"})}}})},async confirmAction(){if(this.inputValue.trim()){try{if(this.isEditing){const e=await uni.request({url:`http://localhost:8888/api/likes-dislikes/edit-${this.modalType}`,method:"POST",data:{userId:this.userId,[this.modalType+"Id"]:this.editingId,[this.modalType+"Text"]:this.inputValue.trim(),[this.modalType+"Type"]:"general"},header:{"Content-Type":"application/json"}});if(200===e.statusCode&&e.data.success){const e="like"===this.modalType?this.likesList[this.editingIndex]:this.dislikesList[this.editingIndex];e.text=this.inputValue.trim(),e.updatedAt=new Date,uni.showToast({title:"编辑成功",icon:"success"})}else uni.showToast({title:e.data.message||"编辑失败",icon:"error"})}else{const e=await uni.request({url:`http://localhost:8888/api/likes-dislikes/add-${this.modalType}`,method:"POST",data:{userId:this.userId,[this.modalType+"Text"]:this.inputValue.trim(),[this.modalType+"Type"]:"general"},header:{"Content-Type":"application/json"}});if(200===e.statusCode&&e.data.success){const t={id:e.data.data,text:this.inputValue.trim(),type:"general",createdAt:new Date,updatedAt:new Date,timeAgo:"刚刚"};"like"===this.modalType?this.likesList.unshift(t):this.dislikesList.unshift(t),uni.showToast({title:"添加成功",icon:"success"})}else uni.showToast({title:e.data.message||"添加失败",icon:"error"})}}catch(e){o("error","at pages/feed/likes-dislikes.vue:451","操作异常:",e),uni.showToast({title:"操作失败",icon:"error"})}this.hideModal()}else uni.showToast({title:"请输入内容",icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"likes-dislikes-page"},[e.createElementVNode("view",{class:"header"}),e.createElementVNode("view",{class:"stats-card"},[e.createElementVNode("view",{class:"stats-content"},[e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(n.likesCount),1),e.createElementVNode("text",{class:"stats-label"},"喜欢")]),e.createElementVNode("view",{class:"stats-divider"}),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(n.dislikesCount),1),e.createElementVNode("text",{class:"stats-label"},"讨厌")]),e.createElementVNode("view",{class:"stats-divider"}),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(n.totalCount),1),e.createElementVNode("text",{class:"stats-label"},"总计")])])]),e.createElementVNode("view",{class:"preference-section"},[e.createElementVNode("view",{class:"section-header",onClick:a[0]||(a[0]=(...e)=>n.toggleLikes&&n.toggleLikes(...e))},[e.createElementVNode("text",{class:"section-title"},"我喜欢的"),e.createElementVNode("view",{class:e.normalizeClass(["expand-icon",{expanded:i.likesExpanded}])},[e.createElementVNode("text",{class:"expand-arrow"},"^")],2)]),i.likesExpanded?(e.openBlock(),e.createElementBlock("view",{key:0,class:"section-content"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载数据...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[1]||(a[1]=(...e)=>n.loadLikesDislikesData&&n.loadLikesDislikesData(...e))},"重新加载"),e.createElementVNode("button",{class:"retry-button",onClick:a[2]||(a[2]=(...e)=>n.testConnection&&n.testConnection(...e))},"测试连接")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.likesList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"preference-item",key:"like-"+a},[e.createElementVNode("view",{class:"item-icon like-icon"},[e.createElementVNode("text",{class:"icon-text"},"❤️")]),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-text"},e.toDisplayString(t.text||t),1),t.timeAgo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"item-time"},e.toDisplayString(t.timeAgo),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"item-actions"},[e.createElementVNode("view",{class:"action-btn edit-btn",onClick:e=>n.editItem("like",a)},[e.createElementVNode("text",{class:"action-text"},"编辑")],8,["onClick"]),e.createElementVNode("view",{class:"action-btn delete-btn",onClick:e=>n.deleteItem("like",a)},[e.createElementVNode("text",{class:"action-text"},"删除")],8,["onClick"])])])))),128)),e.createElementVNode("view",{class:"add-item-btn",onClick:a[3]||(a[3]=e=>n.addItem("like"))},[e.createElementVNode("text",{class:"add-text"},"+ 添加喜欢")])]))])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"preference-section"},[e.createElementVNode("view",{class:"section-header",onClick:a[4]||(a[4]=(...e)=>n.toggleDislikes&&n.toggleDislikes(...e))},[e.createElementVNode("text",{class:"section-title"},"我讨厌的"),e.createElementVNode("view",{class:e.normalizeClass(["expand-icon",{expanded:i.dislikesExpanded}])},[e.createElementVNode("text",{class:"expand-arrow"},"^")],2)]),i.dislikesExpanded?(e.openBlock(),e.createElementBlock("view",{key:0,class:"section-content"},[i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.dislikesList,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"preference-item",key:"dislike-"+a},[e.createElementVNode("view",{class:"item-icon dislike-icon"},[e.createElementVNode("text",{class:"icon-text"},"💔")]),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-text"},e.toDisplayString(t.text||t),1),t.timeAgo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"item-time"},e.toDisplayString(t.timeAgo),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"item-actions"},[e.createElementVNode("view",{class:"action-btn edit-btn",onClick:e=>n.editItem("dislike",a)},[e.createElementVNode("text",{class:"action-text"},"编辑")],8,["onClick"]),e.createElementVNode("view",{class:"action-btn delete-btn",onClick:e=>n.deleteItem("dislike",a)},[e.createElementVNode("text",{class:"action-text"},"删除")],8,["onClick"])])])))),128)),e.createElementVNode("view",{class:"add-item-btn",onClick:a[5]||(a[5]=e=>n.addItem("dislike"))},[e.createElementVNode("text",{class:"add-text"},"+ 添加讨厌")])]))])):e.createCommentVNode("",!0)]),i.showModal?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-overlay",onClick:a[11]||(a[11]=(...e)=>n.hideModal&&n.hideModal(...e))},[e.createElementVNode("view",{class:"modal-content",onClick:a[10]||(a[10]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(i.isEditing?"编辑":"添加")+e.toDisplayString("like"===i.modalType?"喜欢":"讨厌"),1),e.createElementVNode("view",{class:"close-btn",onClick:a[6]||(a[6]=(...e)=>n.hideModal&&n.hideModal(...e))},[e.createElementVNode("text",{class:"close-text"},"×")])]),e.createElementVNode("view",{class:"modal-body"},[e.withDirectives(e.createElementVNode("input",{class:"input-field","onUpdate:modelValue":a[7]||(a[7]=e=>i.inputValue=e),placeholder:"请输入您"+("like"===i.modalType?"喜欢":"讨厌")+"的内容",maxlength:"50"},null,8,["placeholder"]),[[e.vModelText,i.inputValue]]),e.createElementVNode("view",{class:"modal-actions"},[e.createElementVNode("view",{class:"modal-btn cancel-btn",onClick:a[8]||(a[8]=(...e)=>n.hideModal&&n.hideModal(...e))},[e.createElementVNode("text",{class:"btn-text"},"取消")]),e.createElementVNode("view",{class:"modal-btn confirm-btn",onClick:a[9]||(a[9]=(...e)=>n.confirmAction&&n.confirmAction(...e))},[e.createElementVNode("text",{class:"btn-text"},"确定")])])])])])):e.createCommentVNode("",!0)])}]]);const $=a({name:"InteractionMessagesPage",data:()=>({filterExpanded:!1,currentFilter:"all",userId:1000100,loading:!1,hasError:!1,errorMessage:"",messages:[],messageFilters:[{type:"all",name:"全部消息",icon:"〰️"},{type:"likes",name:"赞与收藏",icon:"❤️"},{type:"received-comments",name:"收到的评论",icon:"💬"},{type:"sent-comments",name:"发出的评论",icon:"💬"}]}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId),o("log","at pages/feed/interaction-messages.vue:129","接收到用户ID:",this.userId)),this.loadInteractionMessages()},methods:{async loadInteractionMessages(){try{o("log","at pages/feed/interaction-messages.vue:138","=== 开始加载互动消息数据 ==="),o("log","at pages/feed/interaction-messages.vue:139","用户ID:",this.userId),o("log","at pages/feed/interaction-messages.vue:140","筛选类型:",this.currentFilter),o("log","at pages/feed/interaction-messages.vue:141","请求URL:",`http://localhost:8888/api/interaction-messages/data?userId=${this.userId}&filterType=${this.currentFilter}`),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/interaction-messages/data?userId=${this.userId}&filterType=${this.currentFilter}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/feed/interaction-messages.vue:155","=== API响应详情 ==="),o("log","at pages/feed/interaction-messages.vue:156","状态码:",e.statusCode),o("log","at pages/feed/interaction-messages.vue:157","响应数据:",e.data),200===e.statusCode){o("log","at pages/feed/interaction-messages.vue:161","响应数据结构检查:"),o("log","at pages/feed/interaction-messages.vue:162","- response.data:",e.data),o("log","at pages/feed/interaction-messages.vue:163","- response.data.success:",e.data.success),o("log","at pages/feed/interaction-messages.vue:164","- response.data.data:",e.data.data);let t=[];if(e.data&&e.data.data&&Array.isArray(e.data.data))t=e.data.data;else{if(!Array.isArray(e.data))return o("error","at pages/feed/interaction-messages.vue:175","无法识别的响应格式:",e.data),this.hasError=!0,void(this.errorMessage="响应数据格式错误");t=e.data}this.messages=t,o("log","at pages/feed/interaction-messages.vue:182","成功加载互动消息数据，共",this.messages.length,"条"),o("log","at pages/feed/interaction-messages.vue:183","第一条数据示例:",this.messages.length>0?this.messages[0]:"无数据"),0===this.messages.length?(this.hasError=!0,this.errorMessage="暂无互动消息，请稍后再试",o("log","at pages/feed/interaction-messages.vue:188","没有获取到任何互动消息数据")):uni.showToast({title:`加载了${this.messages.length}条消息`,icon:"success",duration:2e3})}else o("error","at pages/feed/interaction-messages.vue:198","加载互动消息数据失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载数据失败",uni.showToast({title:"加载数据失败",icon:"error"})}catch(e){o("error","at pages/feed/interaction-messages.vue:207","加载互动消息数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}},goBack(){uni.navigateBack()},toggleFilter(){this.filterExpanded=!this.filterExpanded},selectFilter(e){this.currentFilter=e,this.filterExpanded=!1,this.loadInteractionMessages(),uni.showToast({title:`已切换到${this.getMessageFilterName(e)}`,icon:"none"})},getMessageFilterName(e){const t=this.messageFilters.find((t=>t.type===e));return t?t.name:""},getCurrentFilterName(){return this.getMessageFilterName(this.currentFilter)},async markAllAsRead(){uni.showModal({title:"确认操作",content:"确定要将所有消息标记为已读吗？",success:async e=>{if(e.confirm)try{o("log","at pages/feed/interaction-messages.vue:249","开始标记所有消息为已读");const e=await uni.request({url:`http://localhost:8888/api/interaction-messages/mark-all-read?userId=${this.userId}`,method:"POST",header:{"Content-Type":"application/json"}});o("log","at pages/feed/interaction-messages.vue:259","标记已读API响应:",e),200===e.statusCode&&e.data.success?(uni.showToast({title:e.data.message,icon:"success"}),this.loadInteractionMessages()):(o("error","at pages/feed/interaction-messages.vue:269","标记已读操作失败:",e.data.message),uni.showToast({title:e.data.message||"标记已读失败",icon:"error"}))}catch(t){o("error","at pages/feed/interaction-messages.vue:276","标记已读操作异常:",t),uni.showToast({title:"网络错误",icon:"error"})}}})},handleMessageClick(e){if(o("log","at pages/feed/interaction-messages.vue:289","点击消息:",e),e.contentType){let t="";if("novel"===e.contentType)t=`/pages/feed/novel-detail?id=${e.contentId}`;else t=`/pages/feed/post-detail?postId=${e.contentId}`;t&&uni.navigateTo({url:t})}else uni.showModal({title:"消息详情",content:e.messageText+(e.commentText?"\n\n评论内容："+e.commentText:""),showCancel:!1})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"interaction-messages-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[(e.openBlock(),e.createElementBlock("svg",{class:"back-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M407.01 512l286.008-286.008a35.84 35.84 0 0 0-50.683-50.683L330.982 486.656a35.84 35.84 0 0 0 0 50.683L642.34 848.69a35.84 35.84 0 0 0 50.683-50.683L407.009 512z",fill:"#666666"})]))]),e.createElementVNode("view",{class:"title-section",onClick:a[1]||(a[1]=(...e)=>n.toggleFilter&&n.toggleFilter(...e))},[e.createElementVNode("text",{class:"page-title"},e.toDisplayString(n.getCurrentFilterName()),1),e.createElementVNode("view",{class:e.normalizeClass(["filter-arrow",{expanded:i.filterExpanded}])},[(e.openBlock(),e.createElementBlock("svg",{class:"arrow-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32"},[e.createElementVNode("path",{d:"M832 288l-320 448-320-448z",fill:"#020202"})]))],2)]),e.createElementVNode("view",{class:"check-button",onClick:a[2]||(a[2]=(...e)=>n.markAllAsRead&&n.markAllAsRead(...e))},[e.createElementVNode("view",{class:"check-icon"},"✓")])]),i.filterExpanded?(e.openBlock(),e.createElementBlock("view",{key:0,class:"filter-section"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.messageFilters,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["filter-item",{active:i.currentFilter===t.type}]),key:a,onClick:e=>n.selectFilter(t.type)},[e.createElementVNode("view",{class:"filter-icon"},[e.createElementVNode("text",{class:"icon-text"},e.toDisplayString(t.icon),1)]),e.createElementVNode("text",{class:"filter-text"},e.toDisplayString(t.name),1),i.currentFilter===t.type?(e.openBlock(),e.createElementBlock("view",{key:0,class:"filter-check"},[e.createElementVNode("text",{class:"check-text"},"✓")])):e.createCommentVNode("",!0)],10,["onClick"])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"message-list"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载消息...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[3]||(a[3]=(...e)=>n.loadInteractionMessages&&n.loadInteractionMessages(...e))},"重新加载")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.messages,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["message-item",{unread:!t.isRead}]),key:a,onClick:e=>n.handleMessageClick(t)},[e.createElementVNode("view",{class:"avatar-section"},[e.createElementVNode("image",{class:"user-avatar",src:t.fromUserAvatar||"",mode:"aspectFill"},null,8,["src"]),"like"===t.actionType?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-badge"},"❤️")):"favorite"===t.actionType?(e.openBlock(),e.createElementBlock("view",{key:1,class:"action-badge"},"⭐")):"received-comment"===t.actionType?(e.openBlock(),e.createElementBlock("view",{key:2,class:"action-badge"},"💬")):"sent-comment"===t.actionType?(e.openBlock(),e.createElementBlock("view",{key:3,class:"action-badge"},"💬")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"message-content"},[e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("text",{class:"username"},e.toDisplayString(t.fromUsername||t.toUsername),1),t.relationship?(e.openBlock(),e.createElementBlock("text",{key:0,class:"relationship"},e.toDisplayString(t.relationship),1)):e.createCommentVNode("",!0)]),e.createElementVNode("text",{class:"message-text"},e.toDisplayString(t.messageText),1),t.commentText?(e.openBlock(),e.createElementBlock("text",{key:0,class:"comment-text"},e.toDisplayString(t.commentText),1)):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"message-date"},e.toDisplayString(t.timeAgo),1)]),t.contentThumbnail?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content-thumbnail"},[e.createElementVNode("image",{class:"thumbnail-image",src:t.contentThumbnail,mode:"aspectFill"},null,8,["src"])])):e.createCommentVNode("",!0),t.isRead?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"unread-dot"}))],10,["onClick"])))),128)),0===i.messages.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-container"},[e.createElementVNode("view",{class:"empty-icon"},"📭"),e.createElementVNode("text",{class:"empty-text"},"暂无"+e.toDisplayString(n.getCurrentFilterName())+"消息",1)])):e.createCommentVNode("",!0)]))]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const z=a({name:"PublishPage",data:()=>({userId:1000100,contentText:"",selectedColumn:"",showFeatureRow:!0,showLocationTags:!0,imageUrls:"",title:"",description:"",featureItems:[{iconClass:"green-icon",text:"手记"},{iconClass:"diamond-icon",text:"小说"},{iconClass:"diamond-icon",text:"小日常"},{iconClass:"diamond-icon",text:"睡觉"}],locationTags:["杭州","酒球会(杭州店)","烟火万塘","LiT CX"],columnOptions:[{value:"mood",label:"心情"},{value:"ihave",label:"我有"},{value:"iwant",label:"我要"},{value:"ilike",label:"我喜欢"},{value:"ihate",label:"我讨厌"}]}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId),o("log","at pages/publish/publish.vue:173","PublishPage: 接收用户ID:",this.userId))},computed:{canPublish(){return""!==this.selectedColumn&&""!==this.contentText.trim()}},methods:{goBack(){uni.navigateBack()},selectColumn(e){this.selectedColumn=e,o("log","at pages/publish/publish.vue:187","选择专栏:",e)},getContentPlaceholder(){switch(this.selectedColumn){case"mood":return"分享你的心情...";case"ihave":return"描述你拥有的物品...";case"iwant":return"描述你的需求...";case"ilike":return"分享你喜欢的东西...";case"ihate":return"分享你讨厌的东西...";default:return"分享你的想法..."}},closeFeatureRow(){this.showFeatureRow=!1},closeLocationRow(){this.showLocationTags=!1},selectImage(){uni.showToast({title:"选择图片功能开发中",icon:"none"})},mentionUser(){uni.showToast({title:"艾特用户功能开发中",icon:"none"})},addHashtag(){uni.showToast({title:"添加标签功能开发中",icon:"none"})},addGif(){uni.showToast({title:"添加GIF功能开发中",icon:"none"})},addEmoji(){uni.showToast({title:"添加表情功能开发中",icon:"none"})},addMore(){uni.showToast({title:"更多功能开发中",icon:"none"})},async publishContent(){this.canPublish?this.contentText.trim()?uni.showModal({title:"确认发布",content:"确定要发布这条内容吗？",success:async e=>{e.confirm&&await this.submitContent()}}):uni.showToast({title:"请输入内容",icon:"none"}):uni.showToast({title:"请先选择必选专栏",icon:"none"})},async submitContent(){try{o("log","at pages/publish/publish.vue:278","PublishPage: 开始发布内容"),o("log","at pages/publish/publish.vue:279","用户ID:",this.userId),o("log","at pages/publish/publish.vue:280","专栏类型:",this.selectedColumn),o("log","at pages/publish/publish.vue:281","内容:",this.contentText);let e={userId:this.userId,contentText:this.contentText,columnType:this.selectedColumn};this.imageUrls&&(e.imageUrls=this.imageUrls),"ihave"!==this.selectedColumn&&"iwant"!==this.selectedColumn||(e.title=this.title||this.contentText.substring(0,20)+"...","ihave"===this.selectedColumn&&(e.description=this.description||this.contentText)),o("log","at pages/publish/publish.vue:303","请求数据:",e);const t=await uni.request({url:"http://localhost:8888/api/publish/content",method:"POST",data:e,header:{"Content-Type":"application/json"}});o("log","at pages/publish/publish.vue:314","发布API响应:",t),200===t.statusCode&&t.data.success?(uni.showToast({title:t.data.message||"发布成功",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)):(o("error","at pages/publish/publish.vue:327","发布失败:",t.data.message),uni.showToast({title:t.data.message||"发布失败",icon:"error"}))}catch(e){o("error","at pages/publish/publish.vue:334","发布异常:",e),uni.showToast({title:"网络错误，请重试",icon:"error"})}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"publish-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"cancel-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("text",{class:"cancel-text"},"取消")]),e.createElementVNode("view",{class:"title-section"},[e.createElementVNode("text",{class:"page-title"},"Afriends"),e.createElementVNode("text",{class:"subtitle"},"曇鬲")]),e.createElementVNode("view",{class:e.normalizeClass(["send-button",{disabled:!n.canPublish}]),onClick:a[1]||(a[1]=(...e)=>n.publishContent&&n.publishContent(...e))},[e.createElementVNode("text",{class:"send-text"},"发送")],2)]),e.createElementVNode("view",{class:"content-input-area"},["ihave"===i.selectedColumn||"iwant"===i.selectedColumn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"title-input"},[e.withDirectives(e.createElementVNode("input",{class:"title-field","onUpdate:modelValue":a[2]||(a[2]=e=>i.title=e),placeholder:"ihave"===i.selectedColumn?"物品标题（如：我的iPhone 15）":"需求标题（如：需要一台MacBook）","placeholder-class":"input-placeholder"},null,8,["placeholder"]),[[e.vModelText,i.title]])])):e.createCommentVNode("",!0),"ihave"===i.selectedColumn?(e.openBlock(),e.createElementBlock("view",{key:1,class:"description-input"},[e.withDirectives(e.createElementVNode("textarea",{class:"description-field","onUpdate:modelValue":a[3]||(a[3]=e=>i.description=e),placeholder:"详细描述（如：购入时间、使用情况等）","placeholder-class":"input-placeholder","show-confirm-bar":!1,"adjust-position":!0,"hold-keyboard":!0},null,512),[[e.vModelText,i.description]])])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("textarea",{class:"input-field","onUpdate:modelValue":a[4]||(a[4]=e=>i.contentText=e),placeholder:n.getContentPlaceholder(),"placeholder-class":"input-placeholder","auto-focus":!0,"show-confirm-bar":!1,"adjust-position":!0,"hold-keyboard":!0},null,8,["placeholder"]),[[e.vModelText,i.contentText]])]),e.createElementVNode("view",{class:"feature-buttons"},[i.showFeatureRow?(e.openBlock(),e.createElementBlock("view",{key:0,class:"button-row scrollable-row"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.featureItems,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"feature-button",key:a},[e.createElementVNode("view",{class:e.normalizeClass(["button-icon",t.iconClass])},null,2),e.createElementVNode("text",{class:"button-text"},e.toDisplayString(t.text),1)])))),128)),e.createElementVNode("view",{class:"close-row-button",onClick:a[5]||(a[5]=(...e)=>n.closeFeatureRow&&n.closeFeatureRow(...e))},[e.createElementVNode("text",{class:"close-text"},"×")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"button-row second-row"},[e.createElementVNode("view",{class:"left-buttons"},[e.createElementVNode("view",{class:"feature-button"},[e.createElementVNode("view",{class:"button-icon pin-icon"}),e.createElementVNode("text",{class:"button-text"},"添加位置")]),e.createElementVNode("view",{class:"feature-button"},[e.createElementVNode("view",{class:"button-icon diamond-icon"}),e.createElementVNode("text",{class:"button-text"},"超话")])]),e.createElementVNode("view",{class:"right-buttons"},[e.createElementVNode("view",{class:"feature-button"},[e.createElementVNode("view",{class:"button-icon lock-icon"}),e.createElementVNode("text",{class:"button-text"},"公开")])])]),i.showLocationTags?(e.openBlock(),e.createElementBlock("view",{key:1,class:"location-tags scrollable-row"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.locationTags,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"tag-item",key:a},[e.createElementVNode("text",{class:"tag-text"},e.toDisplayString(t),1)])))),128)),e.createElementVNode("view",{class:"close-row-button",onClick:a[6]||(a[6]=(...e)=>n.closeLocationRow&&n.closeLocationRow(...e))},[e.createElementVNode("text",{class:"close-text"},"×")])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"required-column"},[e.createElementVNode("text",{class:"column-title"},"必选专栏 *"),e.createElementVNode("view",{class:"column-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.columnOptions,(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["column-option",{selected:i.selectedColumn===t.value}]),key:t.value,onClick:e=>n.selectColumn(t.value)},[e.createElementVNode("text",{class:"option-text"},e.toDisplayString(t.label),1)],10,["onClick"])))),128))])]),e.createElementVNode("view",{class:"bottom-toolbar"},[e.createElementVNode("view",{class:"tool-item",onClick:a[7]||(a[7]=(...e)=>n.selectImage&&n.selectImage(...e))},[e.createElementVNode("view",{class:"tool-icon gallery-icon"})]),e.createElementVNode("view",{class:"tool-item",onClick:a[8]||(a[8]=(...e)=>n.mentionUser&&n.mentionUser(...e))},[e.createElementVNode("view",{class:"tool-icon at-icon"},"@")]),e.createElementVNode("view",{class:"tool-item",onClick:a[9]||(a[9]=(...e)=>n.addHashtag&&n.addHashtag(...e))},[e.createElementVNode("view",{class:"tool-icon hashtag-icon"},"#")]),e.createElementVNode("view",{class:"tool-item",onClick:a[10]||(a[10]=(...e)=>n.addGif&&n.addGif(...e))},[e.createElementVNode("view",{class:"tool-icon gif-icon"},"GIF")]),e.createElementVNode("view",{class:"tool-item",onClick:a[11]||(a[11]=(...e)=>n.addEmoji&&n.addEmoji(...e))},[e.createElementVNode("view",{class:"tool-icon emoji-icon"},"😊")]),e.createElementVNode("view",{class:"tool-item",onClick:a[12]||(a[12]=(...e)=>n.addMore&&n.addMore(...e))},[e.createElementVNode("view",{class:"tool-icon plus-icon"},"+")])])])}]]);const U=a({name:"SettingsPage",data:()=>({darkMode:!1}),methods:{goBack(){uni.navigateBack()},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){uni.navigateTo({url:"/pages/chat/chat"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})},toggleDarkMode(){this.darkMode=!this.darkMode},goToSwitchAccount(){uni.navigateTo({url:"/pages/settings/switch-account"})},goToAccountSecurity(){uni.navigateTo({url:"/pages/settings/account-security"})},goToModeSelection(){uni.navigateTo({url:"/pages/settings/mode-selection"})},goToNotifications(){uni.navigateTo({url:"/pages/settings/notification-settings"})},goToPrivacySettings(){uni.navigateTo({url:"/pages/settings/privacy-settings"})},goToLanguage(){uni.navigateTo({url:"/pages/settings/language"})},goToBlockedUsers(){uni.navigateTo({url:"/pages/settings/blocked-users"})},goToChatSettings(){uni.navigateTo({url:"/pages/settings/chat-settings"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},goToCustomerService(){uni.navigateTo({url:"/pages/chat/chat?friendName=客服"})},goToUsageTutorial(){uni.navigateTo({url:"/pages/settings/usage-tutorial"})},logoutAccount(){uni.showModal({title:"确认注销",content:"确定要注销账户吗？此操作不可逆。",success:e=>{e.confirm&&(uni.showToast({title:"账户已注销",icon:"none",duration:1500}),setTimeout((()=>{uni.redirectTo({url:"/pages/login/login-replica"})}),1500))}})},signOut(){uni.showModal({title:"确认退出",content:"确定要退出登录吗？",success:e=>{e.confirm&&(uni.showToast({title:"已退出登录",icon:"none",duration:1500}),setTimeout((()=>{uni.redirectTo({url:"/pages/login/login-replica"})}),1500))}})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"settings-page"},[e.createElementVNode("view",{class:"settings-content"},[e.createElementVNode("view",{class:"settings-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"我的账户")]),e.createElementVNode("view",{class:"section-items"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("text",{class:"item-text"},"暗夜模式"),e.createElementVNode("view",{class:e.normalizeClass(["toggle-switch",{active:i.darkMode}]),onClick:a[0]||(a[0]=(...e)=>n.toggleDarkMode&&n.toggleDarkMode(...e))},[e.createElementVNode("view",{class:"toggle-circle"})],2)]),e.createElementVNode("view",{class:"setting-item",onClick:a[1]||(a[1]=(...e)=>n.goToSwitchAccount&&n.goToSwitchAccount(...e))},[e.createElementVNode("text",{class:"item-text"},"切换账号"),e.createElementVNode("view",{class:"arrow-right"})]),e.createElementVNode("view",{class:"setting-item",onClick:a[2]||(a[2]=(...e)=>n.goToAccountSecurity&&n.goToAccountSecurity(...e))},[e.createElementVNode("text",{class:"item-text"},"账号与安全"),e.createElementVNode("view",{class:"arrow-right"})]),e.createElementVNode("view",{class:"setting-item",onClick:a[3]||(a[3]=(...e)=>n.goToModeSelection&&n.goToModeSelection(...e))},[e.createElementVNode("text",{class:"item-text"},"模式选择"),e.createElementVNode("view",{class:"arrow-right"})])])]),e.createElementVNode("view",{class:"settings-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"账户设置")]),e.createElementVNode("view",{class:"section-items"},[e.createElementVNode("view",{class:"setting-item",onClick:a[4]||(a[4]=(...e)=>n.goToNotifications&&n.goToNotifications(...e))},[e.createElementVNode("text",{class:"item-text"},"通知"),e.createElementVNode("view",{class:"arrow-right"})]),e.createElementVNode("view",{class:"setting-item",onClick:a[5]||(a[5]=(...e)=>n.goToPrivacySettings&&n.goToPrivacySettings(...e))},[e.createElementVNode("text",{class:"item-text"},"隐私设置"),e.createElementVNode("view",{class:"arrow-right"})]),e.createElementVNode("view",{class:"setting-item",onClick:a[6]||(a[6]=(...e)=>n.goToLanguage&&n.goToLanguage(...e))},[e.createElementVNode("text",{class:"item-text"},"语言"),e.createElementVNode("view",{class:"arrow-right"})]),e.createElementVNode("view",{class:"setting-item",onClick:a[7]||(a[7]=(...e)=>n.goToBlockedUsers&&n.goToBlockedUsers(...e))},[e.createElementVNode("text",{class:"item-text"},"拉黑用户"),e.createElementVNode("view",{class:"arrow-right"})])])]),e.createElementVNode("view",{class:"settings-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"帮助")]),e.createElementVNode("view",{class:"section-items"},[e.createElementVNode("view",{class:"setting-item",onClick:a[8]||(a[8]=(...e)=>n.goToTermsOfService&&n.goToTermsOfService(...e))},[e.createElementVNode("text",{class:"item-text"},"服务条款"),e.createElementVNode("view",{class:"arrow-right"})]),e.createElementVNode("view",{class:"setting-item",onClick:a[9]||(a[9]=(...e)=>n.goToCustomerService&&n.goToCustomerService(...e))},[e.createElementVNode("text",{class:"item-text"},"客服与支持"),e.createElementVNode("view",{class:"arrow-right"})])])]),e.createElementVNode("view",{class:"account-actions"},[e.createElementVNode("view",{class:"action-button logout-account",onClick:a[10]||(a[10]=(...e)=>n.logoutAccount&&n.logoutAccount(...e))},[e.createElementVNode("text",{class:"action-text"},"注销账户")]),e.createElementVNode("view",{class:"action-button sign-out",onClick:a[11]||(a[11]=(...e)=>n.signOut&&n.signOut(...e))},[e.createElementVNode("text",{class:"action-text"},"退出登录")])])])])}]]);const j=a({data:()=>({clipboardEnabled:!0,showDialog:!1,currentPermissionTitle:"",currentPermissionType:""}),methods:{goBack(){o("log","at pages/settings/system-permissions.vue:130","返回上一页"),uni.navigateBack()},toggleClipboard(e){this.clipboardEnabled=e.detail.value,o("log","at pages/settings/system-permissions.vue:139","剪切板权限已切换为:",this.clipboardEnabled)},goToAlbumPermissions(){uni.navigateTo({url:"/pages/settings/album-permissions"})},showPermissionDialog(e,t){this.currentPermissionTitle=e,this.currentPermissionType=t,this.showDialog=!0},hidePermissionDialog(){this.showDialog=!1},getPermissionIcon:e=>({location:"📍",camera:"📷",microphone:"🎤"}[e]||"⚙️"),getPermissionDescription:e=>({location:"关闭后,将无法为你推荐位置相关的服务。",camera:"关闭后,将无法使用抖音拍摄作品。",microphone:"关闭后,将无法使用抖音拍摄作品。"}[e]||"关闭后,将无法使用相关功能。"),goToSystemSettings(e){o("log","at pages/settings/system-permissions.vue:197","前往系统设置:",e),uni.showModal({title:"跳转系统设置",content:`即将跳转到系统设置页面，请在"${e}"中开启相应权限。`,showCancel:!1,success:()=>{uni.showToast({title:"系统设置功能开发中",icon:"none"})}})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"system-permissions-page"},[e.createElementVNode("view",{class:"permissions-list"},[e.createElementVNode("view",{class:"permission-item",onClick:a[0]||(a[0]=e=>n.goToSystemSettings("通讯录权限"))},[e.createElementVNode("text",{class:"permission-text"},"通讯录权限"),e.createElementVNode("text",{class:"permission-arrow"},">")]),e.createElementVNode("view",{class:"permission-item",onClick:a[1]||(a[1]=(...e)=>n.goToAlbumPermissions&&n.goToAlbumPermissions(...e))},[e.createElementVNode("text",{class:"permission-text"},"相册权限"),e.createElementVNode("view",{class:"permission-action"},[e.createElementVNode("text",{class:"action-text"},"去设置"),e.createElementVNode("text",{class:"permission-arrow"},">")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[2]||(a[2]=e=>n.showPermissionDialog("位置权限","location"))},[e.createElementVNode("text",{class:"permission-text"},"位置权限"),e.createElementVNode("view",{class:"permission-action"},[e.createElementVNode("text",{class:"action-text"},"去设置"),e.createElementVNode("text",{class:"permission-arrow"},">")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[3]||(a[3]=e=>n.showPermissionDialog("相机权限","camera"))},[e.createElementVNode("text",{class:"permission-text"},"相机权限"),e.createElementVNode("view",{class:"permission-action"},[e.createElementVNode("text",{class:"action-text"},"去设置"),e.createElementVNode("text",{class:"permission-arrow"},">")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[4]||(a[4]=e=>n.showPermissionDialog("麦克风权限","microphone"))},[e.createElementVNode("text",{class:"permission-text"},"麦克风权限"),e.createElementVNode("view",{class:"permission-action"},[e.createElementVNode("text",{class:"action-text"},"去设置"),e.createElementVNode("text",{class:"permission-arrow"},">")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[5]||(a[5]=e=>n.goToSystemSettings("其他权限"))},[e.createElementVNode("text",{class:"permission-text"},"其他权限"),e.createElementVNode("view",{class:"permission-action"},[e.createElementVNode("text",{class:"action-text"},"去设置"),e.createElementVNode("text",{class:"permission-arrow"},">")])]),e.createElementVNode("view",{class:"clipboard-section"},[e.createElementVNode("view",{class:"clipboard-header"},[e.createElementVNode("text",{class:"clipboard-title"},"剪切板读取权限"),e.createElementVNode("switch",{checked:i.clipboardEnabled,onChange:a[6]||(a[6]=(...e)=>n.toggleClipboard&&n.toggleClipboard(...e)),color:"#007aff",class:"clipboard-switch"},null,40,["checked"])]),e.createElementVNode("text",{class:"clipboard-description"}," 关闭后，将无法自动识别你复制的口令以展示相应内容 ")])]),i.showDialog?(e.openBlock(),e.createElementBlock("view",{key:0,class:"permission-overlay",onClick:a[11]||(a[11]=(...e)=>n.hidePermissionDialog&&n.hidePermissionDialog(...e))},[e.createElementVNode("view",{class:"permission-dialog",onClick:a[10]||(a[10]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"close-button",onClick:a[7]||(a[7]=(...e)=>n.hidePermissionDialog&&n.hidePermissionDialog(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")]),e.createElementVNode("view",{class:"permission-icon"},[e.createElementVNode("view",{class:e.normalizeClass(["icon-container",i.currentPermissionType])},[e.createElementVNode("text",{class:"icon-text"},e.toDisplayString(n.getPermissionIcon(i.currentPermissionType)),1)],2)]),e.createElementVNode("text",{class:"dialog-title"},e.toDisplayString(i.currentPermissionTitle),1),e.createElementVNode("text",{class:"dialog-description"},e.toDisplayString(n.getPermissionDescription(i.currentPermissionType)),1),e.createElementVNode("view",{class:"dialog-buttons"},[e.createElementVNode("view",{class:"button button-secondary",onClick:a[8]||(a[8]=(...e)=>n.hidePermissionDialog&&n.hidePermissionDialog(...e))},[e.createElementVNode("text",{class:"button-text"},"再想想")]),e.createElementVNode("view",{class:"button button-primary",onClick:a[9]||(a[9]=e=>n.goToSystemSettings(i.currentPermissionTitle))},[e.createElementVNode("text",{class:"button-text"},"去设置")])])])])):e.createCommentVNode("",!0)])}]]);const _=a({name:"PermissionsPage",data:()=>({showDialog:!1,currentPermissionTitle:"",currentPermissionType:""}),methods:{goBack(){uni.navigateBack()},showPermissionDialog(e){this.currentPermissionTitle=e,this.currentPermissionType=e,this.showDialog=!0},hidePermissionDialog(){this.showDialog=!1},confirmPermission(){uni.showToast({title:"权限设置已更新",icon:"success"}),this.hidePermissionDialog()},goToSystemSettings(){uni.showModal({title:"系统设置",content:"即将跳转到系统设置页面",showCancel:!0,confirmText:"确定",cancelText:"取消",success:e=>{e.confirm&&uni.showToast({title:"跳转系统设置",icon:"none"})}})},getPermissionDescription:e=>({"位置权限":"位置权限允许应用获取您的地理位置信息，用于提供基于位置的服务和功能。","相机权限":"相机权限允许应用使用您的设备摄像头进行拍照、录制视频和视频通话。","麦克风权限":"麦克风权限允许应用使用您的设备麦克风进行语音通话、录音和语音识别。"}[e]||"该权限用于提供相关功能和服务。")}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"permissions-container"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"permission-section"},[e.createElementVNode("view",{class:"section-title"},[e.createElementVNode("text",null,"应用权限")]),e.createElementVNode("view",{class:"permission-item",onClick:a[0]||(a[0]=e=>n.showPermissionDialog("位置权限"))},[e.createElementVNode("view",{class:"permission-info"},[e.createElementVNode("view",{class:"permission-icon"},"📍"),e.createElementVNode("view",{class:"permission-details"},[e.createElementVNode("text",{class:"permission-name"},"位置权限"),e.createElementVNode("text",{class:"permission-desc"},"用于获取您的位置信息")])]),e.createElementVNode("view",{class:"permission-status"},[e.createElementVNode("text",{class:"status-text"},"已授权"),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[1]||(a[1]=e=>n.showPermissionDialog("相机权限"))},[e.createElementVNode("view",{class:"permission-info"},[e.createElementVNode("view",{class:"permission-icon"},"📷"),e.createElementVNode("view",{class:"permission-details"},[e.createElementVNode("text",{class:"permission-name"},"相机权限"),e.createElementVNode("text",{class:"permission-desc"},"用于拍照和视频通话")])]),e.createElementVNode("view",{class:"permission-status"},[e.createElementVNode("text",{class:"status-text"},"已授权"),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[2]||(a[2]=e=>n.showPermissionDialog("麦克风权限"))},[e.createElementVNode("view",{class:"permission-info"},[e.createElementVNode("view",{class:"permission-icon"},"🎤"),e.createElementVNode("view",{class:"permission-details"},[e.createElementVNode("text",{class:"permission-name"},"麦克风权限"),e.createElementVNode("text",{class:"permission-desc"},"用于语音通话和录音")])]),e.createElementVNode("view",{class:"permission-status"},[e.createElementVNode("text",{class:"status-text"},"已授权"),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[3]||(a[3]=(...e)=>n.goToSystemSettings&&n.goToSystemSettings(...e))},[e.createElementVNode("view",{class:"permission-info"},[e.createElementVNode("view",{class:"permission-icon"},"📱"),e.createElementVNode("view",{class:"permission-details"},[e.createElementVNode("text",{class:"permission-name"},"通讯录权限"),e.createElementVNode("text",{class:"permission-desc"},"用于同步联系人信息")])]),e.createElementVNode("view",{class:"permission-status"},[e.createElementVNode("text",{class:"status-text"},"未授权"),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"permission-item",onClick:a[4]||(a[4]=(...e)=>n.goToSystemSettings&&n.goToSystemSettings(...e))},[e.createElementVNode("view",{class:"permission-info"},[e.createElementVNode("view",{class:"permission-icon"},"⚙️"),e.createElementVNode("view",{class:"permission-details"},[e.createElementVNode("text",{class:"permission-name"},"其他权限"),e.createElementVNode("text",{class:"permission-desc"},"系统相关权限设置")])]),e.createElementVNode("view",{class:"permission-status"},[e.createElementVNode("text",{class:"status-text"},"系统管理"),e.createElementVNode("text",{class:"arrow"},"›")])])])]),i.showDialog?(e.openBlock(),e.createElementBlock("view",{key:0,class:"permission-overlay",onClick:a[9]||(a[9]=(...e)=>n.hidePermissionDialog&&n.hidePermissionDialog(...e))},[e.createElementVNode("view",{class:"permission-dialog",onClick:a[8]||(a[8]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"dialog-header"},[e.createElementVNode("text",{class:"dialog-title"},e.toDisplayString(i.currentPermissionTitle),1),e.createElementVNode("text",{class:"close-btn",onClick:a[5]||(a[5]=(...e)=>n.hidePermissionDialog&&n.hidePermissionDialog(...e))},"×")]),e.createElementVNode("view",{class:"dialog-content"},[e.createElementVNode("text",{class:"dialog-desc"},e.toDisplayString(n.getPermissionDescription(i.currentPermissionType)),1)]),e.createElementVNode("view",{class:"dialog-actions"},[e.createElementVNode("button",{class:"action-btn cancel-btn",onClick:a[6]||(a[6]=(...e)=>n.hidePermissionDialog&&n.hidePermissionDialog(...e))},"取消"),e.createElementVNode("button",{class:"action-btn confirm-btn",onClick:a[7]||(a[7]=(...e)=>n.confirmPermission&&n.confirmPermission(...e))},"确认")])])])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-0c085706"]]);const O=a({name:"AlbumPermissionsPage",data:()=>({locationPermission:!0,sharePermission:!0,analysisPermission:!0}),methods:{goBack(){uni.navigateBack()},goToSettings(){uni.showToast({title:"跳转到系统设置",icon:"none"})},toggleLocationPermission(){this.locationPermission=!this.locationPermission},toggleSharePermission(){this.sharePermission=!this.sharePermission},toggleAnalysisPermission(){this.analysisPermission=!this.analysisPermission}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"album-permissions-page"},[e.createElementVNode("view",{class:"permission-section"},[e.createElementVNode("view",{class:"permission-header"},[e.createElementVNode("text",{class:"permission-title"},"相册权限"),e.createElementVNode("view",{class:"go-to-settings",onClick:a[0]||(a[0]=(...e)=>n.goToSettings&&n.goToSettings(...e))},[e.createElementVNode("text",{class:"settings-text"},"去设置"),e.createElementVNode("view",{class:"arrow-right"})])])]),e.createElementVNode("view",{class:"permissions-list"},[e.createElementVNode("view",{class:"permission-item"},[e.createElementVNode("view",{class:"permission-content"},[e.createElementVNode("text",{class:"permission-name"},"允许使用相册内容的位置信息"),e.createElementVNode("text",{class:"permission-description"},"关闭后,将不使用本地相册和已经上传的相册内容中的位置信息,如发布时无法为你推荐相册中照片和视频的拍摄地点等")]),e.createElementVNode("view",{class:e.normalizeClass(["toggle-switch",{active:i.locationPermission}]),onClick:a[1]||(a[1]=(...e)=>n.toggleLocationPermission&&n.toggleLocationPermission(...e))},[e.createElementVNode("view",{class:"toggle-circle"})],2)]),e.createElementVNode("view",{class:"permission-item"},[e.createElementVNode("view",{class:"permission-content"},[e.createElementVNode("text",{class:"permission-name"},"允许快捷分享相册内容到Afriends"),e.createElementVNode("text",{class:"permission-description"},"关闭后,你无法将系统相册中的图片和视频快捷分享给Afriends朋友")]),e.createElementVNode("view",{class:e.normalizeClass(["toggle-switch",{active:i.sharePermission}]),onClick:a[2]||(a[2]=(...e)=>n.toggleSharePermission&&n.toggleSharePermission(...e))},[e.createElementVNode("view",{class:"toggle-circle"})],2)]),e.createElementVNode("view",{class:"permission-item"},[e.createElementVNode("view",{class:"permission-content"},[e.createElementVNode("text",{class:"permission-name"},"允许识别并分析相册内容"),e.createElementVNode("text",{class:"permission-description"},"在你进入相册后,我们仅会在授权访问的相册范围内识别分析,在设备本地运行,关闭后,将不再对您手机相册中的内容进行识别,如不再提供相册搜索、人像筛选、推荐影集等功能")]),e.createElementVNode("view",{class:e.normalizeClass(["toggle-switch",{active:i.analysisPermission}]),onClick:a[3]||(a[3]=(...e)=>n.toggleAnalysisPermission&&n.toggleAnalysisPermission(...e))},[e.createElementVNode("view",{class:"toggle-circle"})],2)])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const q=a({name:"BlockedUsersPage",data:()=>({searchKeyword:"",blockedUsers:[{id:"001",name:"张三",avatar:"",blockDate:"2024-12-20",reason:"骚扰行为"},{id:"002",name:"李四",avatar:"",blockDate:"2024-12-18",reason:"不当言论"},{id:"003",name:"王五",avatar:"",blockDate:"2024-12-15",reason:"恶意举报"},{id:"004",name:"赵六",avatar:"",blockDate:"2024-12-10",reason:"虚假信息"}]}),computed:{totalBlockedUsers(){return this.blockedUsers.length},searchResults(){return this.searchKeyword.trim()?this.blockedUsers.filter((e=>e.name.toLowerCase().includes(this.searchKeyword.toLowerCase())||e.id.includes(this.searchKeyword))):this.blockedUsers},filteredUsers(){return this.searchResults}},methods:{goBack(){uni.navigateBack()},onSearchInput(){},clearSearch(){this.searchKeyword=""},unblockUser(e){uni.showModal({title:"确认解除拉黑",content:`确定要解除对 ${e.name} 的拉黑吗？`,success:t=>{if(t.confirm){const t=this.blockedUsers.findIndex((t=>t.id===e.id));t>-1&&(this.blockedUsers.splice(t,1),uni.showToast({title:"已解除拉黑",icon:"success"}))}}})},formatDate(e){const t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"blocked-users-page"},[e.createElementVNode("view",{class:"search-section"},[e.createElementVNode("view",{class:"search-input"},[e.createElementVNode("view",{class:"search-icon"},[e.createElementVNode("view",{class:"search-magnifier"})]),e.withDirectives(e.createElementVNode("input",{class:"search-field",placeholder:"搜索黑名单用户","onUpdate:modelValue":a[0]||(a[0]=e=>i.searchKeyword=e),onInput:a[1]||(a[1]=(...e)=>n.onSearchInput&&n.onSearchInput(...e))},null,544),[[e.vModelText,i.searchKeyword]]),i.searchKeyword?(e.openBlock(),e.createElementBlock("view",{key:0,class:"clear-button",onClick:a[2]||(a[2]=(...e)=>n.clearSearch&&n.clearSearch(...e))},[e.createElementVNode("view",{class:"clear-icon"})])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"stats-section"},[e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(n.totalBlockedUsers),1),e.createElementVNode("text",{class:"stats-label"},"已拉黑用户")]),e.createElementVNode("view",{class:"stats-item"},[e.createElementVNode("text",{class:"stats-number"},e.toDisplayString(n.searchResults.length),1),e.createElementVNode("text",{class:"stats-label"},"搜索结果")])]),e.createElementVNode("view",{class:"users-list"},[0===n.filteredUsers.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("view",{class:"empty-icon"},[e.createElementVNode("view",{class:"empty-face"})]),e.createElementVNode("text",{class:"empty-title"},"暂无黑名单用户"),e.createElementVNode("text",{class:"empty-description"},"你还没有拉黑任何用户")])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.filteredUsers,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"user-item"},[e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("view",{class:"user-avatar"},[t.avatar?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.avatar,class:"avatar-image"},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"avatar-placeholder"},[e.createElementVNode("text",{class:"avatar-text"},e.toDisplayString(t.name.charAt(0)),1)]))]),e.createElementVNode("view",{class:"user-details"},[e.createElementVNode("text",{class:"user-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"user-id"},"ID: "+e.toDisplayString(t.id),1),e.createElementVNode("text",{class:"block-date"},"拉黑时间: "+e.toDisplayString(n.formatDate(t.blockDate)),1)])]),e.createElementVNode("view",{class:"user-actions"},[e.createElementVNode("view",{class:"action-button unblock-btn",onClick:e=>n.unblockUser(t)},[e.createElementVNode("text",{class:"action-text"},"解除拉黑")],8,["onClick"])])])))),128))]),e.createElementVNode("view",{class:"bottom-tip"},[e.createElementVNode("text",{class:"tip-text"},"拉黑的用户将无法与你联系，也无法看到你的动态")]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const G=a({name:"CustomerServicePage",data:()=>({activeTab:"orders",questions:["账号处罚常见问题","为什么封禁账号不能注销","举报相关常见问题","账号被处罚了我该怎么办?","账号实名相关问题"]}),methods:{goBack(){uni.navigateBack()},switchTab(e){this.activeTab=e},goToService(e){uni.showToast({title:`进入${e}服务`,icon:"none"})},goToQuestion(e){uni.showToast({title:`查看问题：${e}`,icon:"none"})},callCustomerService(){uni.showModal({title:"客服电话",content:"400-123-4567",confirmText:"拨打",success:e=>{e.confirm&&uni.showToast({title:"正在拨打客服电话",icon:"none"})}})},initiateNewService(){uni.showToast({title:"发起新服务",icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"customer-service-page"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"back-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("view",{class:"back-arrow"})]),e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"title"},"Afriends客服中心"),e.createElementVNode("text",{class:"subtitle"},"7x24 守护您的Afriends体验")]),e.createElementVNode("view",{class:"mascot"},[e.createElementVNode("view",{class:"cat-character"},[e.createElementVNode("view",{class:"cat-face"},[e.createElementVNode("view",{class:"cat-eye left-eye"}),e.createElementVNode("view",{class:"cat-eye right-eye"}),e.createElementVNode("view",{class:"cat-mouth"})]),e.createElementVNode("view",{class:"cat-body"},[e.createElementVNode("view",{class:"logo-symbol"},"A")])])])]),e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"service-grid"},[e.createElementVNode("view",{class:"grid-row"},[e.createElementVNode("view",{class:"service-item",onClick:a[1]||(a[1]=e=>n.goToService("appeal"))},[e.createElementVNode("view",{class:"service-icon appeal-icon"},[e.createElementVNode("view",{class:"wave-line"}),e.createElementVNode("view",{class:"arrow-up"})]),e.createElementVNode("text",{class:"service-label"},"处罚申诉")]),e.createElementVNode("view",{class:"service-item",onClick:a[2]||(a[2]=e=>n.goToService("report"))},[e.createElementVNode("view",{class:"service-icon report-icon"},[e.createElementVNode("view",{class:"exclamation-mark"}),e.createElementVNode("view",{class:"person-silhouette"})]),e.createElementVNode("text",{class:"service-label"},"举报中心")]),e.createElementVNode("view",{class:"service-item",onClick:a[3]||(a[3]=e=>n.goToService("security"))},[e.createElementVNode("view",{class:"service-icon security-icon"},[e.createElementVNode("view",{class:"shield"}),e.createElementVNode("view",{class:"checkmark"})]),e.createElementVNode("text",{class:"service-label"},"安全中心")])]),e.createElementVNode("view",{class:"grid-row"},[e.createElementVNode("view",{class:"service-item",onClick:a[4]||(a[4]=e=>n.goToService("verification"))},[e.createElementVNode("view",{class:"service-icon verification-icon"},[e.createElementVNode("view",{class:"lightning"}),e.createElementVNode("view",{class:"speech-bubble"})]),e.createElementVNode("text",{class:"service-label"},"验证助手")]),e.createElementVNode("view",{class:"service-item",onClick:a[5]||(a[5]=e=>n.goToService("shop"))},[e.createElementVNode("view",{class:"service-icon shop-icon"},[e.createElementVNode("view",{class:"storefront"})]),e.createElementVNode("text",{class:"service-label"},"抖店入驻")]),e.createElementVNode("view",{class:"service-item",onClick:a[6]||(a[6]=e=>n.goToService("selling"))},[e.createElementVNode("view",{class:"service-icon selling-icon"},[e.createElementVNode("view",{class:"people-group"}),e.createElementVNode("view",{class:"shopping-bag"})]),e.createElementVNode("text",{class:"service-label"},"我要带货")])]),e.createElementVNode("view",{class:"grid-row"},[e.createElementVNode("view",{class:"service-item",onClick:a[7]||(a[7]=e=>n.goToService("account-recovery"))},[e.createElementVNode("view",{class:"service-icon recovery-icon"},[e.createElementVNode("view",{class:"star"}),e.createElementVNode("view",{class:"person-silhouette"})]),e.createElementVNode("text",{class:"service-label"},"账号找回")]),e.createElementVNode("view",{class:"service-item",onClick:a[8]||(a[8]=e=>n.goToService("account-security"))},[e.createElementVNode("view",{class:"service-icon account-security-icon"},[e.createElementVNode("view",{class:"shield-100"}),e.createElementVNode("text",{class:"hundred"},"100")]),e.createElementVNode("text",{class:"service-label"},"账号安全")]),e.createElementVNode("view",{class:"service-item",onClick:a[9]||(a[9]=e=>n.goToService("enterprise"))},[e.createElementVNode("view",{class:"service-icon enterprise-icon"},[e.createElementVNode("view",{class:"hexagon"})]),e.createElementVNode("text",{class:"service-label"},"企业认证")])]),e.createElementVNode("view",{class:"grid-row"},[e.createElementVNode("view",{class:"service-item",onClick:a[10]||(a[10]=e=>n.goToService("billing"))},[e.createElementVNode("view",{class:"service-icon billing-icon"},[e.createElementVNode("view",{class:"currency-symbol"},"¥"),e.createElementVNode("view",{class:"document"})]),e.createElementVNode("text",{class:"service-label"},"月付查账")]),e.createElementVNode("view",{class:"service-item"}),e.createElementVNode("view",{class:"service-item"})])]),e.createElementVNode("view",{class:"pagination-dots"},[e.createElementVNode("view",{class:"dot active"}),e.createElementVNode("view",{class:"dot"})]),e.createElementVNode("view",{class:"tabs-section"},[e.createElementVNode("view",{class:"tabs-header"},[e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"orders"===i.activeTab}]),onClick:a[11]||(a[11]=e=>n.switchTab("orders"))},[e.createElementVNode("text",{class:"tab-text"},"订单")],2),e.createElementVNode("view",{class:e.normalizeClass(["tab",{active:"submissions"===i.activeTab}]),onClick:a[12]||(a[12]=e=>n.switchTab("submissions"))},[e.createElementVNode("text",{class:"tab-text"},"投稿")],2),e.createElementVNode("view",{class:"view-all"},[e.createElementVNode("text",{class:"view-all-text"},"查看全部 >")])]),e.createElementVNode("view",{class:"tab-content"},[e.createElementVNode("view",{class:"content-scroll"},[e.createElementVNode("view",{class:"content-item"},[e.createElementVNode("view",{class:"item-image"},[e.createElementVNode("view",{class:"food-image"},[e.createElementVNode("view",{class:"soup-bowl"}),e.createElementVNode("view",{class:"ingredients"})])]),e.createElementVNode("view",{class:"item-info"},[e.createElementVNode("text",{class:"item-title"},"【逃离工位】单人快..."),e.createElementVNode("text",{class:"item-description"},"含锅底小特色瓶子饭"),e.createElementVNode("text",{class:"item-price"},"¥34.9")]),e.createElementVNode("view",{class:"consult-button"},[e.createElementVNode("text",{class:"consult-text"},"咨询")])]),e.createElementVNode("view",{class:"content-item"},[e.createElementVNode("view",{class:"item-image"},[e.createElementVNode("view",{class:"choice-image"},[e.createElementVNode("view",{class:"cylinder-1"}),e.createElementVNode("view",{class:"cylinder-2"})])]),e.createElementVNode("view",{class:"item-info"},[e.createElementVNode("text",{class:"item-title"},"2选1"),e.createElementVNode("text",{class:"item-description"},"选择您喜欢的商品"),e.createElementVNode("text",{class:"item-price"},"¥29.9")]),e.createElementVNode("view",{class:"consult-button"},[e.createElementVNode("text",{class:"consult-text"},"咨询")])])])])]),e.createElementVNode("view",{class:"my-services-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"我的服务"),e.createElementVNode("view",{class:"arrow-icon"},[e.createElementVNode("view",{class:"arrow-right-large"})])])]),e.createElementVNode("view",{class:"common-questions-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"常见问题"),e.createElementVNode("view",{class:"view-more"},[e.createElementVNode("text",{class:"view-more-text"},"查看更多 >")])]),e.createElementVNode("view",{class:"questions-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.questions,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"question-item",key:a,onClick:e=>n.goToQuestion(t)},[e.createElementVNode("text",{class:e.normalizeClass(["question-number",{active:a<3}])},e.toDisplayString(a+1),3),e.createElementVNode("text",{class:"question-text"},e.toDisplayString(t),1)],8,["onClick"])))),128))])])]),e.createElementVNode("view",{class:"bottom-action-bar"},[e.createElementVNode("view",{class:"phone-button",onClick:a[13]||(a[13]=(...e)=>n.callCustomerService&&n.callCustomerService(...e))},[e.createElementVNode("view",{class:"phone-icon"}),e.createElementVNode("text",{class:"button-text"},"客服电话")]),e.createElementVNode("view",{class:"new-service-button",onClick:a[14]||(a[14]=(...e)=>n.initiateNewService&&n.initiateNewService(...e))},[e.createElementVNode("view",{class:"speech-bubble-icon"},[e.createElementVNode("view",{class:"three-dots"})]),e.createElementVNode("text",{class:"button-text"},"发起新服务")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const H=a({name:"TermsOfServicePage",methods:{goBack(){uni.navigateBack()}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"terms-of-service-page"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"intro-section"},[e.createElementVNode("text",{class:"intro-title"},"交友软件服务条款"),e.createElementVNode("text",{class:"intro-text"},"欢迎使用本软件！本条款是您与我们之间就本软件的使用所达成的协议。请您在注册、登录或使用本软件前，仔细阅读并充分理解本条款的全部内容。如果您不同意本条款的任何内容，请不要注册、登录或使用本软件。您注册、登录或使用本软件的行为，即视为您已同意受本条款约束。")]),e.createElementVNode("view",{class:"terms-content"},[e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"I."),e.createElementVNode("text",{class:"term-title"},"账号注册与管理"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"注册资格"),e.createElementVNode("text",{class:"item-content"},"用户必须年满18周岁，具有完全民事行为能力。我们保留根据法律法规和实际情况调整注册资格的权利。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"注册信息"),e.createElementVNode("text",{class:"item-content"},"用户必须提供真实、准确、完整的个人信息（如手机号、昵称、性别、年龄、头像等），并保持信息更新。用户对提供虚假、不准确、不完整或过时信息造成的后果承担责任。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"3."),e.createElementVNode("text",{class:"item-title"},"账号安全"),e.createElementVNode("text",{class:"item-content"},"用户必须妥善保管自己的账号和密码，不得转让、出租、出售或分享账号。如发现账号被非法使用或存在安全风险，应立即通知我们。因用户保管不当造成的损失，我们不承担责任。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"4."),e.createElementVNode("text",{class:"item-title"},"账号注销"),e.createElementVNode("text",{class:"item-content"},"用户有权随时申请注销账号。注销后，个人信息将按照隐私政策进行处理，用户将无法使用相关服务。")])])]),e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"II."),e.createElementVNode("text",{class:"term-title"},"服务内容与使用规则"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"服务内容"),e.createElementVNode("text",{class:"item-content"},"本软件提供交友相关服务，包括但不限于用户匹配、聊天沟通、动态分享、活动组织等。具体内容以本软件实际提供为准。我们保留根据业务发展和用户需求调整、更新或终止服务内容的权利，并会适当通知。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"使用规则"),e.createElementVNode("text",{class:"item-content"},"用户在使用本软件时，必须遵守国家法律法规、社会道德和公共秩序。禁止行为包括：发布违法、违规、虚假、欺诈、淫秽、色情、暴力、恐怖、歧视、侮辱或诽谤等有害信息；侵犯他人知识产权、隐私权、名誉权或其他合法权益；利用本软件进行诈骗、传销、赌博或其他违法犯罪活动；干扰或破坏本软件正常运行，或恶意攻击、修改、破解本软件；违反本软件发布的其他规则和规定。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"3."),e.createElementVNode("text",{class:"item-title"},"信息发布与传播"),e.createElementVNode("text",{class:"item-content"},"用户对本软件上发布的内容（包括但不限于文字、图片、视频）承担责任，确保内容合法、真实、准确，不侵犯他人权利。我们有权对发布的内容进行审核。如内容违规，我们可以直接删除、屏蔽或限制传播，无需通知，并可能根据情节轻重对账号进行警告、暂停或永久封禁。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"4."),e.createElementVNode("text",{class:"item-title"},"付费服务"),e.createElementVNode("text",{class:"item-content"},"部分服务为付费服务。用户可根据需要选择购买。购买前，用户必须仔细阅读服务说明和价格信息。付费服务的具体内容、价格和有效期以本软件相关页面为准。购买后，付费服务一般不予退款，除非法律法规另有规定或双方另有约定。")])])]),e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"III."),e.createElementVNode("text",{class:"term-title"},"隐私保护"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"信息收集"),e.createElementVNode("text",{class:"item-content"},"我们按照隐私政策收集、使用、存储和保护用户的个人信息。在注册和使用过程中，我们可能收集基本信息（如姓名、性别、年龄）、联系信息、位置信息和行为数据，以提供更好的服务和个性化体验。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"信息使用与共享"),e.createElementVNode("text",{class:"item-content"},"我们仅在本条款和隐私政策规定的范围内使用用户的个人信息，不会向无关第三方分享、转让或披露个人信息，除非在以下情况下：获得用户明确同意；法律法规要求或主管机关指示；保护我们或其他用户的合法权益；与关联公司、合作伙伴等共享以提供软件服务所必需。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"3."),e.createElementVNode("text",{class:"item-title"},"信息安全"),e.createElementVNode("text",{class:"item-content"},"我们将采取合理的技术和管理措施保护用户个人信息安全，防止信息泄露、损坏或丢失。如发生个人信息安全事件，我们将及时通知用户并按照相关法律法规处理。")])])]),e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"IV."),e.createElementVNode("text",{class:"term-title"},"知识产权"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"软件与内容"),e.createElementVNode("text",{class:"item-content"},"本软件及其内容（如文字、图片、音频、视频、图标）的所有知识产权均属于我们或相关权利人。用户仅有权在本条款允许的范围内使用本软件和相关内容。未经我们或相关权利人书面同意，用户不得复制、传播、修改、改编、出租、出售或以其他方式使用本软件和相关内容。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"用户内容授权"),e.createElementVNode("text",{class:"item-content"},"对于用户在本软件上发布的内容，用户授予我们全球性、不可撤销、永久性、免费且可再许可的权利，包括使用、复制、修改、改编、发布、翻译、传播、展示、表演和创作衍生作品等，用于本软件的运营、推广和其他合法目的。")])])]),e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"V."),e.createElementVNode("text",{class:"term-title"},"责任限制与免责声明"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"责任限制"),e.createElementVNode("text",{class:"item-content"},"在法律法规允许的范围内，我们对本软件服务或相关事项给用户造成的任何直接、间接、偶然、特殊、惩罚性或后果性损失（包括但不限于利润损失、数据丢失、业务中断）不承担责任，无论原因如何（包括但不限于合同、侵权、过失），除非损失由我们的故意行为或重大过失造成。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"免责声明"),e.createElementVNode("text",{class:"item-content"},"本软件服务可能受到各种因素影响，包括但不限于网络故障、服务器故障、通信故障、黑客攻击、计算机病毒、法律法规变化，导致服务中断、延迟、错误或不可用。我们对此不承担责任，但会努力减少此类情况的发生并及时通知。")])])]),e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"VI."),e.createElementVNode("text",{class:"term-title"},"协议变更与终止"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"协议变更"),e.createElementVNode("text",{class:"item-content"},"我们有权根据业务发展、法律法规变化等修改或更新本条款。修改后的条款将在本软件上发布，自发布之日起生效。如用户继续使用本软件服务，即视为用户已接受变更后的条款。如用户不同意变更后的条款，应停止使用本软件服务。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"协议终止"),e.createElementVNode("text",{class:"item-content"},"在以下情况下，我们有权直接终止本条款和用户对本软件服务的使用，无需通知：用户违反本条款任何规定；法律法规要求或主管机关指示；本软件因业务调整、技术升级或其他原因需要停止运营。协议终止后，我们将按照相关规定处理用户个人信息，用户应立即停止使用本软件服务。如用户违反本条款给造成损失，用户应承担赔偿责任。")])])]),e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"VII."),e.createElementVNode("text",{class:"term-title"},"争议解决"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"适用法律"),e.createElementVNode("text",{class:"item-content"},"本条款的签署、履行、解释和争议解决均适用中华人民共和国法律（为本条款之目的，不包括香港特别行政区、澳门特别行政区和台湾地区的法律）。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"争议解决方式"),e.createElementVNode("text",{class:"item-content"},"如用户与我们之间就本条款或本软件服务发生争议，双方应首先通过友好协商解决。如协商不成，任何一方均有权向有管辖权的人民法院提起诉讼。")])])]),e.createElementVNode("view",{class:"term-section"},[e.createElementVNode("text",{class:"term-number"},"VIII."),e.createElementVNode("text",{class:"term-title"},"其他条款"),e.createElementVNode("view",{class:"term-items"},[e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"1."),e.createElementVNode("text",{class:"item-title"},"条款完整性"),e.createElementVNode("text",{class:"item-content"},"本条款构成用户与我们之间关于使用本软件服务的完整协议，取代之前关于本软件服务的所有口头或书面协议。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"2."),e.createElementVNode("text",{class:"item-title"},"条款可分割性"),e.createElementVNode("text",{class:"item-content"},"如本条款任何规定被视为无效或不可执行，不影响其他规定的有效性和可执行性，此类无效或不可执行的规定应被视为可分割的，不影响本条款其他部分的效力。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"3."),e.createElementVNode("text",{class:"item-title"},"弃权"),e.createElementVNode("text",{class:"item-content"},"我们未行使或延迟行使本条款下的任何权利或救济，不应被视为放弃该权利或救济；任何单一行使权利或救济的行为不影响我们行使其他权利或救济。")]),e.createElementVNode("view",{class:"term-item"},[e.createElementVNode("text",{class:"item-number"},"4."),e.createElementVNode("text",{class:"item-title"},"通知"),e.createElementVNode("text",{class:"item-content"},"我们向用户发出的通知可通过应用内消息、短信、邮件或其他合理方式进行。通知自发送之日起视为送达。如用户因自身原因无法接收通知，不影响通知的效力。")])])])]),e.createElementVNode("view",{class:"closing-section"},[e.createElementVNode("text",{class:"closing-text"},"请您再次仔细阅读本条款，确保您已充分理解并同意其全部内容。如有任何疑问或建议，请随时联系我们的客服人员。")])]),e.createElementVNode("view",{class:"home-indicator"})])}],["__scopeId","data-v-3241990c"]]);const Q=a({data:()=>({}),methods:{goBack(){uni.navigateBack()},switchToAccount(e){uni.showModal({title:"切换账号",content:"确定要切换到该账号吗？",success:e=>{e.confirm&&(uni.showToast({title:"账号切换成功",icon:"success"}),setTimeout((()=>{uni.redirectTo({url:"/pages/feed/content-feed"})}),1500))}})},addNewAccount(){uni.navigateTo({url:"/pages/login/login-replica"})},logoutCurrent(){uni.showModal({title:"确认退出",content:"确定要退出当前账号吗？",success:e=>{e.confirm&&(uni.showToast({title:"已退出当前账号",icon:"success"}),setTimeout((()=>{uni.redirectTo({url:"/pages/login/login-replica"})}),1500))}})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"current-account"},[e.createElementVNode("view",{class:"account-header"},[e.createElementVNode("text",{class:"header-text"},"当前账号")]),e.createElementVNode("view",{class:"account-item current"},[e.createElementVNode("view",{class:"account-left"},[e.createElementVNode("view",{class:"account-avatar"},"👩"),e.createElementVNode("view",{class:"account-info"},[e.createElementVNode("text",{class:"account-name"},"当前用户"),e.createElementVNode("text",{class:"account-phone"},"138****8888")])]),e.createElementVNode("view",{class:"current-badge"},"当前")])]),e.createElementVNode("view",{class:"other-accounts"},[e.createElementVNode("view",{class:"account-header"},[e.createElementVNode("text",{class:"header-text"},"其他账号")]),e.createElementVNode("view",{class:"account-item",onClick:a[0]||(a[0]=e=>n.switchToAccount("account1"))},[e.createElementVNode("view",{class:"account-left"},[e.createElementVNode("view",{class:"account-avatar"},"👨"),e.createElementVNode("view",{class:"account-info"},[e.createElementVNode("text",{class:"account-name"},"张三"),e.createElementVNode("text",{class:"account-phone"},"139****9999")])]),e.createElementVNode("text",{class:"arrow"},"›")]),e.createElementVNode("view",{class:"account-item",onClick:a[1]||(a[1]=e=>n.switchToAccount("account2"))},[e.createElementVNode("view",{class:"account-left"},[e.createElementVNode("view",{class:"account-avatar"},"👧"),e.createElementVNode("view",{class:"account-info"},[e.createElementVNode("text",{class:"account-name"},"李四"),e.createElementVNode("text",{class:"account-phone"},"137****7777")])]),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"add-account"},[e.createElementVNode("view",{class:"account-item",onClick:a[2]||(a[2]=(...e)=>n.addNewAccount&&n.addNewAccount(...e))},[e.createElementVNode("view",{class:"account-left"},[e.createElementVNode("view",{class:"account-avatar add-icon"},"+"),e.createElementVNode("view",{class:"account-info"},[e.createElementVNode("text",{class:"account-name"},"添加账号"),e.createElementVNode("text",{class:"account-phone"},"使用其他账号登录")])]),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"bottom-actions"},[e.createElementVNode("view",{class:"action-button logout",onClick:a[3]||(a[3]=(...e)=>n.logoutCurrent&&n.logoutCurrent(...e))},[e.createElementVNode("text",{class:"action-text"},"退出当前账号")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const W=a({data:()=>({selectedMode:"normal"}),methods:{goBack(){uni.navigateBack()},selectMode(e){this.selectedMode=e,uni.showToast({title:`已选择${this.getModeName(e)}`,icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)},getModeName:e=>({normal:"普通模式",concise:"简洁模式",minor:"未成年人模式",care:"关怀模式"}[e]||"未知模式")}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"nav-bar"}),e.createElementVNode("view",{class:"content-area"},[e.createElementVNode("view",{class:"section-header"},"模式切换"),e.createElementVNode("view",{class:"mode-list"},[e.createElementVNode("view",{class:"mode-item",onClick:a[0]||(a[0]=e=>n.selectMode("normal"))},[e.createElementVNode("text",{class:"mode-text"},"普通模式")]),e.createElementVNode("view",{class:"mode-item",onClick:a[1]||(a[1]=e=>n.selectMode("concise"))},[e.createElementVNode("text",{class:"mode-text"},"简洁模式")]),e.createElementVNode("view",{class:"mode-item",onClick:a[2]||(a[2]=e=>n.selectMode("minor"))},[e.createElementVNode("text",{class:"mode-text"},"未成年人模式")]),e.createElementVNode("view",{class:"mode-item",onClick:a[3]||(a[3]=e=>n.selectMode("care"))},[e.createElementVNode("text",{class:"mode-text"},"关怀模式")])])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const J=a({name:"NotificationSettings",data:()=>({notificationSettings:{chatNotification:!0,likeAndFavorite:!1,comment:!1,mention:!1,contentRecommend:!1,userRecommend:!1}}),methods:{goBack(){uni.navigateBack()},goToNotificationDisplay(){uni.navigateTo({url:"/pages/settings/notification-display"})},toggleSetting(e,t){this.notificationSettings[e]=t.detail.value;let a="";switch(e){case"chatNotification":a="聊天消息";break;case"likeAndFavorite":a="赞和收藏";break;case"comment":a="评论";break;case"mention":a="@";break;case"contentRecommend":a="内容推荐";break;case"userRecommend":a="用户推荐"}uni.showToast({title:`${a}通知已${t.detail.value?"开启":"关闭"}`,icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"notification-settings-page"},[e.createElementVNode("view",{class:"content-area"},[e.createElementVNode("view",{class:"section-group"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"聊天消息")]),e.createElementVNode("view",{class:"settings-list"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"聊天消息通知")]),e.createElementVNode("view",{class:"setting-right"},[e.createElementVNode("switch",{class:"setting-switch",checked:i.notificationSettings.chatNotification,onChange:a[0]||(a[0]=e=>n.toggleSetting("chatNotification",e))},null,40,["checked"])])]),e.createElementVNode("view",{class:"setting-item",onClick:a[1]||(a[1]=(...e)=>n.goToNotificationDisplay&&n.goToNotificationDisplay(...e))},[e.createElementVNode("text",{class:"setting-label"},"通知显示内容"),e.createElementVNode("text",{class:"setting-arrow"},"›")])])]),e.createElementVNode("view",{class:"section-group"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"互动通知")]),e.createElementVNode("view",{class:"settings-list"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"赞和收藏")]),e.createElementVNode("view",{class:"setting-right"},[e.createElementVNode("switch",{class:"setting-switch",checked:i.notificationSettings.likeAndFavorite,onChange:a[2]||(a[2]=e=>n.toggleSetting("likeAndFavorite",e))},null,40,["checked"])])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"评论")]),e.createElementVNode("view",{class:"setting-right"},[e.createElementVNode("switch",{class:"setting-switch",checked:i.notificationSettings.comment,onChange:a[3]||(a[3]=e=>n.toggleSetting("comment",e))},null,40,["checked"])])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"@")]),e.createElementVNode("view",{class:"setting-right"},[e.createElementVNode("switch",{class:"setting-switch",checked:i.notificationSettings.mention,onChange:a[4]||(a[4]=e=>n.toggleSetting("mention",e))},null,40,["checked"])])])])]),e.createElementVNode("view",{class:"section-group"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"推荐通知")]),e.createElementVNode("view",{class:"settings-list"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"内容推荐")]),e.createElementVNode("view",{class:"setting-right"},[e.createElementVNode("switch",{class:"setting-switch",checked:i.notificationSettings.contentRecommend,onChange:a[5]||(a[5]=e=>n.toggleSetting("contentRecommend",e))},null,40,["checked"])])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-left"},[e.createElementVNode("text",{class:"setting-label"},"用户推荐")]),e.createElementVNode("view",{class:"setting-right"},[e.createElementVNode("switch",{class:"setting-switch",checked:i.notificationSettings.userRecommend,onChange:a[6]||(a[6]=e=>n.toggleSetting("userRecommend",e))},null,40,["checked"])])])])])])])}]]);const Y=a({name:"PrivacySettings",data:()=>({settings:{oneClickProtection:!1,showMyStatus:!1,allowFriendsComment:!1,allowFriendsAt:!1,publicCollections:!1,friendVerification:!1,recommendFriends:!1}}),methods:{goBack(){uni.navigateBack()},toggleSetting(e){this.settings[e]=!this.settings[e],uni.showToast({title:"设置已保存",icon:"success"})},goToSystemPermissions(){uni.navigateTo({url:"/pages/settings/system-permissions"})},goToAddWays(){uni.navigateTo({url:"/pages/settings/add-ways"})},goToBlacklist(){uni.navigateTo({url:"/pages/settings/blocked-users"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"privacy-settings"},[e.createElementVNode("scroll-view",{class:"content","scroll-y":""},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"互动")]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"一键防护"),e.createElementVNode("text",{class:"setting-desc"},"开启后,7天内将不接收陌生人的好友申请/评论/分享")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[0]||(a[0]=e=>n.toggleSetting("oneClickProtection"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.oneClickProtection}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.oneClickProtection}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"只允许我的好友评论我")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[1]||(a[1]=e=>n.toggleSetting("allowFriendsComment"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.allowFriendsComment}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.allowFriendsComment}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"只允许我的好友@我")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[2]||(a[2]=e=>n.toggleSetting("allowFriendsAt"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.allowFriendsAt}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.allowFriendsAt}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"公开我的收藏")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[3]||(a[3]=e=>n.toggleSetting("publicCollections"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.publicCollections}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.publicCollections}])},null,2)],2)])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"朋友")]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"加我为好友时需要验证")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[4]||(a[4]=e=>n.toggleSetting("friendVerification"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.friendVerification}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.friendVerification}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item",onClick:a[5]||(a[5]=(...e)=>n.goToAddWays&&n.goToAddWays(...e))},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"添加我的方式")]),e.createElementVNode("view",{class:"arrow-right"},[e.createElementVNode("text",{class:"arrow-icon"},"›")])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"给我推荐可能认识的人")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[6]||(a[6]=e=>n.toggleSetting("recommendFriends"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.recommendFriends}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.recommendFriends}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item",onClick:a[7]||(a[7]=(...e)=>n.goToBlacklist&&n.goToBlacklist(...e))},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"黑名单用户")]),e.createElementVNode("view",{class:"arrow-right"},[e.createElementVNode("text",{class:"arrow-icon"},"›")])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"权限")]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("view",{class:"setting-item",onClick:a[8]||(a[8]=(...e)=>n.goToSystemPermissions&&n.goToSystemPermissions(...e))},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"系统权限管理"),e.createElementVNode("text",{class:"setting-desc"},"APP内使用的所有系统权限")]),e.createElementVNode("view",{class:"arrow-right"},[e.createElementVNode("text",{class:"arrow-icon"},"›")])])])])])])}],["__scopeId","data-v-99baf36b"]]);const K=a({name:"AccountSecurityPage",data:()=>({}),methods:{goBack(){uni.navigateBack()},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToChatList(){uni.navigateTo({url:"/pages/chat/chat-list"})},goToAIChat(){uni.navigateTo({url:"/pages/chat/chat"})},goToFriendList(){uni.navigateTo({url:"/pages/chat/friend-list"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})},goToPhoneNumber(){uni.showToast({title:"手机号设置",icon:"none"})},goToPassword(){uni.showToast({title:"密码设置",icon:"none"})},goToThirdPartyBinding(){uni.navigateTo({url:"/pages/settings/third-party-binding"})},goToRealNameVerification(){uni.navigateTo({url:"/pages/verification/real-name-verification"})},goToOfficialCertification(){uni.navigateTo({url:"/pages/verification/official-certification"})},goToDeviceManagement(){uni.navigateTo({url:"/pages/settings/device-management"})},goToAccountManagement(){uni.navigateTo({url:"/pages/settings/switch-account"})},goToAccountDeletion(){uni.showToast({title:"注销账号",icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"account-security-page"},[e.createElementVNode("view",{class:"security-list"},[e.createElementVNode("view",{class:"list-group"},[e.createElementVNode("view",{class:"list-item",onClick:a[0]||(a[0]=(...e)=>n.goToPhoneNumber&&n.goToPhoneNumber(...e))},[e.createElementVNode("text",{class:"item-label"},"手机号"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-value"},"+86133****8358"),e.createElementVNode("view",{class:"arrow-icon"},">")])]),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"list-item",onClick:a[1]||(a[1]=(...e)=>n.goToPassword&&n.goToPassword(...e))},[e.createElementVNode("text",{class:"item-label"},"登录密码"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-value"},"未设置"),e.createElementVNode("view",{class:"arrow-icon"},">")])])]),e.createElementVNode("view",{class:"list-group"},[e.createElementVNode("view",{class:"list-item",onClick:a[2]||(a[2]=(...e)=>n.goToThirdPartyBinding&&n.goToThirdPartyBinding(...e))},[e.createElementVNode("text",{class:"item-label"},"第三方账号绑定"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"arrow-icon"},">")])])]),e.createElementVNode("view",{class:"list-group"},[e.createElementVNode("view",{class:"list-item",onClick:a[3]||(a[3]=(...e)=>n.goToRealNameVerification&&n.goToRealNameVerification(...e))},[e.createElementVNode("text",{class:"item-label"},"实名认证"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"arrow-icon"},">")])]),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"list-item",onClick:a[4]||(a[4]=(...e)=>n.goToOfficialCertification&&n.goToOfficialCertification(...e))},[e.createElementVNode("text",{class:"item-label"},"官方认证"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"arrow-icon"},">")])])]),e.createElementVNode("view",{class:"list-group"},[e.createElementVNode("view",{class:"list-item",onClick:a[5]||(a[5]=(...e)=>n.goToDeviceManagement&&n.goToDeviceManagement(...e))},[e.createElementVNode("text",{class:"item-label"},"登录设备管理"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"arrow-icon"},">")])]),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"list-item",onClick:a[6]||(a[6]=(...e)=>n.goToAccountDeletion&&n.goToAccountDeletion(...e))},[e.createElementVNode("text",{class:"item-label"},"注销账号"),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"arrow-icon"},">")])])])])])}]]);const Z=a({name:"DeviceManagementPage",data:()=>({devices:[{id:0,name:"qwe",type:"iPhone 13",lastLogin:"2025-08-18 15:23",location:"中国浙江杭州",isCurrent:!0},{id:1,name:"PEQM00",type:"PEQM00",lastLogin:"2025-08-21 08:34",location:"中国天津天津",isCurrent:!1},{id:2,name:"王柳清",type:"Windows",lastLogin:"2024-11-19 08:03",location:"中国山西太原",isCurrent:!1},{id:3,name:"iPad7,5",type:"iPad",lastLogin:"2025-05-09 22:53",location:"中国吉林长春",isCurrent:!1},{id:4,name:"王柳清",type:"Windows",lastLogin:"2025-07-13 17:23",location:"中国浙江",isCurrent:!1}]}),methods:{goBack(){uni.navigateBack()},showManageOptions(){uni.showActionSheet({itemList:["批量移除设备","导出设备列表","设备安全设置"],success:e=>{switch(e.tapIndex){case 0:this.batchRemoveDevices();break;case 1:this.exportDeviceList();break;case 2:this.deviceSecuritySettings()}}})},showHelp(){uni.showModal({title:"帮助说明",content:"设备删除后，该设备再次登录时需要重新进行身份验证，包括手机验证码、密码等。这是为了保护您的账户安全。",showCancel:!1,confirmText:"我知道了"})},removeDevice(e){uni.showModal({title:"确认移除",content:"确定要移除这个设备吗？移除后该设备需要重新登录。",success:t=>{t.confirm&&(this.devices=this.devices.filter((t=>t.id!==e)),uni.showToast({title:"设备已移除",icon:"success"}))}})},batchRemoveDevices(){uni.showModal({title:"批量移除",content:"确定要移除所有非本机设备吗？",success:e=>{e.confirm&&(this.devices=this.devices.filter((e=>e.isCurrent)),uni.showToast({title:"批量移除完成",icon:"success"}))}})},exportDeviceList(){uni.showToast({title:"导出功能开发中",icon:"none"})},deviceSecuritySettings(){uni.showToast({title:"安全设置功能开发中",icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"device-management-page"},[e.createElementVNode("view",{class:"info-bar"},[e.createElementVNode("text",{class:"info-text"},"设备删除后再次登录需身份验证。"),e.createElementVNode("text",{class:"help-link",onClick:a[0]||(a[0]=(...e)=>n.showHelp&&n.showHelp(...e))},"存在疑问?")]),e.createElementVNode("view",{class:"device-list"},[e.createElementVNode("view",{class:"device-item"},[e.createElementVNode("view",{class:"device-icon"},[e.createElementVNode("view",{class:"icon-phone"})]),e.createElementVNode("view",{class:"device-info"},[e.createElementVNode("text",{class:"device-name"},"qwe"),e.createElementVNode("text",{class:"device-type"},"iPhone 13"),e.createElementVNode("text",{class:"device-login"},"2025-08-18 15:23 | 中国浙江杭州")]),e.createElementVNode("view",{class:"device-status"},[e.createElementVNode("text",{class:"status-text"},"本机")])]),e.createElementVNode("view",{class:"device-item"},[e.createElementVNode("view",{class:"device-icon"},[e.createElementVNode("view",{class:"icon-phone"})]),e.createElementVNode("view",{class:"device-info"},[e.createElementVNode("text",{class:"device-name"},"PEQM00"),e.createElementVNode("text",{class:"device-type"},"PEQM00"),e.createElementVNode("text",{class:"device-login"},"2025-08-21 08:34 | 中国天津天津")]),e.createElementVNode("view",{class:"device-actions"},[e.createElementVNode("view",{class:"action-btn",onClick:a[1]||(a[1]=e=>n.removeDevice(1))},[e.createElementVNode("text",{class:"action-text"},"移除")])])]),e.createElementVNode("view",{class:"device-item"},[e.createElementVNode("view",{class:"device-icon"},[e.createElementVNode("view",{class:"icon-desktop"})]),e.createElementVNode("view",{class:"device-info"},[e.createElementVNode("text",{class:"device-name"},"王柳清"),e.createElementVNode("text",{class:"device-type"},"Windows"),e.createElementVNode("text",{class:"device-login"},"2024-11-19 08:03 | 中国山西太原")]),e.createElementVNode("view",{class:"device-actions"},[e.createElementVNode("view",{class:"action-btn",onClick:a[2]||(a[2]=e=>n.removeDevice(2))},[e.createElementVNode("text",{class:"action-text"},"移除")])])]),e.createElementVNode("view",{class:"device-item"},[e.createElementVNode("view",{class:"device-icon"},[e.createElementVNode("view",{class:"icon-phone"})]),e.createElementVNode("view",{class:"device-info"},[e.createElementVNode("text",{class:"device-name"},"iPad7,5"),e.createElementVNode("text",{class:"device-type"},"iPad"),e.createElementVNode("text",{class:"device-login"},"2025-05-09 22:53 | 中国吉林长春")]),e.createElementVNode("view",{class:"device-actions"},[e.createElementVNode("view",{class:"action-btn",onClick:a[3]||(a[3]=e=>n.removeDevice(3))},[e.createElementVNode("text",{class:"action-text"},"移除")])])]),e.createElementVNode("view",{class:"device-item"},[e.createElementVNode("view",{class:"device-icon"},[e.createElementVNode("view",{class:"icon-desktop"})]),e.createElementVNode("view",{class:"device-info"},[e.createElementVNode("text",{class:"device-name"},"王柳清"),e.createElementVNode("text",{class:"device-type"},"Windows"),e.createElementVNode("text",{class:"device-login"},"2025-07-13 17:23 | 中国浙江")]),e.createElementVNode("view",{class:"device-actions"},[e.createElementVNode("view",{class:"action-btn",onClick:a[4]||(a[4]=e=>n.removeDevice(4))},[e.createElementVNode("text",{class:"action-text"},"移除")])])])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const X=a({name:"ThirdPartyBindingPage",data:()=>({syncFollowers:!1,syncProfile:!1}),methods:{goBack(){uni.navigateBack()},bindWechat(){uni.showModal({title:"绑定微信",content:"确定要绑定微信账号吗？",success:e=>{e.confirm&&uni.showToast({title:"微信绑定功能开发中",icon:"none"})}})},bindQQ(){uni.showModal({title:"绑定QQ",content:"确定要绑定QQ账号吗？",success:e=>{e.confirm&&uni.showToast({title:"QQ绑定功能开发中",icon:"none"})}})},bindWeibo(){uni.showModal({title:"绑定微博",content:"确定要绑定微博账号吗？",success:e=>{e.confirm&&uni.showToast({title:"微博绑定功能开发中",icon:"none"})}})},bindApple(){uni.showModal({title:"绑定Apple",content:"确定要绑定Apple账号吗？",success:e=>{e.confirm&&uni.showToast({title:"Apple绑定功能开发中",icon:"none"})}})},viewSyncDetails(){uni.showToast({title:"同步详情功能开发中",icon:"none"})},toggleSyncFollowers(e){this.syncFollowers=e.detail.value,uni.showToast({title:this.syncFollowers?"已开启粉丝同步":"已关闭粉丝同步",icon:"none"})},toggleSyncProfile(e){this.syncProfile=e.detail.value,uni.showToast({title:this.syncProfile?"已开启资料同步":"已关闭资料同步",icon:"none"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"third-party-binding-page"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"section-title"},"第三方登录方式"),e.createElementVNode("view",{class:"binding-list"},[e.createElementVNode("view",{class:"binding-item",onClick:a[0]||(a[0]=(...e)=>n.bindWechat&&n.bindWechat(...e))},[e.createElementVNode("text",{class:"platform-name"},"微信"),e.createElementVNode("view",{class:"binding-status"},[e.createElementVNode("text",{class:"status-text"},"未绑定"),e.createElementVNode("view",{class:"arrow-icon"},">")])]),e.createElementVNode("view",{class:"binding-item",onClick:a[1]||(a[1]=(...e)=>n.bindQQ&&n.bindQQ(...e))},[e.createElementVNode("text",{class:"platform-name"},"QQ"),e.createElementVNode("view",{class:"binding-status"},[e.createElementVNode("view",{class:"qq-status"},[e.createElementVNode("text",{class:"wave-icon"},"〰️"),e.createElementVNode("text",{class:"qq-username"},"糖糖没有")]),e.createElementVNode("view",{class:"arrow-icon"},">")])]),e.createElementVNode("view",{class:"binding-item",onClick:a[2]||(a[2]=(...e)=>n.bindWeibo&&n.bindWeibo(...e))},[e.createElementVNode("text",{class:"platform-name"},"微博"),e.createElementVNode("view",{class:"binding-status"},[e.createElementVNode("text",{class:"status-text"},"未绑定"),e.createElementVNode("view",{class:"arrow-icon"},">")])]),e.createElementVNode("view",{class:"binding-item",onClick:a[3]||(a[3]=(...e)=>n.bindApple&&n.bindApple(...e))},[e.createElementVNode("text",{class:"platform-name"},"Apple"),e.createElementVNode("view",{class:"binding-status"},[e.createElementVNode("text",{class:"status-text"},"未绑定"),e.createElementVNode("view",{class:"arrow-icon"},">")])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("text",{class:"section-title"},"第三方内容同步平台"),e.createElementVNode("view",{class:"binding-list"},[e.createElementVNode("view",{class:"binding-item",onClick:a[4]||(a[4]=(...e)=>n.viewSyncDetails&&n.viewSyncDetails(...e))},[e.createElementVNode("text",{class:"platform-name"},"今日头条 / 西瓜视频 / 懂车帝"),e.createElementVNode("view",{class:"binding-status"},[e.createElementVNode("text",{class:"status-text"},"查看详情"),e.createElementVNode("view",{class:"arrow-icon"},">")])])])]),e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"sync-option"},[e.createElementVNode("view",{class:"option-info"},[e.createElementVNode("text",{class:"option-title"},"同步粉丝数量"),e.createElementVNode("text",{class:"option-description"},"开启后,抖音粉丝数量将增加(关闭粉丝数量减少)")]),e.createElementVNode("switch",{checked:i.syncFollowers,onChange:a[5]||(a[5]=(...e)=>n.toggleSyncFollowers&&n.toggleSyncFollowers(...e)),color:"#007aff",class:"sync-switch"},null,40,["checked"])]),e.createElementVNode("view",{class:"sync-option"},[e.createElementVNode("view",{class:"option-info"},[e.createElementVNode("text",{class:"option-title"},"同步抖音头像和昵称信息")]),e.createElementVNode("switch",{checked:i.syncProfile,onChange:a[6]||(a[6]=(...e)=>n.toggleSyncProfile&&n.toggleSyncProfile(...e)),color:"#007aff",class:"sync-switch"},null,40,["checked"])])])])])}]]);const ee=a({name:"AddWays",data:()=>({settings:{wechatSearch:!0,phoneSearch:!0,qqSearch:!0,groupAdd:!0,cardShare:!0}}),onLoad(){this.loadSettings()},methods:{loadSettings(){try{const e=uni.getStorageSync("addWaysSettings");e&&(this.settings=JSON.parse(e))}catch(e){o("error","at pages/settings/add-ways.vue:107","加载设置失败:",e)}},toggleSetting(e){this.settings[e]=!this.settings[e],this.saveSettings(),uni.showToast({title:"设置已保存",icon:"success"})},saveSettings(){try{uni.setStorageSync("addWaysSettings",JSON.stringify(this.settings))}catch(e){o("error","at pages/settings/add-ways.vue:125","保存设置失败:",e)}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"add-ways-page"},[e.createElementVNode("scroll-view",{class:"content","scroll-y":""},[e.createElementVNode("view",{class:"section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-title"},"添加方式")]),e.createElementVNode("view",{class:"section-content"},[e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"微信号搜索"),e.createElementVNode("text",{class:"setting-desc"},"允许他人通过微信号搜索到我")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[0]||(a[0]=e=>n.toggleSetting("wechatSearch"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.wechatSearch}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.wechatSearch}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"手机号搜索"),e.createElementVNode("text",{class:"setting-desc"},"允许他人通过手机号搜索到我")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[1]||(a[1]=e=>n.toggleSetting("phoneSearch"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.phoneSearch}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.phoneSearch}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"QQ号搜索"),e.createElementVNode("text",{class:"setting-desc"},"允许他人通过QQ号搜索到我")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[2]||(a[2]=e=>n.toggleSetting("qqSearch"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.qqSearch}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.qqSearch}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"群聊添加"),e.createElementVNode("text",{class:"setting-desc"},"允许他人通过群聊添加我为好友")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[3]||(a[3]=e=>n.toggleSetting("groupAdd"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.groupAdd}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.groupAdd}])},null,2)],2)])]),e.createElementVNode("view",{class:"setting-item"},[e.createElementVNode("view",{class:"setting-info"},[e.createElementVNode("text",{class:"setting-label"},"名片分享"),e.createElementVNode("text",{class:"setting-desc"},"允许他人通过名片分享添加我为好友")]),e.createElementVNode("view",{class:"toggle-switch",onClick:a[4]||(a[4]=e=>n.toggleSetting("cardShare"))},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-track",{active:i.settings.cardShare}])},[e.createElementVNode("view",{class:e.normalizeClass(["toggle-thumb",{active:i.settings.cardShare}])},null,2)],2)])])])]),e.createElementVNode("view",{class:"privacy-note"},[e.createElementVNode("text",{class:"note-text"},"关闭某些添加方式可能会影响他人找到您，建议根据实际需要合理设置")])])])}],["__scopeId","data-v-72350fe9"]]);const te=a({name:"LanguageSettings",data:()=>({currentLanguage:"zh-CN",languages:[{code:"zh-CN",name:"简体中文",nativeName:"简体中文"},{code:"zh-HK",name:"繁体中文（香港）",nativeName:"繁體中文（香港）"},{code:"zh-TW",name:"繁体中文（台湾）",nativeName:"繁體中文（台灣）"},{code:"en",name:"English",nativeName:"English"}]}),onLoad(){this.loadCurrentLanguage()},methods:{goBack(){uni.navigateBack()},loadCurrentLanguage(){try{const e=uni.getStorageSync("appLanguage");e&&(this.currentLanguage=e)}catch(e){o("error","at pages/settings/language.vue:91","加载语言设置失败:",e)}},selectLanguage(e){this.currentLanguage!==e&&uni.showModal({title:"确认更改语言",content:"更改语言后应用将重新启动，确定要继续吗？",success:t=>{t.confirm&&(this.currentLanguage=e,this.saveLanguage(e),uni.showToast({title:"语言设置已保存",icon:"success"}),setTimeout((()=>{this.restartApp()}),1500))}})},saveLanguage(e){try{uni.setStorageSync("appLanguage",e)}catch(t){o("error","at pages/settings/language.vue:126","保存语言设置失败:",t)}},restartApp(){uni.showModal({title:"语言设置完成",content:"请手动重启应用以应用新的语言设置",showCancel:!1,success:()=>{uni.navigateBack()}})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"language-page"},[e.createElementVNode("view",{class:"content-area"},[e.createElementVNode("view",{class:"language-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.languages,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["language-item",{active:i.currentLanguage===t.code}]),key:a,onClick:e=>n.selectLanguage(t.code)},[e.createElementVNode("view",{class:"language-info"},[e.createElementVNode("text",{class:"language-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"language-native"},e.toDisplayString(t.nativeName),1)]),i.currentLanguage===t.code?(e.openBlock(),e.createElementBlock("view",{key:0,class:"language-check"},[e.createElementVNode("text",{class:"check-icon"},"✓")])):e.createCommentVNode("",!0)],10,["onClick"])))),128))]),e.createElementVNode("view",{class:"language-note"},[e.createElementVNode("text",{class:"note-text"},"更改语言后，应用将重新启动以应用新语言设置")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const ae=a({name:"NotificationDisplay",data:()=>({currentDisplayMode:"full",displayOptions:[{value:"minimal",title:"仅显示【你收到了一条消息】",description:"最简洁的通知方式，保护隐私"},{value:"medium",title:"显示朋友名称、群聊名",description:"显示发送者信息，但不显示具体内容"},{value:"full",title:"显示朋友名称、群聊名及消息内容",description:"显示完整的消息信息"}]}),onLoad(){this.loadCurrentDisplayMode()},methods:{goBack(){uni.navigateBack()},loadCurrentDisplayMode(){try{const e=uni.getStorageSync("notificationDisplayMode");e&&(this.currentDisplayMode=e)}catch(e){o("error","at pages/settings/notification-display.vue:86","加载通知显示设置失败:",e)}},selectDisplayMode(e){this.currentDisplayMode!==e&&(this.currentDisplayMode=e,this.saveDisplayMode(e),uni.showToast({title:"设置已保存",icon:"success"}))},saveDisplayMode(e){try{uni.setStorageSync("notificationDisplayMode",e)}catch(t){o("error","at pages/settings/notification-display.vue:108","保存通知显示设置失败:",t)}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"notification-display-page"},[e.createElementVNode("view",{class:"content-area"},[e.createElementVNode("view",{class:"display-options"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.displayOptions,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["option-item",{active:i.currentDisplayMode===t.value}]),key:a,onClick:e=>n.selectDisplayMode(t.value)},[e.createElementVNode("view",{class:"option-info"},[e.createElementVNode("text",{class:"option-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"option-desc"},e.toDisplayString(t.description),1)]),i.currentDisplayMode===t.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"option-check"},[e.createElementVNode("text",{class:"check-icon"},"✓")])):e.createCommentVNode("",!0)],10,["onClick"])))),128))]),e.createElementVNode("view",{class:"display-note"},[e.createElementVNode("text",{class:"note-text"},"选择通知在锁屏和通知栏中的显示方式")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const se=a({name:"OfficialCertificationPage",data:()=>({loading:!1,realnameInfo:null,schoolCount:0,jobCount:0}),onLoad(){this.loadCertificationData()},methods:{async loadCertificationData(){this.loading=!0;try{await Promise.all([this.loadRealnameData(),this.loadSchoolData(),this.loadJobData()])}catch(e){o("error","at pages/verification/official-certification.vue:96","加载认证数据失败:",e),uni.showToast({title:"加载失败，请重试",icon:"none"})}finally{this.loading=!1}},async loadRealnameData(){try{const e=await uni.request({url:"http://localhost:8888/api/bc-entities/cert-realname-base/all",method:"GET",timeout:1e4});e.data&&e.data.length>0&&(this.realnameInfo=e.data[0])}catch(e){o("error","at pages/verification/official-certification.vue:119","获取实名认证数据失败:",e)}},async loadSchoolData(){try{const e=await uni.request({url:"http://localhost:8888/api/bc-entities/cert-student-base/all",method:"GET",timeout:1e4});e.data&&(this.schoolCount=e.data.length)}catch(e){o("error","at pages/verification/official-certification.vue:136","获取学校认证数据失败:",e)}},async loadJobData(){try{const e=await uni.request({url:"http://localhost:8888/api/bc-entities/cert-job-base/all",method:"GET",timeout:1e4});e.data&&(this.jobCount=e.data.length)}catch(e){o("error","at pages/verification/official-certification.vue:153","获取职业认证数据失败:",e)}},goBack(){uni.navigateBack()},goToRealNameCertification(){uni.navigateTo({url:"/pages/verification/real-name-verification"})},goToSchoolCertification(){uni.navigateTo({url:"/pages/verification/school-certification"})},goToProfessionalCertification(){uni.navigateTo({url:"/pages/verification/professional-certification"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"official-certification-page"},[e.createElementVNode("view",{class:"certification-list"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-section"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载认证信息...")])):e.createCommentVNode("",!0),i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"list-item",onClick:a[0]||(a[0]=(...e)=>n.goToRealNameCertification&&n.goToRealNameCertification(...e))},[e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-text"},"实名认证"),i.realnameInfo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"item-desc"},e.toDisplayString(i.realnameInfo.ruleDesc||"身份验证"),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"arrow-icon"},">")])),i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"divider"})),i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:3,class:"list-item",onClick:a[1]||(a[1]=(...e)=>n.goToSchoolCertification&&n.goToSchoolCertification(...e))},[e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-text"},"学校认证"),i.schoolCount>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:"item-desc"},"支持 "+e.toDisplayString(i.schoolCount)+" 所学校",1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"arrow-icon"},">")])),i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:4,class:"divider"})),i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:5,class:"list-item",onClick:a[2]||(a[2]=(...e)=>n.goToProfessionalCertification&&n.goToProfessionalCertification(...e))},[e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-text"},"职业认证"),i.jobCount>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:"item-desc"},"支持 "+e.toDisplayString(i.jobCount)+" 种职业",1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"arrow-icon"},">")]))]),e.createElementVNode("view",{class:"terms-link",onClick:a[3]||(a[3]=(...e)=>n.goToTermsOfService&&n.goToTermsOfService(...e))},[e.createElementVNode("text",{class:"terms-text"},"服务条款")]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const oe=a({name:"SchoolCertificationPage",data:()=>({isAgreed:!1,showPicker:!1,provinces:[],schools:[],selectedProvince:"",selectedSchool:"",loading:!1,loadError:!1,errorMessage:""}),onLoad(){this.loadSchoolData()},methods:{async loadSchoolData(){this.loading=!0,this.loadError=!1,this.errorMessage="";try{const e=await uni.request({url:"http://localhost:8888/api/bc-entities/cert-student-base/all",method:"GET",timeout:1e4});if(e.data&&e.data.length>0){this.schools=e.data;const t=new Set;e.data.forEach((e=>{e.region&&t.add(e.region)})),this.provinces=Array.from(t).sort(),o("log","at pages/verification/school-certification.vue:135","成功加载学校数据:",this.schools.length,"所学校")}else this.loadError=!0,this.errorMessage="数据库中没有学校数据，请联系管理员",this.provinces=[],this.schools=[]}catch(e){o("error","at pages/verification/school-certification.vue:144","获取学校数据失败:",e),this.loadError=!0,this.errorMessage="网络连接失败，请检查网络后重试",this.provinces=[],this.schools=[],uni.showToast({title:"数据加载失败",icon:"none",duration:3e3})}finally{this.loading=!1}},getSchoolsByProvince(e){return this.schools.filter((t=>t.region===e))},goBack(){uni.navigateBack()},toggleAgreement(){this.isAgreed=!this.isAgreed},showSchoolPicker(){this.showPicker=!0},hideSchoolPicker(){this.showPicker=!1},selectProvince(e){o("log","at pages/verification/school-certification.vue:178","选择省份:",e),this.selectedProvince=e,uni.navigateTo({url:`/pages/verification/school-list?province=${encodeURIComponent(e)}`}),this.hideSchoolPicker()},async goToNextStep(){if(this.isAgreed)if(this.selectedSchool)try{uni.showLoading({title:"正在提交认证信息..."});const e=uni.getStorageSync("userId");if(!e)return uni.hideLoading(),void uni.showToast({title:"请先登录",icon:"none"});const t={name:"",degree:"",school:this.selectedSchool,province:this.selectedProvince,studentId:"",submitTime:(new Date).toISOString()},a=await this.saveCertRecord(e,"STUDENT",t);uni.hideLoading(),a.success?(uni.showToast({title:"认证信息提交成功",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:`/pages/verification/certification-feedback?type=school&school=${encodeURIComponent(this.selectedSchool)}&province=${encodeURIComponent(this.selectedProvince)}`})}),1500)):uni.showToast({title:a.message||"提交失败",icon:"none"})}catch(e){uni.hideLoading(),o("error","at pages/verification/school-certification.vue:258","提交认证信息失败:",e),uni.showToast({title:"网络错误，请重试",icon:"none"})}else uni.showToast({title:"请选择学校",icon:"none"});else uni.showToast({title:"请先同意服务条款",icon:"none"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},async saveCertRecord(e,t,a){try{const s=await uni.request({url:"http://localhost:8888/api/u-entities/user-cert-record/save",method:"POST",header:{"Content-Type":"application/json"},data:{userId:e,certType:t,certInfo:JSON.stringify(a)},timeout:1e4});if(200===s.statusCode)return s.data;throw new Error(`HTTP ${s.statusCode}`)}catch(s){throw o("error","at pages/verification/school-certification.vue:294","保存认证记录失败:",s),s}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"school-certification-page"},[e.createElementVNode("view",{class:"prompt-text"},[e.createElementVNode("text",{class:"prompt"},"请选择学校名称")]),e.createElementVNode("view",{class:"school-selection"},[i.loadError?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"selection-field",onClick:a[0]||(a[0]=(...e)=>n.showSchoolPicker&&n.showSchoolPicker(...e))},[e.createElementVNode("text",{class:"field-label"},"学校名称"),e.createElementVNode("view",{class:"selection-content"},[i.selectedSchool?(e.openBlock(),e.createElementBlock("text",{key:0,class:"selected-text"},e.toDisplayString(i.selectedSchool),1)):i.loading?(e.openBlock(),e.createElementBlock("text",{key:2,class:"loading-text"},"加载中...")):(e.openBlock(),e.createElementBlock("text",{key:1,class:"placeholder-text"},"请选择>"))])])),i.loadError?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-section"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-button",onClick:a[1]||(a[1]=(...e)=>n.loadSchoolData&&n.loadSchoolData(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"agreement-section"},[e.createElementVNode("view",{class:"agreement-item"},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:i.isAgreed}]),onClick:a[2]||(a[2]=(...e)=>n.toggleAgreement&&n.toggleAgreement(...e))},[i.isAgreed?(e.openBlock(),e.createElementBlock("text",{key:0,class:"checkmark"},"✓")):e.createCommentVNode("",!0)],2),e.createElementVNode("text",{class:"agreement-text"},"阅读并同意"),e.createElementVNode("text",{class:"agreement-link",onClick:a[3]||(a[3]=(...e)=>n.goToTermsOfService&&n.goToTermsOfService(...e))},"《AFriends官方认证服务协议》")])]),e.createElementVNode("view",{class:"next-button-section"},[e.createElementVNode("view",{class:"next-button",onClick:a[4]||(a[4]=(...e)=>n.goToNextStep&&n.goToNextStep(...e))},[e.createElementVNode("text",{class:"next-text"},"下一步")])]),e.createElementVNode("view",{class:"home-indicator"}),i.showPicker?(e.openBlock(),e.createElementBlock("view",{key:0,class:"school-picker-modal",onClick:a[7]||(a[7]=(...e)=>n.hideSchoolPicker&&n.hideSchoolPicker(...e))},[e.createElementVNode("view",{class:"modal-content",onClick:a[6]||(a[6]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("view",{class:"modal-back",onClick:a[5]||(a[5]=(...e)=>n.hideSchoolPicker&&n.hideSchoolPicker(...e))},[e.createElementVNode("view",{class:"back-arrow"})]),e.createElementVNode("text",{class:"modal-title"},"请选择您的学校"),e.createElementVNode("view",{class:"search-icon"},[e.createElementVNode("view",{class:"magnifier"})])]),e.createElementVNode("view",{class:"school-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.provinces,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"school-item",key:a,onClick:e=>n.selectProvince(t)},[e.createElementVNode("text",{class:"province-name"},e.toDisplayString(t),1),e.createElementVNode("view",{class:"arrow-icon"},">")],8,["onClick"])))),128))])])])):e.createCommentVNode("",!0)])}]]);const ie=a({name:"ProfessionalCertificationPage",data:()=>({isAgreed:!1,showPicker:!1,showJobPicker:!1,professions:[],jobTypes:[],selectedJobType:"",selectedProfession:"",loading:!1,loadError:!1,errorMessage:"",currentStep:"type"}),onLoad(){this.loadJobData()},methods:{async loadJobData(){this.loading=!0,this.loadError=!1,this.errorMessage="";try{const e=await uni.request({url:"http://localhost:8888/api/bc-entities/cert-job-base/all",method:"GET",timeout:1e4});if(e.data&&e.data.length>0){const t=new Set;e.data.forEach((e=>{e.jobType&&t.add(e.jobType)})),this.jobTypes=Array.from(t).sort(),this.professions=e.data,o("log","at pages/verification/professional-certification.vue:158","成功加载职业数据:",this.professions.length,"个职业")}else this.loadError=!0,this.errorMessage="数据库中没有职业数据，请联系管理员",this.jobTypes=[],this.professions=[]}catch(e){o("error","at pages/verification/professional-certification.vue:167","获取职业数据失败:",e),this.loadError=!0,this.errorMessage="网络连接失败，请检查网络后重试",this.jobTypes=[],this.professions=[],uni.showToast({title:"数据加载失败",icon:"none",duration:3e3})}finally{this.loading=!1}},getJobsByType(e){return this.professions.filter((t=>t.jobType===e))},showJobPickerModal(){this.showJobPicker=!0},hideJobPickerModal(){this.showJobPicker=!1},selectJob(e){o("log","at pages/verification/professional-certification.vue:200","选择具体职业:",e),o("log","at pages/verification/professional-certification.vue:201","job类型:",typeof e),o("log","at pages/verification/professional-certification.vue:202","job.jobName:",e.jobName),e&&e.jobName?(this.selectedProfession=e.jobName,this.hideJobPickerModal(),this.currentStep="type"):(o("error","at pages/verification/professional-certification.vue:209","职业对象格式错误:",e),uni.showToast({title:"选择失败，请重试",icon:"none"}))},backToJobType(){this.showJobPicker=!1,this.showPicker=!0,this.currentStep="type"},goBack(){uni.navigateBack()},toggleAgreement(){this.isAgreed=!this.isAgreed},showProfessionPicker(){this.showPicker=!0},hideProfessionPicker(){this.showPicker=!1},selectProfession(e){o("log","at pages/verification/professional-certification.vue:237","选择职业类型:",e),this.selectedJobType=e,this.hideProfessionPicker(),this.showJobPicker=!0,this.currentStep="job"},async goToNextStep(){if(this.isAgreed)if(this.selectedJobType)if(this.selectedProfession)try{uni.showLoading({title:"正在提交认证信息..."});const e=uni.getStorageSync("userId");if(!e)return uni.hideLoading(),void uni.showToast({title:"请先登录",icon:"none"});const t={name:"",jobType:this.selectedJobType,jobName:this.selectedProfession,company:"",position:this.selectedProfession,submitTime:(new Date).toISOString()},a=await this.saveCertRecord(e,"JOB",t);uni.hideLoading(),a.success?(uni.showToast({title:"认证信息提交成功",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:`/pages/verification/certification-feedback?type=professional&jobType=${encodeURIComponent(this.selectedJobType)}&jobName=${encodeURIComponent(this.selectedProfession)}`})}),1500)):uni.showToast({title:a.message||"提交失败",icon:"none"})}catch(e){uni.hideLoading(),o("error","at pages/verification/professional-certification.vue:325","提交认证信息失败:",e),uni.showToast({title:"网络错误，请重试",icon:"none"})}else uni.showToast({title:"请选择具体职业",icon:"none"});else uni.showToast({title:"请选择职业类型",icon:"none"});else uni.showToast({title:"请先同意服务条款",icon:"none"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},async saveCertRecord(e,t,a){try{const s=await uni.request({url:"http://localhost:8888/api/u-entities/user-cert-record/save",method:"POST",header:{"Content-Type":"application/json"},data:{userId:e,certType:t,certInfo:JSON.stringify(a)},timeout:1e4});if(200===s.statusCode)return s.data;throw new Error(`HTTP ${s.statusCode}`)}catch(s){throw o("error","at pages/verification/professional-certification.vue:361","保存认证记录失败:",s),s}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"professional-certification-page"},[e.createElementVNode("view",{class:"prompt-text"},[e.createElementVNode("text",{class:"prompt"},"请选择职业类型")]),e.createElementVNode("view",{class:"profession-selection"},[i.loadError?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"selection-field",onClick:a[0]||(a[0]=(...e)=>n.showProfessionPicker&&n.showProfessionPicker(...e))},[e.createElementVNode("text",{class:"field-label"},"职业类型"),e.createElementVNode("view",{class:"selection-content"},[i.selectedProfession?(e.openBlock(),e.createElementBlock("text",{key:0,class:"selected-text"},e.toDisplayString(i.selectedJobType)+" - "+e.toDisplayString(i.selectedProfession),1)):i.selectedJobType?(e.openBlock(),e.createElementBlock("text",{key:1,class:"selected-text"},e.toDisplayString(i.selectedJobType)+" - 请选择具体职业",1)):i.loading?(e.openBlock(),e.createElementBlock("text",{key:3,class:"loading-text"},"加载中...")):(e.openBlock(),e.createElementBlock("text",{key:2,class:"placeholder-text"},"请选择>"))])])),i.loadError?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-section"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-button",onClick:a[1]||(a[1]=(...e)=>n.loadJobData&&n.loadJobData(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"agreement-section"},[e.createElementVNode("view",{class:"agreement-item"},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:i.isAgreed}]),onClick:a[2]||(a[2]=(...e)=>n.toggleAgreement&&n.toggleAgreement(...e))},[i.isAgreed?(e.openBlock(),e.createElementBlock("text",{key:0,class:"checkmark"},"✓")):e.createCommentVNode("",!0)],2),e.createElementVNode("text",{class:"agreement-text"},"阅读并同意"),e.createElementVNode("text",{class:"agreement-link",onClick:a[3]||(a[3]=(...e)=>n.goToTermsOfService&&n.goToTermsOfService(...e))},"《AFriends官方认证服务协议》")])]),e.createElementVNode("view",{class:"next-button-section"},[e.createElementVNode("view",{class:"next-button",onClick:a[4]||(a[4]=(...e)=>n.goToNextStep&&n.goToNextStep(...e))},[e.createElementVNode("text",{class:"next-text"},"下一步")])]),e.createElementVNode("view",{class:"home-indicator"}),i.showPicker?(e.openBlock(),e.createElementBlock("view",{key:0,class:"profession-picker-modal",onClick:a[7]||(a[7]=(...e)=>n.hideProfessionPicker&&n.hideProfessionPicker(...e))},[e.createElementVNode("view",{class:"modal-content",onClick:a[6]||(a[6]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("view",{class:"modal-back",onClick:a[5]||(a[5]=(...e)=>n.hideProfessionPicker&&n.hideProfessionPicker(...e))},[e.createElementVNode("view",{class:"back-arrow"})]),e.createElementVNode("text",{class:"modal-title"},"请选择您的行业类型"),e.createElementVNode("view",{class:"search-icon"},[e.createElementVNode("view",{class:"magnifier"})])]),e.createElementVNode("view",{class:"profession-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.jobTypes,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"profession-item",key:a,onClick:e=>n.selectProfession(t)},[e.createElementVNode("text",{class:"profession-name"},e.toDisplayString(t),1),e.createElementVNode("view",{class:"arrow-icon"},">")],8,["onClick"])))),128))])])])):e.createCommentVNode("",!0),i.showJobPicker?(e.openBlock(),e.createElementBlock("view",{key:1,class:"job-picker-modal",onClick:a[10]||(a[10]=(...e)=>n.hideJobPickerModal&&n.hideJobPickerModal(...e))},[e.createElementVNode("view",{class:"modal-content",onClick:a[9]||(a[9]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("view",{class:"modal-back",onClick:a[8]||(a[8]=(...e)=>n.backToJobType&&n.backToJobType(...e))},[e.createElementVNode("view",{class:"back-arrow"})]),e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(i.selectedJobType)+" - 选择具体职业",1),e.createElementVNode("view",{class:"search-icon"},[e.createElementVNode("view",{class:"magnifier"})])]),e.createElementVNode("view",{class:"job-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.getJobsByType(i.selectedJobType),((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"job-item",key:a,onClick:e=>n.selectJob(t)},[e.createElementVNode("text",{class:"job-name"},e.toDisplayString(t.jobName),1)],8,["onClick"])))),128))])])])):e.createCommentVNode("",!0)])}]]);const ne=a({name:"RealNameVerificationPage",data:()=>({selectedDocumentType:"",realName:"",documentNumber:"",isAgreed:!1,showDocumentTypePicker:!1,documentTypes:[],loading:!1,loadError:!1,errorMessage:""}),onLoad(){this.loadDocumentTypes()},computed:{canProceed(){return this.selectedDocumentType&&this.realName&&this.documentNumber&&this.isAgreed}},methods:{async loadDocumentTypes(){this.loading=!0,this.loadError=!1,this.errorMessage="";try{const e=await uni.request({url:"http://localhost:8888/api/bc-entities/cert-realname-base/all",method:"GET",timeout:1e4});e.data&&e.data.length>0?(this.documentTypes=e.data.map((e=>e.idType)),o("log","at pages/verification/real-name-verification.vue:164","成功加载证件类型:",this.documentTypes)):(this.loadError=!0,this.errorMessage="数据库中没有证件类型数据，请联系管理员",this.documentTypes=[])}catch(e){o("error","at pages/verification/real-name-verification.vue:172","获取证件类型失败:",e),this.loadError=!0,this.errorMessage="网络连接失败，请检查网络后重试",this.documentTypes=[],uni.showToast({title:"数据加载失败",icon:"none",duration:3e3})}finally{this.loading=!1}},goBack(){uni.navigateBack()},goToTermsOfService(){o("log","at pages/verification/real-name-verification.vue:191","goToTermsOfService 被调用了"),uni.showToast({title:"点击了协议链接",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:"/pages/settings/terms-of-service",success:()=>{o("log","at pages/verification/real-name-verification.vue:202","跳转成功")},fail:e=>{o("error","at pages/verification/real-name-verification.vue:205","跳转失败:",e),uni.showToast({title:"跳转失败",icon:"none"})}})}),1e3)},openDocumentTypePicker(){this.showDocumentTypePicker=!0},hideDocumentTypePicker(){this.showDocumentTypePicker=!1},selectDocumentType(e){this.selectedDocumentType=e,this.hideDocumentTypePicker()},toggleAgreement(){this.isAgreed=!this.isAgreed},async goToFaceRecognition(){if(this.canProceed)if(this.realName.length<2)uni.showToast({title:"请输入正确的姓名",icon:"none"});else if("身份证"!==this.selectedDocumentType||18===this.documentNumber.length)try{uni.showLoading({title:"正在提交认证信息..."});const e=uni.getStorageSync("userId");if(!e)return uni.hideLoading(),void uni.showToast({title:"请先登录",icon:"none"});const t={name:this.realName,gender:"",idNumber:this.documentNumber,documentType:this.selectedDocumentType,submitTime:(new Date).toISOString()},a=await this.saveCertRecord(e,"REALNAME",t);uni.hideLoading(),a.success?(uni.showToast({title:"认证信息提交成功",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:"/pages/verification/face-recognition?type=realName"})}),1500)):uni.showToast({title:a.message||"提交失败",icon:"none"})}catch(e){uni.hideLoading(),o("error","at pages/verification/real-name-verification.vue:306","提交认证信息失败:",e),uni.showToast({title:"网络错误，请重试",icon:"none"})}else uni.showToast({title:"请输入正确的身份证号码",icon:"none"});else uni.showToast({title:"请完善所有信息并同意协议",icon:"none"})},async saveCertRecord(e,t,a){try{const s=await uni.request({url:"http://localhost:8888/api/u-entities/user-cert-record/save",method:"POST",header:{"Content-Type":"application/json"},data:{userId:e,certType:t,certInfo:JSON.stringify(a)},timeout:1e4});if(200===s.statusCode)return s.data;throw new Error(`HTTP ${s.statusCode}`)}catch(s){throw o("error","at pages/verification/real-name-verification.vue:337","保存认证记录失败:",s),s}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"real-name-verification-page"},[e.createElementVNode("view",{class:"disclaimer"},[e.createElementVNode("text",{class:"disclaimer-text"},"认证信息将用于AFriends平台服务,与账号唯一绑定,无法解除绑定,我们会对信息严格保密")]),e.createElementVNode("view",{class:"verification-form"},[i.loadError?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item",onClick:a[0]||(a[0]=(...e)=>n.openDocumentTypePicker&&n.openDocumentTypePicker(...e))},[e.createElementVNode("text",{class:"item-label"},"证件类型"),e.createElementVNode("view",{class:"item-content"},[i.selectedDocumentType?(e.openBlock(),e.createElementBlock("text",{key:0,class:"item-value"},e.toDisplayString(i.selectedDocumentType),1)):i.loading?(e.openBlock(),e.createElementBlock("text",{key:2,class:"loading-text"},"加载中...")):(e.openBlock(),e.createElementBlock("text",{key:1,class:"placeholder-text"},"请选择证件类型 >"))])])),i.loadError?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-section"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-button",onClick:a[1]||(a[1]=(...e)=>n.loadDocumentTypes&&n.loadDocumentTypes(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"真实姓名"),e.createElementVNode("view",{class:"item-content"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:"text",placeholder:"请填写真实姓名","onUpdate:modelValue":a[2]||(a[2]=e=>i.realName=e),maxlength:"20"},null,512),[[e.vModelText,i.realName]])])]),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"item-label"},"证件号码"),e.createElementVNode("view",{class:"item-content"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:"text",placeholder:"请填写真实证件号码","onUpdate:modelValue":a[3]||(a[3]=e=>i.documentNumber=e),maxlength:"18"},null,512),[[e.vModelText,i.documentNumber]])])])]),e.createElementVNode("view",{class:"agreement-section"},[e.createElementVNode("view",{class:"agreement-item"},[e.createElementVNode("view",{class:e.normalizeClass(["checkbox",{checked:i.isAgreed}]),onClick:a[4]||(a[4]=(...e)=>n.toggleAgreement&&n.toggleAgreement(...e))},[i.isAgreed?(e.openBlock(),e.createElementBlock("text",{key:0,class:"checkmark"},"✓")):e.createCommentVNode("",!0)],2),e.createElementVNode("text",{class:"agreement-text"},"阅读并同意"),e.createElementVNode("text",{class:"agreement-link",onClick:a[5]||(a[5]=e.withModifiers(((...e)=>n.goToTermsOfService&&n.goToTermsOfService(...e)),["stop"]))},"《实名认证服务协议》")])]),e.createElementVNode("view",{class:e.normalizeClass(["face-recognition-button",{disabled:!n.canProceed}]),onClick:a[6]||(a[6]=(...e)=>n.goToFaceRecognition&&n.goToFaceRecognition(...e))},[e.createElementVNode("text",{class:"button-text"},"进入人脸识别")],2),e.createElementVNode("view",{class:"home-indicator"}),i.showDocumentTypePicker?(e.openBlock(),e.createElementBlock("view",{key:0,class:"document-type-modal",onClick:a[9]||(a[9]=(...e)=>n.hideDocumentTypePicker&&n.hideDocumentTypePicker(...e))},[e.createElementVNode("view",{class:"modal-content",onClick:a[8]||(a[8]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},"选择证件类型"),e.createElementVNode("view",{class:"close-button",onClick:a[7]||(a[7]=(...e)=>n.hideDocumentTypePicker&&n.hideDocumentTypePicker(...e))},[e.createElementVNode("text",{class:"close-icon"},"×")])]),e.createElementVNode("view",{class:"document-type-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.documentTypes,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"document-type-item",key:a,onClick:e=>n.selectDocumentType(t)},[e.createElementVNode("text",{class:"type-name"},e.toDisplayString(t),1)],8,["onClick"])))),128))])])])):e.createCommentVNode("",!0)])}]]);const le=a({name:"FaceRecognitionPage",data:()=>({progress:0,showResult:!1,recognitionResult:"success",resultTitle:"识别成功",resultDesc:"人脸识别已完成，请继续下一步",certificationType:"realName"}),onLoad(e){e.type&&(this.certificationType=e.type)},mounted(){this.startRecognition()},methods:{goBack(){uni.navigateBack()},startRecognition(){this.progress=0;const e=setInterval((()=>{this.progress+=10,this.progress>=100&&(clearInterval(e),this.recognitionComplete())}),200)},recognitionComplete(){const e=Math.random()>.2;this.recognitionResult=e?"success":"error",this.resultTitle=e?"识别成功":"识别失败",this.resultDesc=e?"人脸识别已完成，请继续下一步":"请重新进行人脸识别",this.showResult=!0},retakePhoto(){this.progress=0,this.startRecognition()},confirmRecognition(){this.progress<100?uni.showToast({title:"识别尚未完成",icon:"none"}):"success"===this.recognitionResult?(uni.showToast({title:"认证完成",icon:"success"}),setTimeout((()=>{"realName"===this.certificationType?uni.redirectTo({url:"/pages/verification/certification-feedback?type=realName"}):uni.navigateBack()}),1500)):uni.showToast({title:"请重新识别",icon:"none"})},hideResult(){this.showResult=!1}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"face-recognition-page"},[e.createElementVNode("view",{class:"camera-preview"},[e.createElementVNode("view",{class:"preview-container"},[e.createElementVNode("view",{class:"face-frame"},[e.createElementVNode("view",{class:"frame-corner top-left"}),e.createElementVNode("view",{class:"frame-corner top-right"}),e.createElementVNode("view",{class:"frame-corner bottom-left"}),e.createElementVNode("view",{class:"frame-corner bottom-right"})]),e.createElementVNode("view",{class:"preview-placeholder"},[e.createElementVNode("view",{class:"camera-icon"},[e.createElementVNode("view",{class:"camera-lens"})]),e.createElementVNode("text",{class:"preview-text"},"摄像头预览区域")])])]),e.createElementVNode("view",{class:"recognition-tips"},[e.createElementVNode("text",{class:"tips-title"},"请将脸部放入框内"),e.createElementVNode("text",{class:"tips-desc"},"保持光线充足，面部清晰可见")]),e.createElementVNode("view",{class:"action-buttons"},[e.createElementVNode("view",{class:"retake-button",onClick:a[0]||(a[0]=(...e)=>n.retakePhoto&&n.retakePhoto(...e))},[e.createElementVNode("text",{class:"button-text"},"重新拍摄")]),e.createElementVNode("view",{class:"confirm-button",onClick:a[1]||(a[1]=(...e)=>n.confirmRecognition&&n.confirmRecognition(...e))},[e.createElementVNode("text",{class:"button-text"},"确认识别")])]),e.createElementVNode("view",{class:"progress-indicator"},[e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:i.progress+"%"})},null,4)]),e.createElementVNode("text",{class:"progress-text"},e.toDisplayString(i.progress)+"%",1)]),e.createElementVNode("view",{class:"home-indicator"}),i.showResult?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-modal",onClick:a[4]||(a[4]=(...e)=>n.hideResult&&n.hideResult(...e))},[e.createElementVNode("view",{class:"modal-content",onClick:a[3]||(a[3]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:e.normalizeClass(["result-icon",i.recognitionResult])},["success"===i.recognitionResult?(e.openBlock(),e.createElementBlock("text",{key:0,class:"success-icon"},"✓")):(e.openBlock(),e.createElementBlock("text",{key:1,class:"error-icon"},"✗"))],2),e.createElementVNode("text",{class:"result-title"},e.toDisplayString(i.resultTitle),1),e.createElementVNode("text",{class:"result-desc"},e.toDisplayString(i.resultDesc),1),e.createElementVNode("view",{class:"result-actions"},[e.createElementVNode("view",{class:"action-button",onClick:a[2]||(a[2]=(...e)=>n.hideResult&&n.hideResult(...e))},[e.createElementVNode("text",{class:"action-text"},"确定")])])])])):e.createCommentVNode("",!0)])}]]);const ce=a({name:"VerificationCompletePage",data:()=>({verificationType:"实名认证",verificationTime:"2024年8月20日 14:30",verificationStatus:"已认证",loading:!0,verificationRecord:null,errorMessage:""}),onLoad(e){e.type&&(this.verificationType=this.getCertTypeText(e.type)),this.loadVerificationRecord()},methods:{async loadVerificationRecord(){this.loading=!0;try{const e=uni.getStorageSync("userId");if(!e)return this.errorMessage="用户未登录",void(this.loading=!1);const t=await this.getUserCertRecords(e);t.data&&t.data.length>0?(this.verificationRecord=t.data[t.data.length-1],this.updateVerificationInfo()):this.errorMessage="未找到认证记录"}catch(e){o("error","at pages/verification/verification-complete.vue:164","加载认证记录失败:",e),this.errorMessage="加载认证记录失败"}finally{this.loading=!1}},getUserCertRecords:e=>new Promise(((t,a)=>{uni.request({url:"http://localhost:8888/api/u-entities/user-cert-record/user/"+e,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),updateVerificationInfo(){if(this.verificationRecord){this.verificationType=this.getCertTypeText(this.verificationRecord.certType);const e=new Date(this.verificationRecord.createdAt);this.verificationTime=this.formatDateTime(e),this.verificationStatus=this.getStatusText(this.verificationRecord.status)}},getCertTypeText:e=>({REALNAME:"实名认证",STUDENT:"学校认证",JOB:"职业认证"}[e]||"未知认证"),getStatusText:e=>({0:"待审核",1:"已通过",2:"未通过"}[e]||"未知状态"),formatDateTime:e=>`${e.getFullYear()}年${String(e.getMonth()+1).padStart(2,"0")}月${String(e.getDate()).padStart(2,"0")}日 ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`,retryLoad(){this.loadVerificationRecord()},getStatusClass(){if(!this.verificationRecord)return"status-pending";const e=this.verificationRecord.status;return 1===e?"status-success":2===e?"status-error":"status-pending"},getStatusIcon(){if(!this.verificationRecord)return"?";const e=this.verificationRecord.status;return 1===e?"✓":2===e?"✗":"⏳"},getStatusTitle(){if(!this.verificationRecord)return"认证处理中";const e=this.verificationRecord.status;return 1===e?"认证成功":2===e?"认证失败":"认证处理中"},getStatusDesc(){if(!this.verificationRecord)return"您的认证申请正在处理中，请耐心等待";const e=this.verificationRecord.status;return 1===e?`恭喜您完成${this.verificationType}，现在可以享受更多平台服务`:2===e?"很抱歉，您的认证申请未通过，请检查信息后重新提交":"您的认证申请正在审核中，我们会在1-3个工作日内完成审核"},getStatusBadgeClass(){if(!this.verificationRecord)return"badge-pending";const e=this.verificationRecord.status;return 1===e?"badge-success":2===e?"badge-error":"badge-pending"},getCertDetails(){if(!this.verificationRecord||!this.verificationRecord.certInfo)return"";try{const e=JSON.parse(this.verificationRecord.certInfo),t=this.verificationRecord.certType;return"REALNAME"===t?`${e.name||""} - ${e.documentType||""}`:"STUDENT"===t?`${e.school||""} - ${e.degree||""}`:"JOB"===t?`${e.jobType||""} - ${e.jobName||""}`:"认证详情"}catch(e){return o("error","at pages/verification/verification-complete.vue:300","解析认证详情失败:",e),"认证详情"}},goBack(){uni.navigateBack()},goToHome(){uni.navigateTo({url:"/pages/feed/content-feed"})},goToProfile(){uni.navigateTo({url:"/pages/feed/user-profile"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"verification-complete-page"},[e.createElementVNode("view",{class:"main-content"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-section"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载认证信息...")])):i.errorMessage?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-section"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.retryLoad&&n.retryLoad(...e))},[e.createElementVNode("text",{class:"retry-text"},"重试")])])):(e.openBlock(),e.createElementBlock("view",{key:2},[e.createElementVNode("view",{class:"success-icon"},[e.createElementVNode("view",{class:e.normalizeClass(["icon-circle",n.getStatusClass()])},[e.createElementVNode("text",{class:"checkmark"},e.toDisplayString(n.getStatusIcon()),1)],2)]),e.createElementVNode("view",{class:"status-title"},[e.createElementVNode("text",{class:"title-text"},e.toDisplayString(n.getStatusTitle()),1)]),e.createElementVNode("view",{class:"success-desc"},[e.createElementVNode("text",{class:"desc-text"},e.toDisplayString(n.getStatusDesc()),1)]),e.createElementVNode("view",{class:"verification-info"},[e.createElementVNode("view",{class:"info-header"},[e.createElementVNode("text",{class:"info-title"},"认证信息")]),e.createElementVNode("view",{class:"info-content"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"item-label"},"认证类型"),e.createElementVNode("text",{class:"item-value"},e.toDisplayString(i.verificationType),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"item-label"},"认证时间"),e.createElementVNode("text",{class:"item-value"},e.toDisplayString(i.verificationTime),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"item-label"},"认证状态"),e.createElementVNode("view",{class:e.normalizeClass(["status-badge",n.getStatusBadgeClass()])},[e.createElementVNode("text",{class:"status-text"},e.toDisplayString(i.verificationStatus),1)],2)]),i.verificationRecord&&i.verificationRecord.certInfo?(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-item"},[e.createElementVNode("text",{class:"item-label"},"认证详情"),e.createElementVNode("text",{class:"item-value"},e.toDisplayString(n.getCertDetails()),1)])):e.createCommentVNode("",!0)])])])),e.createElementVNode("view",{class:"next-steps"},[e.createElementVNode("text",{class:"steps-title"},"下一步您可以："),e.createElementVNode("view",{class:"steps-list"},[e.createElementVNode("view",{class:"step-item"},[e.createElementVNode("view",{class:"step-icon"},"1"),e.createElementVNode("text",{class:"step-text"},"完善个人资料")]),e.createElementVNode("view",{class:"step-item"},[e.createElementVNode("view",{class:"step-icon"},"2"),e.createElementVNode("text",{class:"step-text"},"申请官方认证")]),e.createElementVNode("view",{class:"step-item"},[e.createElementVNode("view",{class:"step-icon"},"3"),e.createElementVNode("text",{class:"step-text"},"开始使用平台服务")])])])]),e.createElementVNode("view",{class:"action-buttons"},[e.createElementVNode("view",{class:"primary-button",onClick:a[1]||(a[1]=(...e)=>n.goToHome&&n.goToHome(...e))},[e.createElementVNode("text",{class:"button-text"},"返回首页")]),e.createElementVNode("view",{class:"secondary-button",onClick:a[2]||(a[2]=(...e)=>n.goToProfile&&n.goToProfile(...e))},[e.createElementVNode("text",{class:"button-text"},"完善资料")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const re=a({name:"CertificationFeedbackPage",data(){return{certificationType:"职业认证",submitTime:this.formatDateTime(new Date),expectedTime:this.formatExpectedTime(new Date),certRecords:[],loading:!1,userId:null}},methods:{async loadCertRecords(){try{this.loading=!0;const e=uni.getStorageSync("userId");if(!e)return void uni.showToast({title:"请先登录",icon:"none"});this.userId=e;const t=await this.getUserCertRecords(e);t&&t.data&&(this.certRecords=t.data)}catch(e){o("error","at pages/verification/certification-feedback.vue:173","加载认证记录失败:",e),uni.showToast({title:"加载认证记录失败",icon:"none"})}finally{this.loading=!1}},getUserCertRecords:e=>new Promise(((t,a)=>{uni.request({url:"http://localhost:8888/api/u-entities/user-cert-record/user/"+e,method:"GET",timeout:1e4,success:e=>{t(e)},fail:e=>{a(e)}})})),getStatusText(e){switch(e){case 0:return"待审核";case 1:return"已通过";case 2:return"未通过";default:return"未知状态"}},getCertTypeText(e){switch(e){case"REALNAME":return"实名认证";case"STUDENT":return"学校认证";case"JOB":return"职业认证";default:return"未知类型"}},getStatusColor(e){switch(e){case 0:return"#FF9500";case 1:return"#34C759";case 2:return"#FF3B30";default:return"#8E8E93"}},goBack(){uni.redirectTo({url:"/pages/verification/official-certification"})},formatDateTime:e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`,formatExpectedTime(e){const t=new Date(e);let a=0;for(;a<3;)t.setDate(t.getDate()+1),0!==t.getDay()&&6!==t.getDay()&&a++;return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}},onLoad(e){e.type&&("school"===e.type?this.certificationType="学校认证":"realName"===e.type?this.certificationType="实名认证":this.certificationType="职业认证"),this.loadCertRecords()}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"certification-feedback-page"},[e.createElementVNode("view",{class:"main-content"},[i.certRecords.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"success-icon-container"},[e.createElementVNode("view",{class:"success-icon"},[e.createElementVNode("view",{class:"checkmark"})])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"success-message"},[i.certRecords.length>0?(e.openBlock(),e.createElementBlock("text",{key:0,class:"message-text"}," 以下是您的认证记录 ")):i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:1,class:"message-text"}," 暂无认证记录 "))]),i.certRecords.length>0?(e.openBlock(),e.createElementBlock("view",{key:1,class:"cert-records-section"},[e.createElementVNode("view",{class:"records-header"},[e.createElementVNode("view",{class:"records-icon"},[e.createElementVNode("view",{class:"list-icon"})]),e.createElementVNode("text",{class:"records-title"},"我的认证记录")]),e.createElementVNode("view",{class:"records-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.certRecords,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.recordId,class:"record-item"},[e.createElementVNode("view",{class:"record-header"},[e.createElementVNode("text",{class:"record-type"},e.toDisplayString(n.getCertTypeText(t.certType)),1),e.createElementVNode("view",{class:"status-badge",style:e.normalizeStyle({backgroundColor:n.getStatusColor(t.status)})},[e.createElementVNode("text",{class:"status-text"},e.toDisplayString(n.getStatusText(t.status)),1)],4)]),e.createElementVNode("view",{class:"record-info"},[e.createElementVNode("text",{class:"record-desc"},e.toDisplayString(t.certInfo||"暂无详细信息"),1)]),e.createElementVNode("view",{class:"record-time"},[e.createElementVNode("text",{class:"time-text"},"提交时间："+e.toDisplayString(n.formatDateTime(t.createdAt)),1)])])))),128))])])):e.createCommentVNode("",!0),i.loading||0!==i.certRecords.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"no-records-section"},[e.createElementVNode("view",{class:"no-records-icon"},[e.createElementVNode("view",{class:"empty-icon"})]),e.createElementVNode("text",{class:"no-records-text"},"暂无认证记录")])),i.loading?(e.openBlock(),e.createElementBlock("view",{key:3,class:"loading-section"},[e.createElementVNode("view",{class:"loading-spinner"}),e.createElementVNode("text",{class:"loading-text"},"正在加载认证记录...")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"tips-section"},[e.createElementVNode("view",{class:"tips-header"},[e.createElementVNode("view",{class:"tips-icon"},[e.createElementVNode("view",{class:"lightbulb"})]),e.createElementVNode("text",{class:"tips-title"},"温馨提示")]),e.createElementVNode("view",{class:"tips-content"},[e.createElementVNode("text",{class:"tip-item"},"• 认证期间请保持手机畅通，我们会及时通知您审核结果"),e.createElementVNode("text",{class:"tip-item"},"• 如有疑问，请联系客服获取帮助"),e.createElementVNode("text",{class:"tip-item"},"• 认证通过后，您的账号将获得相应标识")])])]),e.createElementVNode("view",{class:"return-button-section"},[e.createElementVNode("view",{class:"return-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("text",{class:"return-text"},"点击返回")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const de=a({data:()=>({userId:1000100,balance:1e7,loading:!1,errorMessage:"",hasError:!1}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId),o("log","at pages/wallet/wallet.vue:93","钱包页面接收到用户ID:",this.userId)),this.loadWalletData()},methods:{async loadWalletData(){try{o("log","at pages/wallet/wallet.vue:102","=== 开始加载钱包数据 ==="),o("log","at pages/wallet/wallet.vue:103","用户ID:",this.userId),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/wallet/balance?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/wallet/wallet.vue:116","=== 钱包余额API响应 ==="),o("log","at pages/wallet/wallet.vue:117","状态码:",e.statusCode),o("log","at pages/wallet/wallet.vue:118","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;this.balance=t.currentBalance,o("log","at pages/wallet/wallet.vue:123","成功加载钱包余额:",this.balance),uni.showToast({title:"钱包数据加载成功",icon:"success",duration:1500})}else o("error","at pages/wallet/wallet.vue:131","加载钱包余额失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载钱包数据失败",uni.showToast({title:"加载钱包数据失败",icon:"error"})}catch(e){o("error","at pages/wallet/wallet.vue:140","加载钱包数据异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}},goBack(){uni.navigateBack()},goToRecharge(){uni.navigateTo({url:`/pages/wallet/recharge?userId=${this.userId}`})},goToBill(){uni.navigateTo({url:`/pages/wallet/purchase-record?userId=${this.userId}`})},goToCustomerService(){uni.navigateTo({url:"/pages/chat/chat?friendName=客服"})},goToServiceTerms(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},formatBalance:e=>e>=1e4?(e/1e4).toFixed(1)+"wC":e>=1e3?(e/1e3).toFixed(1)+"kC":e+"C"}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"wallet-options"},[e.createElementVNode("view",{class:"option-item"},[e.createElementVNode("view",{class:"option-left"},[e.createElementVNode("view",{class:"option-icon balance-icon"},"$"),e.createElementVNode("text",{class:"option-text"},"余额")]),e.createElementVNode("text",{class:"balance-amount"},e.toDisplayString(n.formatBalance(i.balance)),1)]),e.createElementVNode("view",{class:"option-item",onClick:a[0]||(a[0]=(...e)=>n.goToRecharge&&n.goToRecharge(...e))},[e.createElementVNode("view",{class:"option-left"},[e.createElementVNode("view",{class:"option-icon recharge-icon"},"💳"),e.createElementVNode("text",{class:"option-text"},"充值")]),e.createElementVNode("text",{class:"arrow"},"›")]),e.createElementVNode("view",{class:"option-item",onClick:a[1]||(a[1]=(...e)=>n.goToBill&&n.goToBill(...e))},[e.createElementVNode("view",{class:"option-left"},[e.createElementVNode("view",{class:"option-icon bill-icon"},"📄"),e.createElementVNode("text",{class:"option-text"},"账单")]),e.createElementVNode("text",{class:"arrow"},"›")]),e.createElementVNode("view",{class:"option-item",onClick:a[2]||(a[2]=(...e)=>n.goToCustomerService&&n.goToCustomerService(...e))},[e.createElementVNode("view",{class:"option-left"},[e.createElementVNode("view",{class:"option-icon service-icon"},"🎧"),e.createElementVNode("text",{class:"option-text"},"客服与支持")]),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"bottom-section"},[e.createElementVNode("text",{class:"service-terms",onClick:a[3]||(a[3]=(...e)=>n.goToServiceTerms&&n.goToServiceTerms(...e))},"服务条款")])])}]]);const me=a({data:()=>({userId:1000100,rechargeAmount:"10086",ccoinAmount:"1008600",balance:1e7,loading:!1,errorMessage:"",hasError:!1,rechargeRecords:[],paymentMethods:[{id:"wechat",name:"微信支付",icon:"💚"},{id:"alipay",name:"支付宝",icon:"💙"},{id:"unionpay",name:"银联支付",icon:"💛"}]}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId),o("log","at pages/wallet/recharge.vue:137","充值页面接收到用户ID:",this.userId)),this.loadWalletData(),this.loadRechargeRecords()},methods:{async loadWalletData(){try{o("log","at pages/wallet/recharge.vue:147","=== 开始加载钱包数据 ==="),o("log","at pages/wallet/recharge.vue:148","用户ID:",this.userId);const e=await uni.request({url:`http://localhost:8888/api/wallet/balance?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});if(o("log","at pages/wallet/recharge.vue:158","=== 钱包余额API响应 ==="),o("log","at pages/wallet/recharge.vue:159","状态码:",e.statusCode),o("log","at pages/wallet/recharge.vue:160","响应数据:",e.data),200===e.statusCode&&e.data.success){const t=e.data.data;this.balance=t.currentBalance,o("log","at pages/wallet/recharge.vue:165","成功加载钱包余额:",this.balance)}else o("error","at pages/wallet/recharge.vue:167","加载钱包余额失败:",e.data.message)}catch(e){o("error","at pages/wallet/recharge.vue:170","加载钱包数据异常:",e)}},async loadRechargeRecords(){try{o("log","at pages/wallet/recharge.vue:177","=== 开始加载充值记录 ==="),o("log","at pages/wallet/recharge.vue:178","用户ID:",this.userId);const e=await uni.request({url:`http://localhost:8888/api/wallet/recharge-records?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/wallet/recharge.vue:188","=== 充值记录API响应 ==="),o("log","at pages/wallet/recharge.vue:189","状态码:",e.statusCode),o("log","at pages/wallet/recharge.vue:190","响应数据:",e.data),200===e.statusCode&&e.data.success?(this.rechargeRecords=e.data.data,o("log","at pages/wallet/recharge.vue:194","成功加载充值记录，共",this.rechargeRecords.length,"条")):o("error","at pages/wallet/recharge.vue:196","加载充值记录失败:",e.data.message)}catch(e){o("error","at pages/wallet/recharge.vue:199","加载充值记录异常:",e)}},goBack(){uni.navigateBack()},calculateCCoins(){this.rechargeAmount&&!isNaN(this.rechargeAmount)?this.ccoinAmount=(100*parseInt(this.rechargeAmount)).toString():this.ccoinAmount="0"},doRecharge(){!this.rechargeAmount||isNaN(this.rechargeAmount)||parseInt(this.rechargeAmount)<=0?uni.showToast({title:"请输入有效的充值金额",icon:"none"}):this.showPaymentMethodDialog()},showPaymentMethodDialog(){uni.showActionSheet({itemList:this.paymentMethods.map((e=>`${e.icon} ${e.name}`)),success:e=>{const t=this.paymentMethods[e.tapIndex];this.processPayment(t)},fail:()=>{o("log","at pages/wallet/recharge.vue:237","用户取消选择支付方式")}})},async processPayment(e){try{uni.showLoading({title:"正在跳转支付..."}),await new Promise((e=>setTimeout(e,1500))),uni.hideLoading(),this.handlePaymentSuccess(e)}catch(t){uni.hideLoading(),uni.showToast({title:"支付跳转失败",icon:"none"})}},async handlePaymentSuccess(e){try{uni.showModal({title:"充值成功",content:`已成功充值${this.rechargeAmount}元，获得${this.ccoinAmount}C`,showCancel:!1,confirmText:"确定",success:async()=>{await this.submitRechargeInfo(e),this.updateRechargeRecord(),this.rechargeAmount="",this.ccoinAmount="0"}})}catch(t){o("error","at pages/wallet/recharge.vue:291","处理支付成功失败:",t)}},async submitRechargeInfo(e){try{o("log","at pages/wallet/recharge.vue:298","=== 开始提交充值信息到后端 ==="),o("log","at pages/wallet/recharge.vue:299","用户ID:",this.userId),o("log","at pages/wallet/recharge.vue:300","充值金额:",this.rechargeAmount),o("log","at pages/wallet/recharge.vue:301","支付方式:",e);const t=await uni.request({url:"http://localhost:8888/api/wallet/recharge",method:"POST",data:{userId:this.userId,amount:parseFloat(this.rechargeAmount),paymentMethod:e.id},header:{"Content-Type":"application/json"}});if(o("log","at pages/wallet/recharge.vue:316","=== 充值API响应 ==="),o("log","at pages/wallet/recharge.vue:317","状态码:",t.statusCode),o("log","at pages/wallet/recharge.vue:318","响应数据:",t.data),200!==t.statusCode||!t.data.success)throw new Error(t.data.message||"充值失败");o("log","at pages/wallet/recharge.vue:321","充值信息提交成功:",t.data),this.balance=t.data.newBalance,await this.loadRechargeRecords(),uni.showToast({title:"充值成功",icon:"success",duration:2e3})}catch(t){o("error","at pages/wallet/recharge.vue:339","提交充值信息失败:",t),uni.showToast({title:"充值信息提交失败: "+t.message,icon:"none"})}},updateRechargeRecord(){const e={id:this.rechargeRecords.length+1,amount:`+${this.ccoinAmount}C`,time:this.formatDateTime(new Date),orderNumber:this.generateOrderNumber()};this.rechargeRecords.unshift(e),o("log","at pages/wallet/recharge.vue:361","充值记录已更新:",e)},generateOrderNumber:()=>`ORDER${Date.now()}${Math.random().toString(36).substr(2,9)}`.toUpperCase(),formatDateTime:e=>`${e.getFullYear()}/${String(e.getMonth()+1).padStart(2,"0")}/${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`,goToServiceAgreement(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},goToMinorRefund(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},goToServiceTerms(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},formatBalance:e=>e>=1e4?(e/1e4).toFixed(1)+"wC":e>=1e3?(e/1e3).toFixed(1)+"kC":e+"C"},mounted(){this.calculateCCoins()}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"balance-section"},[e.createElementVNode("view",{class:"balance-item"},[e.createElementVNode("view",{class:"balance-left"},[e.createElementVNode("view",{class:"balance-icon"},"$"),e.createElementVNode("text",{class:"balance-text"},"余额")]),e.createElementVNode("text",{class:"balance-amount"},e.toDisplayString(n.formatBalance(i.balance)),1)])]),e.createElementVNode("view",{class:"recharge-section"},[e.createElementVNode("view",{class:"recharge-item"},[e.createElementVNode("view",{class:"recharge-left"},[e.createElementVNode("view",{class:"recharge-icon"},"💳"),e.createElementVNode("text",{class:"recharge-text"},"充值")])])]),e.createElementVNode("view",{class:"input-section"},[e.createElementVNode("view",{class:"exchange-rate"},"100C=1元"),e.createElementVNode("view",{class:"custom-amount"},[e.createElementVNode("text",{class:"custom-label"},"自定义充值金额:"),e.createElementVNode("view",{class:"amount-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"amount-input","onUpdate:modelValue":a[0]||(a[0]=e=>i.rechargeAmount=e),type:"number",placeholder:"10086",onInput:a[1]||(a[1]=(...e)=>n.calculateCCoins&&n.calculateCCoins(...e))},null,544),[[e.vModelText,i.rechargeAmount]])]),e.createElementVNode("view",{class:"ccoin-equivalent"},"= "+e.toDisplayString(i.ccoinAmount)+"C",1)]),e.createElementVNode("view",{class:"recharge-button",onClick:a[2]||(a[2]=(...e)=>n.doRecharge&&n.doRecharge(...e))},[e.createElementVNode("text",{class:"recharge-button-text"},"立即充值"+e.toDisplayString(i.rechargeAmount)+"元",1)]),e.createElementVNode("view",{class:"agreement-text"},[e.createTextVNode(" ●充值则表示您同意 "),e.createElementVNode("text",{class:"agreement-link",onClick:a[3]||(a[3]=(...e)=>n.goToServiceAgreement&&n.goToServiceAgreement(...e))},"《AFriends充值服务协议》"),e.createElementVNode("text",{class:"agreement-link",onClick:a[4]||(a[4]=(...e)=>n.goToMinorRefund&&n.goToMinorRefund(...e))},"《未成年人退款申请》")])]),e.createElementVNode("view",{class:"record-section"},[e.createElementVNode("view",{class:"record-header"},[e.createElementVNode("view",{class:"record-left"},[e.createElementVNode("view",{class:"record-icon"},"📄"),e.createElementVNode("text",{class:"record-text"},"充值记录")])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.rechargeRecords,(t=>(e.openBlock(),e.createElementBlock("view",{class:"record-item",key:t.id},[e.createElementVNode("view",{class:"record-amount"},e.toDisplayString(t.amountFormatted),1),e.createElementVNode("view",{class:"record-time"},e.toDisplayString(t.timeAgo),1),e.createElementVNode("view",{class:"order-number"},"订单号: "+e.toDisplayString(t.orderNumber),1)])))),128))]),e.createElementVNode("view",{class:"bottom-section"},[e.createElementVNode("text",{class:"service-terms",onClick:a[5]||(a[5]=(...e)=>n.goToServiceTerms&&n.goToServiceTerms(...e))},"服务条款")])])}]]);const ge=a({data:()=>({userId:1000100,purchaseRecords:[],loading:!1,errorMessage:"",hasError:!1}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId),o("log","at pages/wallet/purchase-record.vue:92","购买记录页面接收到用户ID:",this.userId)),this.loadPurchaseRecords()},methods:{async loadPurchaseRecords(){try{o("log","at pages/wallet/purchase-record.vue:101","=== 开始加载购买记录数据 ==="),o("log","at pages/wallet/purchase-record.vue:102","用户ID:",this.userId),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:`http://localhost:8888/api/wallet/purchase-records?userId=${this.userId}`,method:"GET",header:{"Content-Type":"application/json"}});o("log","at pages/wallet/purchase-record.vue:115","=== 购买记录API响应 ==="),o("log","at pages/wallet/purchase-record.vue:116","状态码:",e.statusCode),o("log","at pages/wallet/purchase-record.vue:117","响应数据:",e.data),200===e.statusCode&&e.data.success?(this.purchaseRecords=e.data.data,o("log","at pages/wallet/purchase-record.vue:121","成功加载购买记录，共",this.purchaseRecords.length,"条"),0===this.purchaseRecords.length?(this.hasError=!0,this.errorMessage="暂无购买记录",o("log","at pages/wallet/purchase-record.vue:126","没有获取到任何购买记录")):uni.showToast({title:`加载了${this.purchaseRecords.length}条购买记录`,icon:"success",duration:2e3})):(o("error","at pages/wallet/purchase-record.vue:135","加载购买记录失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"加载购买记录失败",uni.showToast({title:"加载购买记录失败",icon:"error"}))}catch(e){o("error","at pages/wallet/purchase-record.vue:144","加载购买记录异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[i.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-container"},[e.createElementVNode("text",{class:"loading-text"},"正在加载购买记录...")])):e.createCommentVNode("",!0),i.hasError&&!i.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"error-container"},[e.createElementVNode("view",{class:"error-icon"},"⚠️"),e.createElementVNode("text",{class:"error-text"},e.toDisplayString(i.errorMessage),1),e.createElementVNode("view",{class:"error-actions"},[e.createElementVNode("button",{class:"retry-button",onClick:a[0]||(a[0]=(...e)=>n.loadPurchaseRecords&&n.loadPurchaseRecords(...e))},"重新加载")])])):e.createCommentVNode("",!0),i.hasError||i.loading?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"transaction-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.purchaseRecords,(t=>(e.openBlock(),e.createElementBlock("view",{class:"transaction-item",key:t.id},[e.createElementVNode("view",{class:"left-section"},[e.createElementVNode("view",{class:"avatar"},[e.createElementVNode("view",{class:"cartoon-creature"},[e.createElementVNode("view",{class:"eyes"},[e.createElementVNode("view",{class:"eye eye-left"}),e.createElementVNode("view",{class:"eye eye-right"})]),e.createElementVNode("view",{class:"mouth"})])]),e.createElementVNode("view",{class:"transaction-info"},[e.createElementVNode("text",{class:"item-name"},e.toDisplayString(t.itemName),1),e.createElementVNode("text",{class:"transaction-time"},e.toDisplayString(t.timeAgo),1)])]),e.createElementVNode("view",{class:"right-section"},[e.createElementVNode("text",{class:"amount"},e.toDisplayString(t.amountFormatted),1),e.createElementVNode("text",{class:"balance"},e.toDisplayString(t.balanceFormatted),1)])])))),128))])),e.createElementVNode("view",{class:"home-indicator"})])}]]);const ue=a({data:()=>({reportReasons:["色情低俗","政治敏感","诈骗信息","种族歧视","攻击谩骂","网络暴力","站外引流","违法违规","涉未成年人","其他违规"],selectedReason:-1,userId:1000100,reportedUserId:null,contentId:null,contentType:null}),onLoad(e){e.userId&&(this.userId=parseInt(e.userId)),e.reportedUserId&&(this.reportedUserId=parseInt(e.reportedUserId)),e.contentId&&(this.contentId=parseInt(e.contentId)),e.contentType&&(this.contentType=e.contentType)},methods:{selectReason(e){this.selectedReason=e},goToNext(){if(-1===this.selectedReason)return void uni.showToast({title:"请选择举报原因",icon:"none"});const e={reason:encodeURIComponent(this.reportReasons[this.selectedReason]),userId:this.userId};this.reportedUserId&&(e.reportedUserId=this.reportedUserId),this.contentId&&(e.contentId=this.contentId),this.contentType&&(e.contentType=this.contentType);const t=Object.keys(e).map((t=>`${t}=${e[t]}`)).join("&");o("log","at pages/report/report.vue:130","跳转到举报证据页面，参数:",e),uni.navigateTo({url:`/pages/report/report-evidence?${t}`})},goBack(){uni.navigateBack()}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"instruction-banner"},[e.createElementVNode("text",{class:"instruction-text"},"请选择最符合的举报原因,帮助我们准确处理")]),e.createElementVNode("view",{class:"report-reasons"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.reportReasons,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["reason-item",{selected:i.selectedReason===a}]),key:a,onClick:e=>n.selectReason(a)},[e.createElementVNode("text",{class:"reason-text"},e.toDisplayString(t),1),i.selectedReason===a?(e.openBlock(),e.createElementBlock("view",{key:0,class:"check-icon"},"✓")):e.createCommentVNode("",!0)],10,["onClick"])))),128))]),e.createElementVNode("view",{class:"next-button",onClick:a[0]||(a[0]=(...e)=>n.goToNext&&n.goToNext(...e))},[e.createElementVNode("text",{class:"next-text"},"下一步")])])}]]);const he=a({data:()=>({selectedReason:"色情低俗",descriptionText:"",charCount:0,uploadedImages:[],userId:1000100,reportedUserId:null,contentId:null,contentType:null,categoryId:1,loading:!1,hasError:!1,errorMessage:""}),onLoad(e){e.reason&&(this.selectedReason=e.reason),e.userId&&(this.userId=parseInt(e.userId)),e.reportedUserId&&(this.reportedUserId=parseInt(e.reportedUserId)),e.contentId&&(this.contentId=parseInt(e.contentId)),e.contentType&&(this.contentType=e.contentType),this.categoryId=this.getCategoryIdByReason(this.selectedReason)},methods:{goBack(){uni.navigateBack()},updateCharCount(e){this.charCount=e.detail.value.length},uploadImage(){uni.chooseImage({count:9-this.uploadedImages.length,success:e=>{this.uploadedImages=this.uploadedImages.concat(e.tempFilePaths)}})},deleteImage(e){this.uploadedImages.splice(e,1)},async submitReport(){if(this.descriptionText.trim())try{o("log","at pages/report/report-evidence.vue:161","=== 开始提交举报 ==="),o("log","at pages/report/report-evidence.vue:162","用户ID:",this.userId),o("log","at pages/report/report-evidence.vue:163","被举报用户ID:",this.reportedUserId),o("log","at pages/report/report-evidence.vue:164","内容ID:",this.contentId),o("log","at pages/report/report-evidence.vue:165","内容类型:",this.contentType),o("log","at pages/report/report-evidence.vue:166","举报类别ID:",this.categoryId),o("log","at pages/report/report-evidence.vue:167","举报描述:",this.descriptionText),o("log","at pages/report/report-evidence.vue:168","证据图片:",this.uploadedImages),this.loading=!0,this.hasError=!1,this.errorMessage="";const e=await uni.request({url:"http://localhost:8888/api/report/submit",method:"POST",data:{userId:this.userId,reportedUserId:this.reportedUserId,contentId:this.contentId,contentType:this.contentType,categoryId:this.categoryId,description:this.descriptionText,evidenceImg:JSON.stringify(this.uploadedImages)},header:{"Content-Type":"application/json"}});o("log","at pages/report/report-evidence.vue:191","=== 举报API响应详情 ==="),o("log","at pages/report/report-evidence.vue:192","状态码:",e.statusCode),o("log","at pages/report/report-evidence.vue:193","响应数据:",e.data),200===e.statusCode&&e.data.success?(o("log","at pages/report/report-evidence.vue:196","举报提交成功"),uni.showToast({title:"举报提交成功",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:`/pages/report/report-feedback?type=${encodeURIComponent(this.selectedReason)}&reportId=${e.data.reportId}`})}),1500)):(o("error","at pages/report/report-evidence.vue:210","举报提交失败:",e.data.message),this.hasError=!0,this.errorMessage=e.data.message||"举报提交失败",uni.showToast({title:e.data.message||"举报提交失败",icon:"error"}))}catch(e){o("error","at pages/report/report-evidence.vue:219","举报提交异常:",e),this.hasError=!0,this.errorMessage="网络连接失败，请检查网络设置",uni.showToast({title:"网络错误",icon:"error"})}finally{this.loading=!1}else uni.showToast({title:"请填写举报描述",icon:"none"})},getCategoryIdByReason:e=>({"色情低俗":1,"政治敏感":2,"诈骗信息":3,"种族歧视":4,"攻击谩骂":5,"网络暴力":6,"站外引流":7,"违法违规":8,"涉未成年人":9,"其他违规":10}[e]||10)}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"instruction-banner"},[e.createElementVNode("text",{class:"instruction-text"},"请详细填写举报描述及图片证据")]),e.createElementVNode("view",{class:"content-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-label"},"举报理由"),e.createElementVNode("text",{class:"selected-reason"},e.toDisplayString(i.selectedReason),1)])]),e.createElementVNode("view",{class:"content-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-label"},"举报描述")]),e.createElementVNode("view",{class:"description-container"},[e.withDirectives(e.createElementVNode("textarea",{class:"description-input","onUpdate:modelValue":a[0]||(a[0]=e=>i.descriptionText=e),maxlength:400,placeholder:"请详细填写,以提高举报通过率",onInput:a[1]||(a[1]=(...e)=>n.updateCharCount&&n.updateCharCount(...e))},null,544),[[e.vModelText,i.descriptionText]]),e.createElementVNode("view",{class:"char-count"},e.toDisplayString(i.charCount)+"/400",1)])]),e.createElementVNode("view",{class:"content-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"section-label"},"图片证据"),e.createElementVNode("text",{class:"upload-limit"},"最多上传9张")]),e.createElementVNode("view",{class:"image-upload-container"},[e.createElementVNode("view",{class:"upload-button",onClick:a[2]||(a[2]=(...e)=>n.uploadImage&&n.uploadImage(...e))},[e.createElementVNode("text",{class:"plus-icon"},"+")]),i.uploadedImages.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uploaded-images"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.uploadedImages,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"image-item",key:a},[e.createElementVNode("image",{src:t,class:"uploaded-image"},null,8,["src"]),e.createElementVNode("view",{class:"delete-button",onClick:e=>n.deleteImage(a)},"×",8,["onClick"])])))),128))])):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"submit-info"},[e.createElementVNode("text",{class:"info-text"},"提交后信息将发送给平台审核,结果将在三个工作日内发送至系统消息")]),e.createElementVNode("view",{class:"submit-button",onClick:a[3]||(a[3]=(...e)=>n.submitReport&&n.submitReport(...e))},[e.createElementVNode("text",{class:"submit-text"},"提交")])])}]]);const pe=a({name:"ReportFeedbackPage",data(){return{reportType:"色情低俗",reportId:null,submitTime:this.formatDateTime(new Date),expectedTime:this.formatExpectedTime(new Date)}},methods:{goBack(){uni.navigateBack({delta:2})},formatDateTime:e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`,formatExpectedTime(e){const t=new Date(e);let a=0;for(;a<3;)t.setDate(t.getDate()+1),0!==t.getDay()&&6!==t.getDay()&&a++;return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}},onLoad(e){e.type&&(this.reportType=decodeURIComponent(e.type)),e.reportId&&(this.reportId=parseInt(e.reportId))}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"report-feedback-page"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"success-icon-container"},[e.createElementVNode("view",{class:"success-icon"},[e.createElementVNode("view",{class:"checkmark"})])]),e.createElementVNode("view",{class:"success-message"},[e.createElementVNode("text",{class:"message-text"},"举报已提交成功，我们将在3个工作日内处理")]),e.createElementVNode("view",{class:"report-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("view",{class:"card-icon"},[e.createElementVNode("view",{class:"report-icon"})]),e.createElementVNode("text",{class:"card-title"},"举报信息")]),e.createElementVNode("view",{class:"card-content"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"举报类型"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(i.reportType),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"提交时间"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(i.submitTime),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"处理状态"),e.createElementVNode("text",{class:"info-value status-pending"},"待审核")]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"预计完成"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(i.expectedTime),1)])])]),e.createElementVNode("view",{class:"tips-section"},[e.createElementVNode("view",{class:"tips-header"},[e.createElementVNode("view",{class:"tips-icon"},[e.createElementVNode("view",{class:"lightbulb"})]),e.createElementVNode("text",{class:"tips-title"},"温馨提示")]),e.createElementVNode("view",{class:"tips-content"},[e.createElementVNode("text",{class:"tip-item"},"• 举报处理结果将通过系统消息通知您"),e.createElementVNode("text",{class:"tip-item"},"• 如发现紧急违规内容，请及时联系客服"),e.createElementVNode("text",{class:"tip-item"},"• 感谢您为维护平台环境做出的贡献")])])]),e.createElementVNode("view",{class:"return-button-section"},[e.createElementVNode("view",{class:"return-button",onClick:a[0]||(a[0]=(...e)=>n.goBack&&n.goBack(...e))},[e.createElementVNode("text",{class:"return-text"},"点击返回")])]),e.createElementVNode("view",{class:"home-indicator"})])}]]);const ve=a({data:()=>({phone:""}),methods:{handleLogin(){this.phone?/^1[3-9]\d{9}$/.test(this.phone)?(uni.showToast({title:"验证码已发送",icon:"success",duration:1500}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/verification-code-login"})}),1500)):uni.showToast({title:"请输入正确的手机号",icon:"none"}):uni.showToast({title:"请输入手机号",icon:"none"})},goToPasswordLogin(){uni.navigateTo({url:"/pages/login/login-replica"})},goToRegister(){uni.navigateTo({url:"/pages/login/phone-register"})},goToWechatBind(){uni.navigateTo({url:"/pages/login/login-unbound"})},goToMainPage(){uni.navigateTo({url:"/pages/index/index"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},goToWechatLogin(){uni.showToast({title:"即将跳转至微信",icon:"none",duration:2e3})},goToQQLogin(){uni.showToast({title:"即将跳转至QQ",icon:"none",duration:2e3})},goToDouyinLogin(){uni.showToast({title:"即将跳转至抖音",icon:"none",duration:2e3})}}},[["render",function(a,s,o,i,n,l){return e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"app-header"},[e.createElementVNode("image",{class:"app-logo",src:t,mode:"aspectFit"})]),e.createElementVNode("view",{class:"greeting-section"},[e.createElementVNode("text",{class:"greeting-text"},"你好呀"),e.createElementVNode("text",{class:"welcome-text"},"欢迎来到Afriends, 请登录并开始你的交友之旅")]),e.createElementVNode("view",{class:"login-form"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"手机号"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.phone=e),maxlength:"11"},null,512),[[e.vModelText,n.phone]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"login-options"},[e.createElementVNode("text",{class:"option-text",onClick:s[1]||(s[1]=(...e)=>l.goToPasswordLogin&&l.goToPasswordLogin(...e))},"使用账号密码登录")]),e.createElementVNode("view",{class:"third-party-login"},[e.createElementVNode("text",{class:"section-title"},"或者你可以通过这些来登录"),e.createElementVNode("view",{class:"social-icons"},[e.createElementVNode("view",{class:"social-icon",onClick:s[2]||(s[2]=(...e)=>l.goToWechatLogin&&l.goToWechatLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[3]||(s[3]=(...e)=>l.goToQQLogin&&l.goToQQLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:D,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[4]||(s[4]=(...e)=>l.goToDouyinLogin&&l.goToDouyinLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:B,mode:"aspectFit"})])])]),e.createElementVNode("view",{class:"terms-section"},[e.createElementVNode("text",{class:"terms-link",onClick:s[5]||(s[5]=(...e)=>l.goToTermsOfService&&l.goToTermsOfService(...e))},"服务条款")]),e.createElementVNode("button",{class:"login-btn",onClick:s[6]||(s[6]=(...e)=>l.handleLogin&&l.handleLogin(...e))},[e.createElementVNode("text",{class:"btn-text"},"获取验证码")]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-text"},"没有账号?"),e.createElementVNode("text",{class:"register-link",onClick:s[7]||(s[7]=(...e)=>l.goToRegister&&l.goToRegister(...e))},"注册账号")])])])])}],["__scopeId","data-v-7aef9f4a"]]);const we=a({data:()=>({username:"",password:"",userId:null}),methods:{handleLogin(){this.username&&this.password?(this.userId=1000001,uni.setStorageSync("userId",this.userId),uni.setStorageSync("username",this.username),o("log","at pages/login/login-replica.vue:117","登录信息:",{username:this.username,password:this.password,userId:this.userId}),uni.showToast({title:"登录成功",icon:"success",duration:1500}),setTimeout((()=>{uni.redirectTo({url:"/pages/feed/content-feed"})}),1500)):uni.showToast({title:"请输入用户名和密码",icon:"none"})},goToRegister(){uni.navigateTo({url:"/pages/login/phone-register"})},goToPhoneLogin(){uni.navigateTo({url:"/pages/login/phone-login"})},goToWechatBind(){uni.navigateTo({url:"/pages/login/login-unbound"})},goToResetPassword(){uni.navigateTo({url:"/pages/login/reset-password"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},goToWechatLogin(){uni.showToast({title:"即将跳转至微信",icon:"none",duration:2e3})},goToQQLogin(){uni.showToast({title:"即将跳转至QQ",icon:"none",duration:2e3})},goToDouyinLogin(){uni.showToast({title:"即将跳转至抖音",icon:"none",duration:2e3})}}},[["render",function(a,s,o,i,n,l){return e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"app-header"},[e.createElementVNode("image",{class:"app-logo",src:t,mode:"aspectFit"})]),e.createElementVNode("view",{class:"greeting-section"},[e.createElementVNode("text",{class:"greeting-text"},"你好呀"),e.createElementVNode("text",{class:"welcome-text"},"欢迎来到Afriends, 请登录并开始你的交友之旅")]),e.createElementVNode("view",{class:"login-form"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"手机号/用户名"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e)},null,512),[[e.vModelText,n.username]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"密码"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"password","onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e)},null,512),[[e.vModelText,n.password]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"forgot-password"},[e.createElementVNode("text",{class:"option-text",onClick:s[2]||(s[2]=(...e)=>l.goToResetPassword&&l.goToResetPassword(...e))},"忘记密码?")]),e.createElementVNode("view",{class:"phone-login-option"},[e.createElementVNode("text",{class:"option-text",onClick:s[3]||(s[3]=(...e)=>l.goToPhoneLogin&&l.goToPhoneLogin(...e))},"使用手机验证码登录")]),e.createElementVNode("view",{class:"third-party-login"},[e.createElementVNode("text",{class:"section-title"},"或者你可以通过这些来登录"),e.createElementVNode("view",{class:"social-icons"},[e.createElementVNode("view",{class:"social-icon",onClick:s[4]||(s[4]=(...e)=>l.goToWechatLogin&&l.goToWechatLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[5]||(s[5]=(...e)=>l.goToQQLogin&&l.goToQQLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:D,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[6]||(s[6]=(...e)=>l.goToDouyinLogin&&l.goToDouyinLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:B,mode:"aspectFit"})])])]),e.createElementVNode("view",{class:"terms-section"},[e.createElementVNode("text",{class:"terms-link",onClick:s[7]||(s[7]=(...e)=>l.goToTermsOfService&&l.goToTermsOfService(...e))},"服务条款")]),e.createElementVNode("button",{class:"login-btn",onClick:s[8]||(s[8]=(...e)=>l.handleLogin&&l.handleLogin(...e))},[e.createElementVNode("text",{class:"btn-text"},"登录")]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-text"},"没有账号?"),e.createElementVNode("text",{class:"register-link",onClick:s[9]||(s[9]=(...e)=>l.goToRegister&&l.goToRegister(...e))},"注册账号")])])])])}],["__scopeId","data-v-8b93ce52"]]);const Ee=a({data:()=>({username:"",password:""}),methods:{handleBind(){this.username&&this.password?(o("log","at pages/login/login-unbound.vue:110","绑定信息:",{username:this.username,password:this.password}),uni.showToast({title:"绑定成功",icon:"success"})):uni.showToast({title:"请输入用户名和密码",icon:"none"})},goToRegister(){uni.navigateTo({url:"/pages/login/phone-register"})},goToPhoneLogin(){uni.navigateTo({url:"/pages/login/phone-login"})},handleWechatBind(){o("log","at pages/login/login-unbound.vue:135","触发微信绑定"),uni.showToast({title:"微信绑定功能开发中",icon:"none"})},goToWechatBind(){o("log","at pages/login/login-unbound.vue:144","已在微信绑定页面")},goToResetPassword(){uni.navigateTo({url:"/pages/login/reset-password"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},goToWechatLogin(){uni.showToast({title:"即将跳转至微信",icon:"none",duration:2e3})},goToQQLogin(){uni.showToast({title:"即将跳转至QQ",icon:"none",duration:2e3})},goToDouyinLogin(){uni.showToast({title:"即将跳转至抖音",icon:"none",duration:2e3})}}},[["render",function(a,s,o,i,n,l){return e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"app-header"},[e.createElementVNode("image",{class:"app-logo",src:t,mode:"aspectFit"})]),e.createElementVNode("view",{class:"greeting-section"},[e.createElementVNode("text",{class:"greeting-text"},"需要绑定"),e.createElementVNode("text",{class:"welcome-text"},"您的社交账号似乎并没有绑定我们的账号"),e.createElementVNode("text",{class:"welcome-text"},"请先用其他方式登录")]),e.createElementVNode("view",{class:"login-form"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"手机号/用户名"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e)},null,512),[[e.vModelText,n.username]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"密码"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"password","onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e)},null,512),[[e.vModelText,n.password]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"forgot-password"},[e.createElementVNode("text",{class:"option-text",onClick:s[2]||(s[2]=(...e)=>l.goToResetPassword&&l.goToResetPassword(...e))},"忘记密码?")]),e.createElementVNode("view",{class:"phone-login-option"},[e.createElementVNode("text",{class:"option-text",onClick:s[3]||(s[3]=(...e)=>l.goToPhoneLogin&&l.goToPhoneLogin(...e))},"使用手机验证码登录")]),e.createElementVNode("view",{class:"third-party-login"},[e.createElementVNode("text",{class:"section-title"},"或者你可以通过这些来绑定"),e.createElementVNode("view",{class:"social-icons"},[e.createElementVNode("view",{class:"social-icon",onClick:s[4]||(s[4]=(...e)=>l.goToWechatLogin&&l.goToWechatLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[5]||(s[5]=(...e)=>l.goToQQLogin&&l.goToQQLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:D,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[6]||(s[6]=(...e)=>l.goToDouyinLogin&&l.goToDouyinLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:B,mode:"aspectFit"})])])]),e.createElementVNode("view",{class:"terms-section"},[e.createElementVNode("text",{class:"terms-link",onClick:s[7]||(s[7]=(...e)=>l.goToTermsOfService&&l.goToTermsOfService(...e))},"服务条款")]),e.createElementVNode("button",{class:"login-btn",onClick:s[8]||(s[8]=(...e)=>l.handleBind&&l.handleBind(...e))},[e.createElementVNode("text",{class:"btn-text"},"绑定")]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-text"},"没有账号?"),e.createElementVNode("text",{class:"register-link",onClick:s[9]||(s[9]=(...e)=>l.goToRegister&&l.goToRegister(...e))},"注册账号")])])])])}],["__scopeId","data-v-5f319e88"]]);const Ne=a({data:()=>({phone:""}),methods:{handleRegister(){this.phone?/^1[3-9]\d{9}$/.test(this.phone)?(o("log","at pages/login/phone-register.vue:101","发送验证码到手机号:",this.phone),uni.showToast({title:"验证码已发送",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/verification-code-register"})}),1500)):uni.showToast({title:"请输入正确的手机号",icon:"none"}):uni.showToast({title:"请输入手机号",icon:"none"})},goToPhoneLogin(){uni.navigateTo({url:"/pages/login/phone-login"})},goToWechatBind(){uni.navigateTo({url:"/pages/login/login-unbound"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})},goToWechatLogin(){uni.showToast({title:"即将跳转至微信",icon:"none",duration:2e3})},goToQQLogin(){uni.showToast({title:"即将跳转至QQ",icon:"none",duration:2e3})},goToDouyinLogin(){uni.showToast({title:"即将跳转至抖音",icon:"none",duration:2e3})}}},[["render",function(a,s,o,i,n,l){return e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"app-header"},[e.createElementVNode("image",{class:"app-logo",src:t,mode:"aspectFit"})]),e.createElementVNode("view",{class:"greeting-section"},[e.createElementVNode("text",{class:"greeting-text"},"你好呀"),e.createElementVNode("text",{class:"welcome-text"},"欢迎来到Afriends, 请注册并开始你的交友之旅")]),e.createElementVNode("view",{class:"login-form"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"手机号"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.phone=e),maxlength:"11"},null,512),[[e.vModelText,n.phone]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"login-options"},[e.createElementVNode("text",{class:"option-text",onClick:s[1]||(s[1]=(...e)=>l.goToPhoneLogin&&l.goToPhoneLogin(...e))},"使用手机验证码登录")]),e.createElementVNode("view",{class:"third-party-login"},[e.createElementVNode("text",{class:"section-title"},"或者你可以通过这些来登录"),e.createElementVNode("view",{class:"social-icons"},[e.createElementVNode("view",{class:"social-icon",onClick:s[2]||(s[2]=(...e)=>l.goToWechatLogin&&l.goToWechatLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:I,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[3]||(s[3]=(...e)=>l.goToQQLogin&&l.goToQQLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:D,mode:"aspectFit"})]),e.createElementVNode("view",{class:"social-icon",onClick:s[4]||(s[4]=(...e)=>l.goToDouyinLogin&&l.goToDouyinLogin(...e))},[e.createElementVNode("image",{class:"social-icon-img",src:B,mode:"aspectFit"})])])]),e.createElementVNode("view",{class:"terms-section"},[e.createElementVNode("text",{class:"terms-link",onClick:s[5]||(s[5]=(...e)=>l.goToTermsOfService&&l.goToTermsOfService(...e))},"服务条款")]),e.createElementVNode("button",{class:"login-btn",onClick:s[6]||(s[6]=(...e)=>l.handleRegister&&l.handleRegister(...e))},[e.createElementVNode("text",{class:"btn-text"},"注册")]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-text"},"已有账号?"),e.createElementVNode("text",{class:"register-link",onClick:s[7]||(s[7]=(...e)=>l.goToPhoneLogin&&l.goToPhoneLogin(...e))},"登录账号")])])])])}],["__scopeId","data-v-305b51c4"]]);const Ve=a({data:()=>({verificationCode:["","","",""],mainInputValue:"",activeIndex:0}),computed:{isCodeComplete(){return this.verificationCode.every((e=>""!==e))}},mounted(){this.$nextTick((()=>{setTimeout((()=>{this.focusMainInput()}),300)}))},methods:{handleMainInput(e){const t=e.detail.value.replace(/\D/g,"").slice(0,4);this.mainInputValue=t;for(let a=0;a<4;a++)this.verificationCode[a]=t[a]||"";t.length>0?this.activeIndex=Math.min(t.length-1,3):this.activeIndex=0},handleMainFocus(){this.mainInputValue.length>0?this.activeIndex=Math.min(this.mainInputValue.length-1,3):this.activeIndex=0},handleMainBlur(){this.activeIndex=-1},focusMainInput(){this.$nextTick((()=>{if(this.$refs.mainInput){const e=this.$refs.mainInput;e&&e.focus&&e.focus()}}))},resendCode(){o("log","at pages/login/verification-code-login.vue:126","重新发送验证码"),uni.showToast({title:"验证码已重新发送",icon:"success"})},handleLogin(){if(!this.isCodeComplete)return void uni.showToast({title:"请输入完整的验证码",icon:"none"});o("log","at pages/login/verification-code-login.vue:145","验证码:",this.verificationCode.join("")),uni.showToast({title:"登录成功",icon:"success",duration:1500}),setTimeout((()=>{uni.redirectTo({url:"/pages/feed/content-feed"})}),1500)},goBack(){uni.navigateBack()},changePhone(){uni.redirectTo({url:"/pages/login/phone-login"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"verification-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("text",{class:"title"},"请输入验证码"),e.createElementVNode("text",{class:"instruction"},"我们刚刚向您发送了一条验证码,请查看您的信箱"),e.createElementVNode("view",{class:"code-input-section"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.verificationCode,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:e.normalizeClass(["code-input-field",{active:i.activeIndex===s}]),onClick:a[0]||(a[0]=(...e)=>n.focusMainInput&&n.focusMainInput(...e))},[t?(e.openBlock(),e.createElementBlock("text",{key:0,class:"code-digit"},e.toDisplayString(t),1)):e.createCommentVNode("",!0)],2)))),128)),e.withDirectives(e.createElementVNode("input",{class:"main-input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>i.mainInputValue=e),maxlength:"4",placeholder:"",onInput:a[2]||(a[2]=(...e)=>n.handleMainInput&&n.handleMainInput(...e)),onFocus:a[3]||(a[3]=(...e)=>n.handleMainFocus&&n.handleMainFocus(...e)),onBlur:a[4]||(a[4]=(...e)=>n.handleMainBlur&&n.handleMainBlur(...e)),ref:"mainInput"},null,544),[[e.vModelText,i.mainInputValue]])]),e.createElementVNode("view",{class:"change-phone-section"},[e.createElementVNode("text",{class:"change-phone-link",onClick:a[5]||(a[5]=(...e)=>n.changePhone&&n.changePhone(...e))},"重新输入手机号")]),e.createElementVNode("view",{class:"resend-section"},[e.createElementVNode("text",{class:"resend-text"},"没有收到验证码?"),e.createElementVNode("text",{class:"resend-link",onClick:a[6]||(a[6]=(...e)=>n.resendCode&&n.resendCode(...e))},"重新发送")]),e.createElementVNode("button",{class:"login-btn",onClick:a[7]||(a[7]=(...e)=>n.handleLogin&&n.handleLogin(...e)),disabled:!n.isCodeComplete},[e.createElementVNode("text",{class:"btn-text"},"登录")],8,["disabled"])])])}],["__scopeId","data-v-3053bafc"]]);const ke=a({data:()=>({verificationCode:["","","",""],mainInputValue:"",activeIndex:0}),computed:{isCodeComplete(){return this.verificationCode.every((e=>""!==e))}},mounted(){this.$nextTick((()=>{setTimeout((()=>{this.focusMainInput()}),300)}))},methods:{handleMainInput(e){const t=e.detail.value.replace(/\D/g,"").slice(0,4);this.mainInputValue=t;for(let a=0;a<4;a++)this.verificationCode[a]=t[a]||"";t.length>0?this.activeIndex=Math.min(t.length-1,3):this.activeIndex=0},handleMainFocus(){this.mainInputValue.length>0?this.activeIndex=Math.min(this.mainInputValue.length-1,3):this.activeIndex=0},handleMainBlur(){this.activeIndex=-1},focusMainInput(){this.$nextTick((()=>{if(this.$refs.mainInput){const e=this.$refs.mainInput;e&&e.focus&&e.focus()}}))},resendCode(){o("log","at pages/login/verification-code-register.vue:126","重新发送验证码"),uni.showToast({title:"验证码已重新发送",icon:"success"})},handleRegister(){if(!this.isCodeComplete)return void uni.showToast({title:"请输入完整的验证码",icon:"none"});o("log","at pages/login/verification-code-register.vue:145","验证码:",this.verificationCode.join("")),uni.showToast({title:"注册成功",icon:"success",duration:1500}),setTimeout((()=>{uni.redirectTo({url:"/pages/login/login-replica"})}),1500)},goBack(){uni.navigateBack()},changePhone(){uni.redirectTo({url:"/pages/login/phone-register"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"verification-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("text",{class:"title"},"请输入验证码"),e.createElementVNode("text",{class:"instruction"},"我们刚刚向您发送了一条验证码,请查看您的信箱"),e.createElementVNode("view",{class:"code-input-section"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.verificationCode,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:e.normalizeClass(["code-input-field",{active:i.activeIndex===s}]),onClick:a[0]||(a[0]=(...e)=>n.focusMainInput&&n.focusMainInput(...e))},[t?(e.openBlock(),e.createElementBlock("text",{key:0,class:"code-digit"},e.toDisplayString(t),1)):e.createCommentVNode("",!0)],2)))),128)),e.withDirectives(e.createElementVNode("input",{class:"main-input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>i.mainInputValue=e),maxlength:"4",placeholder:"",onInput:a[2]||(a[2]=(...e)=>n.handleMainInput&&n.handleMainInput(...e)),onFocus:a[3]||(a[3]=(...e)=>n.handleMainFocus&&n.handleMainFocus(...e)),onBlur:a[4]||(a[4]=(...e)=>n.handleMainBlur&&n.handleMainBlur(...e)),ref:"mainInput"},null,544),[[e.vModelText,i.mainInputValue]])]),e.createElementVNode("view",{class:"change-phone-section"},[e.createElementVNode("text",{class:"change-phone-link",onClick:a[5]||(a[5]=(...e)=>n.changePhone&&n.changePhone(...e))},"重新输入手机号")]),e.createElementVNode("view",{class:"resend-section"},[e.createElementVNode("text",{class:"resend-text"},"没有收到验证码?"),e.createElementVNode("text",{class:"resend-link",onClick:a[6]||(a[6]=(...e)=>n.resendCode&&n.resendCode(...e))},"重新发送")]),e.createElementVNode("button",{class:"login-btn",onClick:a[7]||(a[7]=(...e)=>n.handleRegister&&n.handleRegister(...e)),disabled:!n.isCodeComplete},[e.createElementVNode("text",{class:"btn-text"},"注册")],8,["disabled"])])])}],["__scopeId","data-v-8b8bf955"]]);const fe=a({data:()=>({verificationCode:["","","",""],mainInputValue:"",activeIndex:0}),computed:{isCodeComplete(){return this.verificationCode.every((e=>""!==e))}},mounted(){this.$nextTick((()=>{setTimeout((()=>{this.focusMainInput()}),300)}))},methods:{handleMainInput(e){const t=e.detail.value.replace(/\D/g,"").slice(0,4);this.mainInputValue=t;for(let a=0;a<4;a++)this.verificationCode[a]=t[a]||"";t.length>0?this.activeIndex=Math.min(t.length-1,3):this.activeIndex=0},handleMainFocus(){this.mainInputValue.length>0?this.activeIndex=Math.min(this.mainInputValue.length-1,3):this.activeIndex=0},handleMainBlur(){this.activeIndex=-1},focusMainInput(){this.$nextTick((()=>{if(this.$refs.mainInput){const e=this.$refs.mainInput;e&&e.focus&&e.focus()}}))},resendCode(){o("log","at pages/login/verification-code-resetPassword.vue:126","重新发送验证码"),uni.showToast({title:"验证码已重新发送",icon:"success"})},handleNext(){if(!this.isCodeComplete)return void uni.showToast({title:"请输入完整的验证码",icon:"none"});o("log","at pages/login/verification-code-resetPassword.vue:145","验证码:",this.verificationCode.join("")),uni.showToast({title:"验证成功",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/rest-verify-password"})}),1e3)},goBack(){uni.navigateBack()},changePhone(){uni.redirectTo({url:"/pages/login/reset-password"})}}},[["render",function(t,a,s,o,i,n){return e.openBlock(),e.createElementBlock("view",{class:"verification-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("text",{class:"title"},"请输入验证码"),e.createElementVNode("text",{class:"instruction"},"我们刚刚向您发送了一条验证码,请查看您的信箱"),e.createElementVNode("view",{class:"code-input-section"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.verificationCode,((t,s)=>(e.openBlock(),e.createElementBlock("view",{key:s,class:e.normalizeClass(["code-input-field",{active:i.activeIndex===s}]),onClick:a[0]||(a[0]=(...e)=>n.focusMainInput&&n.focusMainInput(...e))},[t?(e.openBlock(),e.createElementBlock("text",{key:0,class:"code-digit"},e.toDisplayString(t),1)):e.createCommentVNode("",!0)],2)))),128)),e.withDirectives(e.createElementVNode("input",{class:"main-input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>i.mainInputValue=e),maxlength:"4",placeholder:"",onInput:a[2]||(a[2]=(...e)=>n.handleMainInput&&n.handleMainInput(...e)),onFocus:a[3]||(a[3]=(...e)=>n.handleMainFocus&&n.handleMainFocus(...e)),onBlur:a[4]||(a[4]=(...e)=>n.handleMainBlur&&n.handleMainBlur(...e)),ref:"mainInput"},null,544),[[e.vModelText,i.mainInputValue]])]),e.createElementVNode("view",{class:"change-phone-section"},[e.createElementVNode("text",{class:"change-phone-link",onClick:a[5]||(a[5]=(...e)=>n.changePhone&&n.changePhone(...e))},"重新输入手机号")]),e.createElementVNode("view",{class:"resend-section"},[e.createElementVNode("text",{class:"resend-text"},"没有收到验证码?"),e.createElementVNode("text",{class:"resend-link",onClick:a[6]||(a[6]=(...e)=>n.resendCode&&n.resendCode(...e))},"重新发送")]),e.createElementVNode("button",{class:"login-btn",onClick:a[7]||(a[7]=(...e)=>n.handleNext&&n.handleNext(...e)),disabled:!n.isCodeComplete},[e.createElementVNode("text",{class:"btn-text"},"下一步")],8,["disabled"])])])}],["__scopeId","data-v-f8562de3"]]);const xe=a({data:()=>({phone:""}),methods:{handleLogin(){this.phone?uni.navigateTo({url:"/pages/login/verification-code-resetPassword"}):uni.showToast({title:"请输入手机号",icon:"none"})},goToPasswordLogin(){uni.navigateTo({url:"/pages/login/login-replica"})},goToRegister(){uni.navigateTo({url:"/pages/login/phone-register"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})}}},[["render",function(a,s,o,i,n,l){return e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"app-header"},[e.createElementVNode("image",{class:"app-logo",src:t,mode:"aspectFit"})]),e.createElementVNode("view",{class:"greeting-section"},[e.createElementVNode("text",{class:"greeting-text"},"修改密码"),e.createElementVNode("text",{class:"welcome-text"},"请输入绑定的手机号码")]),e.createElementVNode("view",{class:"login-form"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"手机号"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>n.phone=e),maxlength:"11"},null,512),[[e.vModelText,n.phone]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"back-login-section"},[e.createElementVNode("text",{class:"back-login-text",onClick:s[1]||(s[1]=(...e)=>l.goToPasswordLogin&&l.goToPasswordLogin(...e))},"返回登录")]),e.createElementVNode("view",{class:"terms-section"},[e.createElementVNode("text",{class:"terms-link",onClick:s[2]||(s[2]=(...e)=>l.goToTermsOfService&&l.goToTermsOfService(...e))},"服务条款")]),e.createElementVNode("button",{class:"login-btn",onClick:s[3]||(s[3]=(...e)=>l.handleLogin&&l.handleLogin(...e))},[e.createElementVNode("text",{class:"btn-text"},"获取验证码")]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-text"},"没有账号?"),e.createElementVNode("text",{class:"register-link",onClick:s[4]||(s[4]=(...e)=>l.goToRegister&&l.goToRegister(...e))},"注册账号")])])])])}],["__scopeId","data-v-cb4330f9"]]);const ye=a({data:()=>({username:"",password:""}),computed:{isFormValid(){return this.username&&this.password&&this.username===this.password}},methods:{handleConfirm(){this.username&&this.password?this.username===this.password?(o("log","at pages/login/rest-verify-password.vue:99","密码修改信息:",{newPassword:this.username}),uni.showToast({title:"密码修改成功",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login-replica"})}),1500)):uni.showToast({title:"两次输入的密码不一致",icon:"none"}):uni.showToast({title:"请输入新密码和确认密码",icon:"none"})},goToTermsOfService(){uni.navigateTo({url:"/pages/settings/terms-of-service"})}}},[["render",function(a,s,o,i,n,l){return e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"main-content"},[e.createElementVNode("view",{class:"app-header"},[e.createElementVNode("image",{class:"app-logo",src:t,mode:"aspectFit"})]),e.createElementVNode("view",{class:"greeting-section"},[e.createElementVNode("text",{class:"greeting-text"},"修改密码"),e.createElementVNode("text",{class:"welcome-text"},"请您修改当前账号密码，在修改后需要重新登录")]),e.createElementVNode("view",{class:"login-form"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"新密码"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"password","onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e)},null,512),[[e.vModelText,n.username]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("text",{class:"input-label"},"请再次输入新密码"),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"password","onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e)},null,512),[[e.vModelText,n.password]]),e.createElementVNode("view",{class:"input-underline"})])]),e.createElementVNode("view",{class:"terms-section"},[e.createElementVNode("text",{class:"terms-link",onClick:s[2]||(s[2]=(...e)=>l.goToTermsOfService&&l.goToTermsOfService(...e))},"服务条款")]),e.createElementVNode("button",{class:"login-btn",onClick:s[3]||(s[3]=(...e)=>l.handleConfirm&&l.handleConfirm(...e)),disabled:!l.isFormValid},[e.createElementVNode("text",{class:"btn-text"},"修改密码")],8,["disabled"]),e.createElementVNode("view",{class:"register-section"},[e.createElementVNode("text",{class:"register-text"},"没有账号？"),e.createElementVNode("text",{class:"register-link",onClick:s[4]||(s[4]=(...e)=>a.goToLogin&&a.goToLogin(...e))},"注册账号")])])])])}],["__scopeId","data-v-8cd17d39"]]);__definePage("pages/index/index",s),__definePage("pages/ai/ai",i),__definePage("pages/ai/customize-ai",n),__definePage("pages/ai/gift",l),__definePage("pages/ai/level-up",c),__definePage("pages/ai/permissions",r),__definePage("pages/ai/ai-list",d),__definePage("pages/ai/pet-ai-detail",m),__definePage("pages/ai/ai-chat",g),__definePage("pages/ai/ai-store",u),__definePage("pages/ai/tasks",h),__definePage("pages/ai/task-detail",p),__definePage("pages/chat/chat",v),__definePage("pages/chat/search",w),__definePage("pages/chat/date-search",E),__definePage("pages/chat/search-results",N),__definePage("pages/chat/chat-info",V),__definePage("pages/chat/friend-card",k),__definePage("pages/chat/friend-list",f),__definePage("pages/chat/chat-list",x),__definePage("pages/feed/content-feed",y),__definePage("pages/feed/chat-feed",T),__definePage("pages/feed/post-detail",C),__definePage("pages/feed/user-profile",S),__definePage("pages/feed/my-comments",b),__definePage("pages/feed/novel-detail",M),__definePage("pages/feed/novel-more-reviews",P),__definePage("pages/feed/review-detail",A),__definePage("pages/feed/achievements",L),__definePage("pages/feed/search",R),__definePage("pages/feed/likes-dislikes",F),__definePage("pages/feed/interaction-messages",$),__definePage("pages/publish/publish",z),__definePage("pages/settings/settings",U),__definePage("pages/settings/system-permissions",j),__definePage("pages/settings/permissions",_),__definePage("pages/settings/album-permissions",O),__definePage("pages/settings/blocked-users",q),__definePage("pages/settings/customer-service",G),__definePage("pages/settings/terms-of-service",H),__definePage("pages/settings/switch-account",Q),__definePage("pages/settings/mode-selection",W),__definePage("pages/settings/notification-settings",J),__definePage("pages/settings/privacy-settings",Y),__definePage("pages/settings/account-security",K),__definePage("pages/settings/device-management",Z),__definePage("pages/settings/third-party-binding",X),__definePage("pages/settings/add-ways",ee),__definePage("pages/settings/language",te),__definePage("pages/settings/notification-display",ae),__definePage("pages/verification/official-certification",se),__definePage("pages/verification/school-certification",oe),__definePage("pages/verification/professional-certification",ie),__definePage("pages/verification/real-name-verification",ne),__definePage("pages/verification/face-recognition",le),__definePage("pages/verification/verification-complete",ce),__definePage("pages/verification/certification-feedback",re),__definePage("pages/wallet/wallet",de),__definePage("pages/wallet/recharge",me),__definePage("pages/wallet/purchase-record",ge),__definePage("pages/report/report",ue),__definePage("pages/report/report-evidence",he),__definePage("pages/report/report-feedback",pe),__definePage("pages/login/phone-login",ve),__definePage("pages/login/login-replica",we),__definePage("pages/login/login-unbound",Ee),__definePage("pages/login/phone-register",Ne),__definePage("pages/login/verification-code-login",Ve),__definePage("pages/login/verification-code-register",ke),__definePage("pages/login/verification-code-resetPassword",fe),__definePage("pages/login/reset-password",xe),__definePage("pages/login/rest-verify-password",ye);const Te={onLaunch:function(){o("log","at App.vue:4","App Launch")},onShow:function(){o("log","at App.vue:7","App Show")},onHide:function(){o("log","at App.vue:10","App Hide")}};const{app:Ce,Vuex:Ie,Pinia:Be}={app:e.createVueApp(Te)};uni.Vuex=Ie,uni.Pinia=Be,Ce.provide("__globalStyles",__uniConfig.styles),Ce._component.mpType="app",Ce._component.render=()=>{},Ce.mount("#app")}(Vue);
